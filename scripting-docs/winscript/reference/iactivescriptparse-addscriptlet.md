---
title: IActiveScriptParse::AddScriptlet | Документация Майкрософт
ms.custom: ''
ms.date: 01/18/2017
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: reference
apiname:
- IActiveScriptParse.AddScriptlet
apilocation:
- scrobj.dll
helpviewer_keywords:
- IActiveScriptParse_AddScriptlet
ms.assetid: 824929f4-4dd3-473a-92d9-0b96acea2f14
caps.latest.revision: 7
author: mikejo5000
ms.author: mikejo
manager: ghogen
ms.openlocfilehash: ee5d76060789118e9051c2d8dcc5fc570617f6a8
ms.sourcegitcommit: d3a485d47c6ba01b0fc9878cbbb7fe88755b29af
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2019
ms.locfileid: "58151275"
---
# <a name="iactivescriptparseaddscriptlet"></a>IActiveScriptParse::AddScriptlet
Сценарий кода добавляет к скрипту. Этот метод используется в средах, где сохраняемого состояния сценария переплетен с элементами документа узла и узла несет ответственность за восстановление сценарий, а не через `IPersist*` интерфейс. Основной относятся, например HTML языках сценариев, которые Разрешить сценарии кода, внедренного в HTML-документе должны быть присоединены к внутренних событий (к примеру, ONCLICK="button1.text='Exit"»).  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp
HRESULT AddScriptlet(  
    LPCOLESTR pstrDefaultName,       // address of default name of scriptlet  
    LPCOLESTR pstrCode,              // address of scriptlet text  
    LPCOLESTR pstrItemName,          // address of item name  
    LPCOLESTR pstrSubItemName,       // address of subitem name  
    LPCOLESTR pstrEventName,         // address of event name  
    LPCOLESTR pstrDelimiter,         // address of end-of-scriptlet delimiter  
    DWORD_PTR dwSourceContextCookie, // application-defined value for debugging  
    ULONG ulStartingLineNumber,      // starting line of the script  
    DWORD dwFlags,                   // scriptlet flags  
    BSTR *pbstrName,                 // address of actual name of scriptlet  
    EXCEPINFO *pexcepinfo            // address of exception information  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 `pstrDefaultName`  
 [in] Адрес по умолчанию имя для связи со скриптлетом. Если сценарий не содержит сведения об именах (как показано в приведенном выше примере ONCLICK), это имя будет использоваться для идентификации сценария. Если этот параметр имеет `NULL`, обработчик скриптов создает уникальное имя, при необходимости.  
  
 `pstrCode`  
 [in] Адрес текста скриптлета для добавления. Интерпретация этой строки зависит от языка скриптов.  
  
 `pstrItemName`  
 [in] Адрес буфера, который содержит имя элемента, связанного с этой скриптлета. Этот параметр, в дополнение к `pstrSubItemName`, определяющий объект, для которого сценария является обработчиком событий.  
  
 `pstrSubItemName`  
 [in] Адрес буфера, который содержит имя `subobject` для именованного элемента, с которым связан этот сценарий; это имя следует найти в именованный элемент сведений о типе. Этот параметр имеет значение NULL, если скриптлет должны быть сопоставлены именованного элемента вместо `subitem`. Этот параметр, в дополнение к `pstrItemName`, идентифицирует определенный объект, для которого сценария является обработчиком событий.  
  
 `pstrEventName`  
 [in] Адрес буфера, который содержит имя события, для которого сценария является обработчиком событий.  
  
 `pstrDelimiter`  
 [in] Адрес end-разделителя конца скриптлета. Когда `pstrCode` анализируется из потока текста, узел обычно использует разделитель, например две одинарные кавычки («), чтобы определить конец скриптлета. Этот параметр задает разделитель, используемый узлом, позволяя обработчик скриптов для предоставления некоторых условного примитивных предварительной обработки (например, замените одинарной кавычки ['] две одинарные кавычки для использования в качестве разделителя). Точный способ (и нужно ли) сценариев делает ядра, использование этих сведений зависит от обработчика скриптов. Установите этот параметр в значение NULL, если узел не используется разделитель для обозначения конца сценария.  
  
 `dwSourceContextCookie`  
 [in] Определяемый приложением значение, используемое для отладки.  
  
 `ulStartingLineNumber`  
 [in] Отсчитываемый от нуля значение, которое указывает строку, с которой начинается синтаксический анализ.  
  
 `dwFlags`  
 [in] Флаги, связанные со скриптлетом. Может быть сочетанием следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|SCRIPTTEXT_ISVISIBLE|Указывает, что текст скрипта должен быть видимым (и, следовательно, вызывать по имени) как глобальный метод в пространстве имен скрипта.|  
|SCRIPTTEXT_ISPERSISTENT|Указывает, что код, добавленный в процессе вызова должен быть сохранен при сохранении обработчика скриптов (например, путем вызова `IPersist*::Save`), или при сбросе обработчика скриптов посредством перевода его обратно в исходное состояние. Дополнительные сведения об этом состоянии см. в разделе состояния обработчика скриптов.|  
  
 `pbstrName` ,  
 [out] Фактическое имя, используемое для идентификации сценария. Это должен быть в порядке предпочтения: имя явно указано в текста скриптлета, имя по умолчанию, предоставленное в `pstrDefaultName`, или уникальное имя синтезируется обработчика скриптов.  
  
 `pexcepinfo` ,  
 [out] Адрес структуру, содержащую сведения об исключении. Эта структура должно быть заполнено при возвращении DISP_E_EXCEPTION.  
  
## <a name="return-value"></a>Возвращаемое значение  
 Возвращает одно из следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|`S_OK`|Выполнено.|  
|`DISP_E_EXCEPTION`|Возникло исключение при анализе сценария. `pexcepinfo` Параметр содержит сведения об исключении.|  
|`E_INVALIDARG`|Аргумент был недопустимым.|  
|`E_NOTIMPL`|Этот метод не поддерживается; Обработчик скриптов не поддерживает добавление сценарии прием событий.|  
|`E_POINTER`|Указан недопустимый указатель.|  
|`E_UNEXPECTED`|Вызов не ожидался (например, обработчик скриптов еще не была загрузки или инициализации) и поэтому не удалось.|  
|`OLESCRIPT_E_INVALIDNAME`|Предоставленное имя по умолчанию является недопустимым в этот язык сценариев.|  
|`OLESCRIPT_E_SYNTAX`|Произошла Неуказанная синтаксическая ошибка в сценарии.|  
  
## <a name="see-also"></a>См. также  
 [IActiveScriptParse](../../winscript/reference/iactivescriptparse.md)