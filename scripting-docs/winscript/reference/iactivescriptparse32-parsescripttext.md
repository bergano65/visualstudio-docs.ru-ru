---
title: IActiveScriptParse32::ParseScriptText | Документация Майкрософт
ms.custom: ''
ms.date: 01/18/2017
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: f33e454c-69d8-4cab-9150-d1e7fd04786d
caps.latest.revision: 4
author: mikejo5000
ms.author: mikejo
ms.openlocfilehash: 782c1d7bd2dd4c0708418ffd3e69c339dd993fde
ms.sourcegitcommit: 116e9614867e0b3c627ce9001012a4c39435a42b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2019
ms.locfileid: "54094605"
---
# <a name="iactivescriptparse32parsescripttext"></a>IActiveScriptParse32::ParseScriptText
Анализирует заданного сценарий кода, а объявления в пространстве имен и вычисления код соответственно.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp
HRESULT ParseScriptText(  
    LPCOLESTR pstrCode,              // address of scriptlet text  
    LPCOLESTR pstrItemName,          // address of item name  
    IUnknown *punkContext,           // address of debugging context  
    LPCOLESTR pstrDelimiter,         // address of end-of-scriptlet delimiter  
    DWORD_PTR dwSourceContextCookie, // cookie for debugging  
    ULONG ulStartingLineNumber,      // starting line of the script  
    DWORD dwFlags,                   // scriptlet flags  
    VARIANT *pvarResult,             // address of buffer for results  
    EXCEPINFO *pexcepinfo            // address of buffer for error data  
);  
```  
  
#### <a name="parameters"></a>Параметры  
  
|||  
|-|-|  
|`pstrCode`|[in] Адрес текста скриптлета для вычисления. Интерпретация этой строки зависит от языка скриптов.|  
|`pstrItemName`|[in] Адрес имени элемента, которое предоставляет контекст, в котором будет вычисляться сценария. Если этот параметр имеет значение NULL, код вычисляется в глобальном контексте обработчика скриптов.|  
|`punkContext`|[in] Адрес объекта контекста. Этот объект зарезервирован для использования в среде отладки, где такой контекст может быть предоставлен отладчиком для представления активный контекст среды выполнения. Если этот параметр имеет значение NULL, модуль использует `pstrItemName` для определения контекста.|  
|`pstrDelimiter`|[in] Адрес end-разделителя конца скриптлета. Когда `pstrCode` анализируется из потока текста узел обычно использует разделитель, например две одинарные кавычки («), чтобы определить конец скриптлета. Этот параметр задает разделитель, используемый узлом, позволяя обработчик скриптов для предоставления некоторых условного примитивных предварительной обработки (например, замените одинарной кавычки ['] две одинарные кавычки для использования в качестве разделителя). Точный способ (и нужно ли) сценариев делает ядра, использование этих сведений зависит от обработчика скриптов. Присвойте этому параметру значение `NULL` Если узел не используется разделитель для обозначения конца сценария.|  
|`dwSourceContextCookie`|[in] Файл cookie, используемый для отладки.|  
|`ulStartingLineNumber`|[in] Отсчитываемый от нуля значение, которое указывает строку, с которой начинается синтаксический анализ.|  
|`dwFlags`|[in] Флаги, связанные со скриптлетом. Может представлять собой сочетание этих значений:|  
  
|Значение|Значение|  
|-----------|-------------|  
|SCRIPTTEXT_ISEXPRESSION|Если различие между вычислительным выражением и оператором является важным, но синтаксически неоднозначно в скриптовом языке, этот флаг указывает, что скриптлет следует интерпретировать как выражение, а не как оператор или список инструкций. По умолчанию инструкциях предполагается, что если правильный вариант нельзя определить из синтаксиса текста скриптлета.|  
|SCRIPTTEXT_ISPERSISTENT|Указывает, что код, добавленный в процессе вызова должен быть сохранен при сохранении обработчика скриптов (например, путем вызова `IPersist*::Save`), или при сбросе обработчика скриптов посредством перевода его обратно в исходное состояние.|  
|SCRIPTTEXT_ISVISIBLE|Указывает, что текст скрипта должен быть видимым (и, следовательно, вызывать по имени) как глобальный метод в пространстве имен скрипта.|  
  
|||  
|-|-|  
|`pvarResult`|[out] Адрес буфера, который получает результаты обработки скриптлета, или `NULL` Если вызывающий объект не ожидает результата (то есть значение SCRIPTTEXT_ISEXPRESSION не задано).|  
|`pexcepinfo`|[out] Адрес структуры, которая получает сведения об исключении. Эта структура заполняется в том случае, если `IActiveScriptParse::ParseScriptText` возвращает DISP_E_EXCEPTION.|  
  
## <a name="return-value"></a>Возвращаемое значение  
 Возвращает одно из следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|`S_OK`|Выполнено.|  
|`DISP_E_EXCEPTION`|Возникло исключение в процессе обработки сценария. `pexcepinfo` Параметр содержит сведения об исключении.|  
|`E_INVALIDARG`|Аргумент был недопустимым.|  
|`E_POINTER`|Указан недопустимый указатель.|  
|`E_NOTIMPL`|Этот метод не поддерживается. Обработчик скриптов не поддерживает времени выполнения вычисления выражений или инструкции.|  
|`E_UNEXPECTED`|Вызов не ожидался (например, обработчик скриптов находится в неинициализированном или закрытом состоянии или был scripttext_isexpression и обработчик скриптов находится в инициализированном состоянии).|  
|`OLESCRIPT_E_SYNTAX`|Произошла Неуказанная синтаксическая ошибка в сценарии.|  
  
## <a name="remarks"></a>Примечания  
 Если обработчик скриптов находится в инициализированном состоянии, код не будет вычисляться во время этого вызова; Вместо этого такой код в очередь и выполнен, когда обработчик скриптов перейдет в (или через) состояние "запущен". Поскольку в инициализированном состоянии выполнение не может, это ошибка для вызова этого метода с флагом SCRIPTTEXT_ISEXPRESSION в инициализированном состоянии.  
  
 Сценарий может быть выражение, список инструкций и разрешенным языком скрипта. Например, этот метод используется в вычислении HTML- \<СКРИПТА > тег, который позволяет операторам выполняться во создана HTML-страницы, а не просто компилироваться в состояние скрипта.  
  
 Код, переданный этому методу должен быть допустимой, полной часть кода. Например, в VBScript недопустимо вызывать этот метод один раз с помощью Sub Function(x), а второй раз с `End Sub`. Средство синтаксического анализа не придется ждать второй вызов для выполнения подпрограммы, но а должен вызывать ошибку синтаксического анализа, так как объявления подпрограммы был запущен, но не была завершена.  
  
 Дополнительные сведения о состояниях скрипта см. в разделе состояния обработчика скриптов [обработчики скриптов Windows](../../winscript/windows-script-engines.md).  
  
## <a name="see-also"></a>См. также  
 [IActiveScriptParse32](../../winscript/reference/iactivescriptparse32.md)