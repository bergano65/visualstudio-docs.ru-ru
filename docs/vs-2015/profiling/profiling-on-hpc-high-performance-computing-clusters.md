---
title: Профилирование в кластерах высокопроизводительных вычислительных систем (HPC) | Документы Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.performance.hpc.wizard.exeoptions
- vs.performance.hpc.wizard.summary
- vs.performance.hpc.wizard.startoptions
- vs.performance.hpc.wizard.intro
- vs.performance.hpc.property.basic
- vs.performance.hpc.wizard.application
- vs.performance.hpc.wizard.clusteroptions
- vs.performance.hpc.property.advanced
helpviewer_keywords:
- profililng tools,HPC
- HPC profiling
ms.assetid: 1525bbdb-27da-4088-8487-a486cee5e7b3
caps.latest.revision: 27
author: MikeJo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 8390fcfd5dd89607422b7614d064ec736f98f61b
ms.sourcegitcommit: d3a485d47c6ba01b0fc9878cbbb7fe88755b29af
ms.translationtype: MTE95
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2019
ms.locfileid: "57867932"
---
# <a name="profiling-on-hpc-high-performance-computing-clusters"></a>Профилирование в кластерах высокопроизводительных вычислительных систем (HPC)
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Профилирование вычислительных узлов кластеров Microsoft Windows HPC можно выполнять методом выборки средств профилирования [!INCLUDE[vsPreExt](../includes/vspreext-md.md)] или [!INCLUDE[vsUltExt](../includes/vsultext-md.md)]. Дополнительные сведения о HPC см. в разделе [больших вычислений: HPC и пакетная служба](https://azure.microsoft.com/solutions/big-compute/) на веб-сайте Майкрософт.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для профилирования на вычислительном узле HPC нужно выполнить следующие действия.  
  
- Установить пакет Microsoft HPC 2008 на том же компьютере, что и [!INCLUDE[vsPreLong](../includes/vsprelong-md.md)]. Этот компьютер не должен входить в состав кластера HPC. Можно установить пакет HPC из [Центра загрузки Майкрософт](http://go.microsoft.com/fwlink/?LinkID=177414).  
  
- Установить [!INCLUDE[net_v40_long](../includes/net-v40-long-md.md)] и автономную версию средств профилирования на вычислительном узле HPC. Установить программы для [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)] и автономного профилировщика, доступные на установочном носителе [!INCLUDE[vsPreShort](../includes/vspreshort-md.md)]. **Примечание.** Необходимо перезапустить компьютер после установки [!INCLUDE[dnprdnshort](../includes/dnprdnshort-md.md)], но перед установкой средств профилирования.  
  
  Чтобы установить [!INCLUDE[net_v40_long](../includes/net-v40-long-md.md)] и автономные средства профилирования на активном вычислительном узле HPC и включить профилирование на компьютере кластера, выполните следующие действия.  
  
1.  Откройте окно командной строки, которая устанавливается вместе с пакетом HPC.  
  
2.  В отдельных командных строках введите следующие команды:  
  
    1.  `clusrun /all /scheduler:` *%HeadNode% %FxPath%* `/q /norestart`  
  
    2.  `clusrun /all /scheduler:` *%HeadNode%* `shutdown /r /t 0 /d u:4:2 /c "Microsoft .NET Framework install required restart"`  
  
    3.  `clusrun /all /scheduler:` *%HeadNode% %ProfilerPath%* `/q /norestart`  
  
|||  
|-|-|  
|*%HeadNode%*|Имя головного узла кластера.|  
|*%FxPath%*|Путь к установщику [!INCLUDE[net_v40_long](../includes/net-v40-long-md.md)]. На установочном носителе [!INCLUDE[vsPreShort](../includes/vspreshort-md.md)] этот путь — WCU\dotNetFramework\dotNetFx40_Full_x86_x64.exe|  
|*%ProfilerPath%*|Путь к автономной версии установщика средств профилирования. На установочном носителе [!INCLUDE[vsPreShort](../includes/vspreshort-md.md)] этот путь — Standalone Profiler\x64\vs_profiler.exe|  
  
## <a name="profiling-on-an-hpc-compute-node"></a>Профилирование в вычислительном узле HPC  
 Чтобы задать кластер HPC и целевые данные, нужно настроить сеанс профилирования с помощью мастера производительности HPC. На страницах свойств сеанса производительности можно задать дополнительные параметры. Средства профилирования автоматически развертывают необходимые целевые двоичные файлы и запускают профилировщик и приложение HPC.  
  
#### <a name="to-profile-on-an-hpc-compute-node"></a>Профилирование в вычислительном узле HPC  
  
1.  В меню **Анализ** выберите команду **Запустить мастер производительности HPC**. Если команда недоступна, убедитесь в наличии перечисленных выше необходимых компонентов.  
  
2.  На первой странице мастера нажмите кнопку **Далее**.  
  
3.  На второй странице мастера выберите приложение, которое требуется профилировать.  
  
    -   Для профилирования проекта, открытого в [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)], выберите параметр **Один или несколько доступных проектов**, а затем имя проекта в списке.  
  
    -   Для профилирования двоичного файла, не находящегося в открытом проекте, выберите параметр **Исполняемый файл (EXE-файл)**.  
  
4.  Нажмите кнопку **Далее**.  
  
5.  На третьей странице мастера:  
  
    -   При профилировании исполняемого файла, не находящегося в открытом проекте, задайте путь к двоичному файлу в поле **Каков полный путь к исполняемому файлу**.  
  
    -   При профилировании исполняемого файла, не находящегося в открытом проекте, можно задать в качестве значения аргумента командной строки путь к процессу в поле **Аргументы командной строки**.  
  
    -   В поле **Удаленный рабочий каталог** укажите путь к папке, которая используется экземплярами процесса в отдельных вычислительных узлах.  
  
    -   В поле **Расположение развертывания** укажите путь к каталогу, используемому сервером HPC для размещения образов для развертывания.  
  
6.  Нажмите кнопку **Далее**.  
  
7.  На четвертой странице мастера выполните следующие действия.  
  
    -   В списке **Головной узел** щелкните компьютер, выполняющий функцию головного узла HPC в сеансе профилирования. Головным узлом может быть "localhost", который позволяет выполнять профилирование на локальном компьютере без необходимости использования кластера.  
  
    -   В списке **Число процессов** выберите число экземпляров приложения, которые необходимо запустить.  
  
    -   В списке **Параметры профилирования** выберите целевой объект профилирования.  
  
         Для профилирования определенных процессов в кластере выберите параметр **Профиль в ранге**, а затем ранг процесса в раскрывающемся списке.  
  
         Для профилирования процесса или процессов, выполняемых в определенном узле кластера HPC, выберите параметр **Профиль в узле**, а затем узел процесса в раскрывающемся списке.  
  
8.  Нажмите кнопку **Далее**.  
  
9. На пятой странице мастера можно выбрать непосредственный запуск профилировщика и процесса профилирования или выполнение профилирования позже с помощью обозревателя производительности.  
  
    -   Установите флажок **Запустить профилирование после завершения работы мастера**, чтобы запустить профилирование непосредственно сразу, или снимите этот флажок, чтобы запустить его вручную.  
  
10. Нажмите кнопку **Готово**.  
  
## <a name="setting-hpc-profiling-properties-by-using-performance-session-property-pages"></a>Настройка свойств профилирования HPC с помощью страниц свойств сеанса анализа производительности  
 Свойства сеанса анализа производительности, заданные в мастере профилирования HPC, можно изменить на странице "Свойства запуска HPC". На странице "Дополнительные свойства HPC" можно задать дополнительные параметры.  
  
#### <a name="to-open-the-performance-session-property-pages"></a>Открытие страниц свойств сеанса производительности  
  
1.  При необходимости файл сеанса анализа производительности (PSESS) можно открыть в обозревателе производительности. В меню **Файл** щелкните **Открыть** и выберите файл.  
  
2.  В обозревателе производительности щелкните правой кнопкой мыши имя сеанса анализа производительности и выберите пункт **Свойства**.  
  
3.  В диалоговом окне "Страницы свойств" воспользуйтесь одним из следующих методов.  
  
    -   Перейдите на вкладку **Общие** и установите флажок **Сбор на кластере HPC**, чтобы включить профилирование HPC, или снимите этот флажок, чтобы его отключить.  
  
    -   Щелкните **Свойства запуска HPC**, чтобы изменить свойства, используемые при запуске приложения HPC.  
  
    -   Щелкните **Дополнительные свойства HPC**, чтобы задать дополнительные параметры.  
  
### <a name="hpc-launch-properties"></a>Свойства запуска HPC  
  
|Свойство.|Описание|  
|--------------|-----------------|  
|**Головной узел**|Задает компьютер, выполняющий функцию головного узла HPC в сеансе профилирования.|  
|**Число процессов**|Задает число экземпляров приложения, которые необходимо запустить в профилируемом приложении.|  
|**Профиль в ранге**|Для профилирования определенных процессов в кластере выберите параметр **Профиль в ранге**, а затем ранг процесса в раскрывающемся списке.|  
|**Профиль в узле**|Для профилирования процесса или процессов, выполняемых в определенном узле кластера HPC, выберите параметр **Профиль в узле**, а затем узел процесса в раскрывающемся списке.|  
|**Удаленный рабочий каталог**|Задает путь к папке, которая используется экземплярами процесса в отдельных вычислительных узлах.|  
|**Расположение развертывания**|Задает путь к каталогу, используемому сервером HPC для размещения образов для развертывания.|  
  
### <a name="advanced-properties"></a>Дополнительные свойства  
  
|Свойство.|Описание|  
|--------------|-----------------|  
|**Имя проекта**|Имя текущего проекта или решения [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)].|  
|**Выполнить очистку после остановки профилировщика**|Если этот параметр активен, удаляет двоичные файлы, развернутые в каталоге выполнения. Файлы и каталоги, созданные пользовательской программой, на этом этапе не удаляются. Если каталог выполнения и каталог развертывания были созданы интерфейсом IDE, IDE пытается их удалить, однако если в этих каталогах есть файлы, развернутые не интерфейсом IDE, он этого не делает.|  
|**Дополнительные файлы, которые необходимо развернуть**|Задает список всех дополнительных файлов для развертывания на вычислительном узле, разделенных точкой с запятой. Можно нажать кнопку с многоточием (**...** ), чтобы выбрать несколько файлов с помощью диалогового окна.|  
|**Команда mpiexec**|Задает приложение, которое запускает MPI-приложение. Значение по умолчанию — **mpiexec.exe**.|  
|**Аргументы команды mpiexec**|Задает аргументы, передаваемые команде mpiexec.exe.|  
|**Запрошенные узлы в кластере**|Задает число узлов в кластере, в котором необходимо запустить приложение.|  
|**Развернуть CRT-файлы**|Если это свойство активно, развертывает в кластере среду выполнения C/C++.|  
|**Скрипт предварительного профилирования**|Задает путь и имя файла скрипта для запуска на локальном компьютере разработки перед запуском сеанса профилирования.|  
|**Аргументы скрипта предварительного профилирования**|Задает аргументы, передаваемые скрипту предварительного профилирования.|  
|**Скрипт пост-профилирования**|Задает путь и имя файла скрипта для запуска на локальном компьютере разработки после завершения сеанса профилирования.|  
|**Аргументы скрипта пост-профилирования**|Задает аргументы, передаваемые скрипту пост-профилирования.|
