---
title: Извлечение интерфейса рефакторинг (C#) | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-general
ms.topic: reference
f1_keywords:
- vs.csharp.refactoring.extractinterface
dev_langs:
- CSharp
helpviewer_keywords:
- refactoring [C#], Extract Interface
- Extract Interface refactoring operation [C#]
ms.assetid: 7d0aa225-3b33-4331-9652-5a67cac6f3d0
caps.latest.revision: 25
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: 55b24facd3a9ec935277a42c211a64d824ed6d7f
ms.sourcegitcommit: 1fc6ee928733e61a1f42782f832ead9f7946d00c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "60116749"
---
# <a name="extract-interface-refactoring-c"></a>Рефакторинг для извлечения интерфейса (C#)
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Извлечение интерфейса — это операция рефакторинга, предоставляет простой способ создать новый интерфейс с членами, которые создаются из существующего класса, структуры или интерфейса.  
  
 Если несколько клиентов используют одно и то же подмножество элементов из класса, структуры или интерфейса или несколько классов, структур или интерфейсов имеют подмножество элементов Общие, бывает полезно создать подмножество членов в интерфейсе их. Дополнительные сведения об использовании интерфейсов см. в разделе [интерфейсы](http://msdn.microsoft.com/library/2feda177-ce11-432d-81b4-d50f5f35fd37).  
  
 Извлечение интерфейса создает интерфейс, в новый файл и помещает курсор в начале нового файла. Можно указать члены, которые нужно извлечь в новый интерфейс, имя нового интерфейса и имя файла, созданного с помощью **извлечение интерфейса** диалоговое окно.  
  
### <a name="to-use-extract-interface"></a>Чтобы использовать извлечение интерфейса  
  
1. Создайте консольное приложение с именем `ExtractInterface`, а затем замените `Program` следующим кодом  
  
    ```csharp  
    // Invoke Extract Interface on ProtoA.  
    // Note:  the extracted interface will be created in a new file.  
    class ProtoA  
    {  
        public void MethodB(string s) { }  
    }  
    ```  
  
2. Причем курсор будет расположен в `MethodB`и нажмите кнопку **извлечение интерфейса** на **рефакторинг** меню.  
  
     **Извлечение интерфейса** откроется диалоговое окно.  
  
     Можно также ввести сочетание клавиш CTRL + R, я для отображения **извлечение интерфейса** диалоговое окно.  
  
     Вы можете щелкнуть правой кнопкой мыши, выберите пункт **рефакторинг**и нажмите кнопку **извлечение интерфейса** для отображения **извлечение интерфейса** диалоговое окно.  
  
3. Нажмите кнопку **выбрать все**.  
  
4. Нажмите кнопку **ОК**.  
  
     Появится новый файл, IProtoA.cs и следующий код:  
  
    ```csharp  
    using System;  
    namespace TopThreeRefactorings  
    {  
        interface IProtoA  
        {  
            void MethodB(string s);  
        }  
    }  
    ```  
  
## <a name="remarks"></a>Примечания  
 Этот компонент доступен только в случае, когда курсор располагается в класса, структуры или интерфейса, который содержит элементы, которые вы хотите извлечь. Когда курсор находится в этой позиции, вызов извлечение интерфейса-операция рефакторинга.  
  
 При вызове извлечение интерфейса для класса или структуры, список базовых классов и интерфейсов изменяется имя нового интерфейса. При вызове извлечение интерфейса для интерфейса, список базовых классов и интерфейсов не изменяется.  
  
## <a name="see-also"></a>См. также  
 [Рефакторинг (C#)](../csharp-ide/refactoring-csharp.md)