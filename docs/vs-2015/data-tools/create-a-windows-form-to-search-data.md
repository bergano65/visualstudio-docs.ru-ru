---
title: Создайте форму Windows для поиска данных | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-data-tools
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- Windows Forms, searching data
- Windows Forms, displaying data
- parameters, displaying filtered data
- data [Visual Studio], parameterizing queries
- data [Visual Studio], searching
ms.assetid: 65ca79a9-7458-466c-af55-978cd24c549e
caps.latest.revision: 31
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: a6080539a3f8b5f93a8d6fcd144dbd26dbd9eeaf
ms.sourcegitcommit: 53aa5a413717a1b62ca56a5983b6a50f7f0663b3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59667018"
---
# <a name="create-a-windows-form-to-search-data"></a>Создание формы Windows Forms для поиска данных
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Довольно распространенным сценарием приложения является отображение выбранных данных на форме. Например, вам может потребоваться отобразить заказы для определенного клиента или сведения о конкретном заказе. В таком сценарии пользователь вводит в форму информацию, после чего выполняется запрос, включающий в себя эти введенные пользователем данные в качестве параметра; таким образом, данные выбираются на основе параметризированного запроса. Запрос возвращает только те данные, которые удовлетворяют введенным пользователем условиям. Это пошаговое руководство показывает, как создать запрос, возвращающий клиентов из определенного города, и изменить пользовательский интерфейс, чтобы пользователи могли ввести название города и нажать кнопку для выполнения запроса.  
  
 Использование параметризованных запросов помогает сделать приложение эффективным, так как позволяет базе данных заниматься своей непосредственной задачей — быстрой фильтрацией записей. И наоборот, если запросить всю таблицу базы данных, передать ее по сети и использовать логику приложения для поиска записей, ваше приложение станет медленным и неэффективным.  
  
 Параметризованные запросы можно добавить любой адаптер таблицы (и элементы управления для приема значений параметров и выполнения запроса), с помощью **Построитель условий поиска** диалоговое окно. Откройте диалоговое окно, выбрав команду **Добавить запрос** в меню **Данные** (или на любом смарт-теге адаптера таблицы).  
  
 В данном пошаговом руководстве представлены следующие задачи.  
  
-   Создание нового проекта приложения Windows Forms.  
  
-   Создание и настройка источника данных в приложении с помощью **конфигурации источника данных** мастера.  
  
-   Настройка типа удаления элементов в **источников данных** окна.  
  
-   Создание отображающих данные элементов управления с помощью перетаскивания элементов из окна **Источники данных** на форму.  
  
-   Добавление элементов управления для отображения данных на форме.  
  
-   Завершение работы **Построитель условий поиска** диалоговое окно.  
  
-   Ввод параметров в форму и выполнение параметризованного запроса.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для выполнения данного пошагового руководства требуется:  
  
-   Доступ к примеру базы данных "Борей".  
  
## <a name="create-the-windows-application"></a>Создание приложения Windows  
 Первым шагом является создание **приложения Windows**. Присвоение имени проекту на данном этапе, но вы дадите его имя, так как вы сохраните их позже.  
  
#### <a name="to-create-the-new-windows-application-project"></a>Порядок создания нового проекта приложения Windows  
  
1.  Из **файл** меню, создайте новый проект.  
  
2.  Задайте для проекта имя `WindowsSearchForm`.  
  
3.  Выберите **приложения Windows** и нажмите кнопку **ОК**.  
  
     Создается проект **WindowsSearchForm**, который добавляется в **Обозреватель решений**.  
  
## <a name="create-the-data-source"></a>Создание источника данных  
 Этот шаг создает источник данных из базы данных с помощью **конфигурации источника данных** мастера. Для создания подключения необходимо иметь доступ к учебной базе данных "Борей". Сведения о настройке учебной базе данных Northwind, см. в разделе [Установка SQL Server образцы баз данных](../data-tools/install-sql-server-sample-databases.md).  
  
#### <a name="to-create-the-data-source"></a>Создание источника данных  
  
1.  В меню **Данные** выберите команду **Показать источники данных**.  
  
2.  В окне **Источники данных** выберите **Добавить новый источник данных**, чтобы запустить **Мастер настройки источника данных**.  
  
3.  На странице **Выбор типа источника данных** выберите элемент **База данных** и нажмите **Далее**.  
  
4.  На странице **Выбор подключения к базе данных** выполните одно из следующих действий:  
  
    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.  
  
    -   Выберите **Новое подключение** для открытия диалогового окна **Добавить/изменить подключение**.  
  
5.  Если базе данных требуется пароль, выберите параметр для включения конфиденциальных данных и нажмите кнопку **Далее**.  
  
6.  На **сохранение подключения в файле конфигурации приложения** щелкните **Далее**.  
  
7.  Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.  
  
8.  Выберите таблицу **Клиенты** и нажмите **Готово**.  
  
     Объект **NorthwindDataSet** добавляется в проект, и таблица **Клиенты** отображается в окне **Источники данных**.  
  
## <a name="create-the-form"></a>Создание формы  
 Вы можете создавать элементы управления с привязкой к данным с помощью перетаскивания элементов из окна **Источники данных** на форму.  
  
#### <a name="to-create-data-bound-controls-on-the-form"></a>Создание элементов управления с привязкой к данным на форме  
  
1.  Разверните узел **Customers** в окне **Источники данных**.  
  
2.  Перетащите узел **Клиенты** из окна **Источники данных** на свою форму.  
  
     На форме появляются <xref:System.Windows.Forms.DataGridView> и полоса инструментов (<xref:System.Windows.Forms.BindingNavigator>) для перемещения по записям. В области компонентов появляется [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), CustomersTableAdapter, <xref:System.Windows.Forms.BindingSource> и <xref:System.Windows.Forms.BindingNavigator>.  
  
## <a name="addparameterization-search-functionality-to-the-query"></a>Addparameterization (функциональности поиска) в запрос  
 Можно добавить предложение WHERE в исходный запрос с помощью **Построитель условий поиска** диалоговое окно.  
  
#### <a name="to-create-a-parameterized-query-and-controls-to-enter-the-parameters"></a>Порядок создания параметризованного запроса и элементов управления для ввода параметров  
  
1.  Выберите элемент управления <xref:System.Windows.Forms.DataGridView> и щелкните **Добавить запрос** в меню **Данные**.  
  
2.  Тип `FillByCity` в **имя нового запроса** область **Построитель условий поиска** диалоговое окно.  
  
3.  Добавьте `WHERE City = @City` в запрос в области **Текст запроса**.  
  
     Запрос должен выглядеть примерно следующим образом:  
  
     `SELECT CustomerID, CompanyName, ContactName, ContactTitle, Address, City, Region, PostalCode, Country, Phone, Fax`  
  
     `FROM Customers`  
  
     `WHERE City = @City`  
  
    > [!NOTE]
    >  Источники данных Access и OLE DB используют вопросительный знак ("?") для обозначения параметров, поэтому предложение WHERE может выглядеть следующим образом: `WHERE City = ?`.  
  
4.  Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Построитель условий поиска**.  
  
     На форму добавляется **FillByCityToolStrip**.  
  
## <a name="testing-the-application"></a>Тестирование приложения  
 При запуске приложения открывается ваша форма, готовая к получению входных данных в качестве параметра.  
  
#### <a name="to-test-the-application"></a>Тестирование приложения  
  
1.  Нажмите клавишу F5 для запуска приложения.  
  
2.  Введите **Лондон** в текстовом поле **Город** и щелкните **FillByCity**.  
  
     Сетка данных заполняется клиентов, соответствующих критериям. В этом примере сетка данных отображает только клиентов, для которых в столбце **Город** задано значение **Лондон**.  
  
## <a name="next-steps"></a>Следующие шаги  
 В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после создания параметризованной формы. Ниже приводится перечень рекомендаций, позволяющих улучшить полученный результат.  
  
-   Добавление элементов управления, отображающих связанные данные.  
  
-   Изменение набора данных для добавления или удаления объектов базы данных. Дополнительные сведения см. в разделе, посвященном [созданию и настройке наборов данных](../data-tools/create-and-configure-datasets-in-visual-studio.md).  
  
## <a name="see-also"></a>См. также  
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)
