---
title: Использование RDT_ReadLock | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- RDT_ReadLock
- visible
- RDT_EditLock
- invisible
ms.assetid: b935fc82-9d6b-4a8d-9b70-e9a5c5ad4a55
caps.latest.revision: 9
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: a9a6b5f86f0cfbb71f6264bdc74df72ad9209c9d
ms.sourcegitcommit: 1fc6ee928733e61a1f42782f832ead9f7946d00c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "60070164"
---
# <a name="rdtreadlock-usage"></a>Использование RDT_ReadLock
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

<xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS> — Это флаг, предоставляющий логику для блокировка документа на в выполняющихся документа таблицы (RDT), который является список всех документов, открытых в настоящий момент в Интегрированной среде разработки Visual Studio. Этот флаг определяет при открытии документов и является ли документ видимым в пользовательском интерфейсе или принудительное незаметно в памяти.  
  
 Как правило, используется <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS> когда верно одно из следующих:  
  
- При необходимости откройте документ незаметно и только для чтения, но он еще не что <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> должны отвечать за его.  
  
- При необходимости пользователь будет предложено сохранить документ, который незаметно был открыт, прежде чем пользователь, он отображается в пользовательском Интерфейсе и затем была предпринята попытка закрыть его.  
  
## <a name="how-to-manage-visible-and-invisible-documents"></a>Как управлять видимым и невидимым документов  
 Когда пользователь открывает документ в пользовательском Интерфейсе <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> владелец документа должно быть установлено и <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS> должен быть установлен флаг. Если не <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> владелец может быть установлено, а затем документа не будут сохранены, когда пользователь щелкает **сохранить все** или закрытии интегрированной среды разработки. Это означает, что если документ открыт незаметно там, где он изменен в памяти, и пользователю будет предложено сохранить документ при завершении работы или при сохранении Если **сохранить все** выбирается, а затем `RDT_ReadLock` нельзя использовать. Вместо этого необходимо использовать `RDT_EditLock` и зарегистрируйте <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> при <xref:Microsoft.VisualStudio.Shell.Interop.__VSREGDOCLOCKHOLDER> флаг.  
  
## <a name="rdteditlock-and-document-modification"></a>RDT_EditLock и изменение документа  
 Предыдущие упоминалось флаг указывает, что даст невидимым Открытие документа его `RDT_EditLock` при открытии документа пользователем в видимом **DocumentWindow**. В таких случаях пользователю предоставляется **Сохранить** приглашение по видимых **DocumentWindow** закрыт. Microsoft.VisualStudio.Package.Automation.OAProject.CodeModel реализаций, использующих <xref:Microsoft.VisualStudio.Shell.Interop.IVsInvisibleEditorManager> служба изначально работать, только если `RDT_ReadLock` берется (т. е. когда документ открыт незаметно для анализа информации о). Позже, если необходимо изменить его, затем блокировки будет обновлена до слабую **RDT_EditLock**. Если пользователь затем открывает документ в видимом **DocumentWindow**, `CodeModel`на слабый `RDT_EditLock` освобождается.  
  
 Если пользователь закрывает **DocumentWindow** и выбирает **нет** когда будет предложено сохранить открытый документ, то `CodeModel` реализация удаляет всю информацию в документе и заново не откроет документ с диска незаметно в следующий раз дополнительные информация необходима для документа. Тонкость такое поведение является экземпляром, где пользователь открывает **DocumentWindow** невидимым открытого документа, его изменение, закрывает его и затем выбирает **нет** когда будет предложено сохранить документ. В данном случае, если документ имеет `RDT_ReadLock`, затем документ фактически не закрывается, и измененный документ остается открытым незаметно в памяти, несмотря на то, что пользователь выбрал не сохранять документ.  
  
 Если невидимым Открытие документа использует слабую `RDT_EditLock`, то он возвращает его блокировки, когда пользователь открывает документ, визуально и нет других блокировки удерживаются. Когда пользователь закрывает **DocumentWindow** и выбирает **нет** при появлении запроса на сохранение документа, затем документ должен быть закрыт из памяти. Это означает, что невидимый клиента должны прослушивать события RDT для отслеживания этого экземпляра. В следующий раз документа является обязательным, его нужно открыть заново.
