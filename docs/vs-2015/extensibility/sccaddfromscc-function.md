---
title: Функция SccAddFromScc | Документация Майкрософт
ms.custom: ''
ms.date: 2018-06-30
ms.prod: visual-studio-dev14
ms.reviewer: ''
ms.suite: ''
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: ''
ms.topic: article
f1_keywords:
- SccAddFromScc
helpviewer_keywords:
- SccAddFromScc function
ms.assetid: 902e764d-200e-46e1-8c42-4da7b037f9a0
caps.latest.revision: 18
ms.author: gregvanl
manager: ghogen
ms.openlocfilehash: d1dd8ee409fd1facae82a8b8c6eeb418a68b4a6b
ms.sourcegitcommit: 55f7ce2d5d2e458e35c45787f1935b237ee5c9f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2018
ms.locfileid: "47559666"
---
# <a name="sccaddfromscc-function"></a>Функция SccAddFromScc
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Последнюю версию этого раздела можно найти в [функция SccAddFromScc](https://docs.microsoft.com/visualstudio/extensibility/sccaddfromscc-function).  
  
Эта функция позволяет пользователю для поиска файлов, которые уже находятся в системе управления версиями и следовательно, сделать частью текущего проекта, эти файлы. Например эту функцию можно получить общего файла заголовка в текущий проект без копирования файла. Возвращаемый массив файлов, `lplpFileNames`, содержащий список файлов, которые пользователю нужно добавить в проект интегрированной среды разработки.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp#  
SCCRTN SccAddFromScc (  
   LPVOID   pvContext,  
   HWND     hWnd,  
   LPLONG   lpnFiles,  
   LPCSTR** lplpFileNames  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Структура подключаемого модуля контекста исходного элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для любой диалоговых окон, которые он предоставляет.  
  
 lpnFiles  
 [in, out] Число файлов, которые добавляются в буфер. (Это `NULL` Если память, на которые указывают `lplpFileNames` необходимо снять. См. в разделе "Примечания" Дополнительные сведения.)  
  
 lplpFileNames  
 [in, out] Массив указателей на все имена файлов без пути к каталогам. Этот массив выделяется и освобождается, подключаемый модуль системы управления версиями. Если `lpnFiles` = 1 и `lplpFileNames` не `NULL`, имя массива, на который указывает `lplpFileNames` содержит папку назначения.  
  
## <a name="return-value"></a>Возвращаемое значение  
 Подключаемый модуль реализации элемента управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|-----------|-----------------|  
|SCC_OK|Файлы были успешно расположенный и добавлен в проект.|  
|SCC_I_OPERATIONCANCELED|Операция была отменена без влияния.|  
|SCC_I_RELOADFILE|Файл или проект должен быть перезагружен.|  
  
## <a name="remarks"></a>Примечания  
 Интегрированная среда разработки вызывает эту функцию. Если подключаемый модуль системы управления версиями поддерживает указание появится локальная целевая папка, в интегрированной среде разработки передает `lpnFiles` = 1 и передает имя локальной папки в `lplpFileNames`.  
  
 При вызов `SccAddFromScc` функция возвращает, подключаемый модуль назначил значения `lpnFiles` и `lplpFileNames`, выделение памяти для массива имя файла, при необходимости (Обратите внимание, что это выделение заменяет указатель в `lplpFileNames`). Подключаемый модуль системы управления версиями отвечает за размещение всех файлов в каталоге пользователя или в папке, указанной обозначение. Затем интегрированная среда разработки добавляет файлы в проект интегрированной среды разработки.  
  
 Наконец, интегрированной среды разработки вызывает эту функцию во второй раз, передавая `NULL` для `lpnFiles`. Это значение интерпретируется как специальный сигнал системой управления версиями, подключаемый модуль, чтобы освободить память, выделенную для массива имен файлов в `lplpFileNames``.`  
  
 `lplpFileNames` является `char ***` указатель. Подключаемый модуль системы управления версиями помещает указатель на массив указателей на имена файлов, тем самым передав списка обычным образом для этого API.  
  
> [!NOTE]
>  Начальной версии VSSCI API не предоставил возможность указать проект назначения для добавленных файлов. Для этого, семантика `lplpFIleNames` параметра были усовершенствованы, чтобы сделать его параметр in/out, а не параметром output. Если только один файл указан, то есть значение, на которые указывают `lpnFiles` = 1, то первый элемент `lplpFileNames` содержит целевую папку. Для использования этих новую семантику вызовов IDE `SccSetOption` функционировать с `nOption`параметру присвоить `SCC_OPT_SHARESUBPROJ`. Если подключаемый модуль системы управления версиями не поддерживает семантику, он возвращает `SCC_E_OPTNOTSUPPORTED`. Это так отключает использование **добавить из системы управления версиями** функции. Если подключаемый модуль поддерживает **добавить из системы управления версиями** функция (`SCC_CAP_ADDFROMSCC`), то он должен поддерживать новую семантику и вернуть `SCC_I_SHARESUBPROJOK`.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)   
 [SccSetOption](../extensibility/sccsetoption-function.md)

