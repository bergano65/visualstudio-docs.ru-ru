---
title: Развертывание MSI и VSIX доменного языка с | Документация Майкрософт
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-modeling
ms.topic: conceptual
ms.assetid: 6ce16f06-1978-4e19-8cdc-441ee65a3fb2
caps.latest.revision: 4
author: gewarren
ms.author: gewarren
manager: jillfra
ms.openlocfilehash: 3aaaf704e1ad8880ef7768ef9d7a23d325882a15
ms.sourcegitcommit: 1fc6ee928733e61a1f42782f832ead9f7946d00c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "60094442"
---
# <a name="msi-and-vsix-deployment-of-a-dsl"></a>Развертывание доменного языка с использование MSI и VSIX
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Доменный язык можно установить на своем компьютере или на других компьютерах. [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] должна быть установлена на конечном компьютере.  
  
## <a name="which"></a> Выбор между VSIX и MSI развертывания  
 Развертывание доменного языка двумя способами.  
  
|Метод|Преимущества|  
|------------|--------------|  
|VSX ([!INCLUDE[vsprvs](../includes/vsprvs-md.md)] расширения)|Значительно облегчает развертывание: Скопируйте и выполните **.vsix** файл из проекта DslPackage.<br /><br /> Дополнительные сведения см. в разделе [Установка и удаление доменного языка с помощью VSX](#Installing).|  
|MSI (файл установщика)|— Позволяет пользователю открыть [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] , дважды щелкнув файл DSL.<br />— Связывает значок с типом файла DSL на целевом компьютере.<br />— Связывает XSD (XML schema) с типом файла DSL. Это позволяет избежать предупреждения при загрузке файла в [!INCLUDE[vsprvs](../includes/vsprvs-md.md)].<br /><br /> Проект установки необходимо добавить в решение для создания файла MSI.<br /><br /> Дополнительные сведения см. в разделе [развертывание доменного языка с помощью MSI-файл](#msi).|  
  
## <a name="Installing"></a> Установка и удаление доменного языка с помощью VSX  
 При установке DSL с помощью данного метода, пользователь может открыть файл DSL изнутри [!INCLUDE[vsprvs](../includes/vsprvs-md.md)], но не удалось открыть файл из проводника Windows.  
  
#### <a name="to-install-a-dsl-by-using-the-vsx"></a>Чтобы установить DSL с помощью VSX  
  
1. На компьютере, найдите **.vsix** файл, который был создан проектом пакета DSL.  
  
    1. В **обозревателе решений**, щелкните правой кнопкой мыши **DslPackage** проекта, а затем нажмите кнопку **открыть папку в проводнике Windows**.  
  
    2. Найдите файл **bin\\\*\\**_Ваш_проект_**. DslPackage.vsix**  
  
2. Копировать **.vsix** файл на конечном компьютере, на котором вы хотите установить DSL. Это может быть как ваш собственный компьютер, так и любой другой.  
  
    - На конечном компьютере должен быть один из выпусков [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)] , поддерживающий доменных языков во время выполнения. Дополнительные сведения см. в разделе [поддерживается Visual Studio Editions визуализации и моделирования SDK](../modeling/supported-visual-studio-editions-for-visualization-amp-modeling-sdk.md).  
  
    - На конечном компьютере должен быть один из выпусков [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] указано в **DslPackage\source.extensions.manifest**.  
  
3. На целевом компьютере, дважды щелкните **.vsix** файл.  
  
     Откроется**установщик расширений Visual Studio** , который устанавливает расширение.  
  
4. Запустите или перезапустите [!INCLUDE[vs_current_short](../includes/vs-current-short-md.md)].  
  
5. Чтобы проверить DSL, используйте [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] для создания файла с расширением, которое было определено для DSL.  
  
#### <a name="to-uninstall-a-dsl-that-was-installed-by-using-vsx"></a>Удаление доменного языка, установленного с помощью VSX  
  
1. На **средства** меню, щелкните **Диспетчер расширений**.  
  
2. Разверните узел **Установленные расширения**.  
  
3. Выберите расширение, в котором определен DSL, а затем щелкните **удаления**.  
  
   Иногда неисправное расширение не удается загрузить, в результате чего в окне ошибок создается отчет, который не отображается в диспетчере расширений. В этом случае расширение можно удалить, удалив файл из следующей папки:  
  
   *LocalAppData* **\Microsoft\VisualStudio\10.0\Extensions**  
  
## <a name="msi"></a> Развертывание доменного языка в MSI  
 Определив файл MSI (установщик Windows) для DSL, можно разрешить пользователям открывать файлы DSL из проводника Windows. Значок и краткое описание также можно связать с расширением имени файла. Кроме того MSI-ФАЙЛ можно установить схему XSD, который может использоваться для проверки файлов DSL. Если требуется, можно добавить другие компоненты в MSI-ФАЙЛ, который будет установлен в то же время.  
  
 Дополнительные сведения о MSI-файлы и другие варианты развертывания, см. в разделе [развертывание приложений, служб и компонентов](../deployment/deploying-applications-services-and-components.md).  
  
 Чтобы создать MSI-ФАЙЛ, добавьте проект установки, чтобы ваши [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] решения. Самый простой способ создания проекта установки является использование шаблона CreateMsiSetupProject.tt, который можно загрузить из [сайте VMSDK](http://go.microsoft.com/fwlink/?LinkID=186128).  
  
#### <a name="to-deploy-a-dsl-in-an-msi"></a>Развертывание доменного языка в MSI  
  
1. Задайте `InstalledByMsi` в манифесте расширения. Это предотвращает VSX, установить и удалить за исключением, MSI-ФАЙЛ. Это важно, если другие компоненты будут включены в MSI-ФАЙЛ.  
  
   1. Open DslPackage\source.extension.tt  
  
   2. Вставьте следующую строку перед `<SupportedProducts>`:  
  
       ```  
       <InstalledByMsi>true</InstalledByMsi>  
       ```  
  
2. Создание или изменение значка, который будет представлять доменного языка в обозревателе Windows. Например, изменить **DslPackage\Resources\File.ico**  
  
3. Убедитесь, что верны следующие атрибуты вашего DSL:  
  
   - В обозревателе DSL щелкните корневой узел и в окне свойств просмотрите:  
  
       - Описание  
  
       - Версия  
  
   - Нажмите кнопку **редактор** узел и в окне «Свойства» щелкните **значок**. Задайте значение для ссылки на файл значка в **DslPackage\Resources**, такие как **File.ico**  
  
   - На **построения** откройте в меню **Configuration Manager**и выберите конфигурацию, которую требуется создать, такие как **выпуска** или **Отладка** .  
  
4. Перейдите к [Visualization and Modeling SDK Домашняя страница](http://go.microsoft.com/fwlink/?LinkID=186128)и из **Скачивает** вкладке, загрузите **CreateMsiSetupProject.tt**.  
  
5. Добавить **CreateMsiSetupProject.tt** в проект Dsl.  
  
    [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] будет создан файл с именем **CreateMsiSetupProject.vdproj**.  
  
6. В проводнике Windows, скопируйте Dsl\\\*.vdproj в новую папку с именем установки.  
  
    (Если требуется, вы теперь можно исключать CreateMsiSetupProject.tt из проекта доменного языка.)  
  
7. В **обозревателе решений**, добавьте **установки\\\*.vdproj** существующего проекта.  
  
8. На **проекта** меню, щелкните **зависимостей проекта**.  
  
    В **зависимостей проекта** диалоговом окне выберите проект установки.  
  
    Установите флажок рядом с полем **DslPackage**.  
  
9. Выполните повторную сборку решения.  
  
10. В проводнике Windows найдите построенный MSI-файл в проект установки.  
  
     Скопируйте MSI-файл на компьютер, на котором вы хотите установить DSL. Дважды щелкните MSI-файл. Запуск установщика.  
  
11. На целевом компьютере создайте новый файл с расширением вашего DSL. Убедитесь, что:  
  
    - В представлении списка в обозревателе Windows он отобразится значок и описание, которое было определено.  
  
    - Если дважды щелкнуть файл, [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] начинается и открывает файл DSL в редакторе DSL.  
  
    При желании можно создать проект установки вручную, вместо того чтобы использовать текстовый шаблон. Пошаговое руководство, которое включает в себя этой процедуры см. в разделе с главой 5 [визуализации и моделирования SDK лаборатории](http://go.microsoft.com/fwlink/?LinkId=208878).  
  
#### <a name="to-uninstall-a-dsl-that-was-installed-from-an-msi"></a>Удаление доменного языка, который был установлен из MSI-файла  
  
1. В Windows, откройте **программы и компоненты** панели управления.  
  
2. Удалите DSL.  
  
3. Перезапустите Visual Studio.
