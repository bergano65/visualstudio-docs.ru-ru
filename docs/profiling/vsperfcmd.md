---
title: VSPerfCmd | Документы Майкрософт
description: Сведения о средстве VSPerfCmd.exe, которое используется для запуска и остановки сбора данных производительности. Также в этой статье описываются различные параметры средства VSPerfCmd.
ms.date: 11/04/2016
ms.topic: reference
helpviewer_keywords:
- performance tools, VSPerfCmd tool
- command-line tools, VSPerfCmd tool
- command line, tools
- profiling tools,VSPerfCmd
- VSPerfCmd tool
ms.assetid: 778bc105-7643-46c4-a338-f3620e31125a
author: mikejo5000
ms.author: mikejo
manager: jmartens
monikerRange: vs-2017
ms.workload:
- multiple
ms.openlocfilehash: a501a3f815d48630afe1a849e91c1fdb52c979fa
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99911450"
---
# <a name="vsperfcmd"></a>VSPerfCmd
Средство *VSPerfCmd.exe* используется для запуска и остановки сбора данных производительности. Для этого используется следующий синтаксис:

```cmd
VSPerfCmd [/U] [/options]
```

 В приведенных ниже таблицах описываются параметры средства *VSPerfCmd.exe*.

|Параметр|Описание|
|------------|-----------------|
|**U**|Перенаправленный вывод на консоль записывается в кодировке Юникода. Эти параметры следует указывать первыми.|
|[Start](../profiling/start.md) **:** `mode`|Запускает службу профилирования в заданном режиме.|
|[Output](../profiling/output.md) **:** `filename`|Задает имя выходного файла. Используйте только с **Start**.|
|[CrossSession&#124;CS](../profiling/crosssession.md)|Включает профилирование в нескольких сеансах Windows. Используйте только с **Start**, **Attach** или **Launch**.|
|[User](../profiling/user-vsperfcmd.md) **:** [`domain\`]`username`|Включает доступ к службе профилировщика для заданной учетной записи. Используйте только с **Start**.|
|[WaitStart](../profiling/waitstart.md)[ **:** `n`]|Ожидает инициализации программы ведения журнала сбора данных. Если указано значение `n`, средство **VSPerfCmd** будет ожидать не более `n` с. Если значение `n` не указано, средство **VSPerfCmd** ожидает бесконечно. Это упрощает использование средства **VSPerfCmd** в рамках пакетного процесса.|
|[Counter](../profiling/counter.md) **:** `cfg`|При использовании метода профилирования с выборкой задает счетчик ЦП и количество событий, используемое в качестве интервала выборки. Можно указать только одно значение счетчика.<br /><br /> При использовании метода профилирования с инструментированием задает счетчик ЦП, значение которого собирается в каждой точке инструментирования. Используйте только с **Start:** `Trace`, **Attach** или **Launch**.|
|[QueryCounters](../profiling/querycounters.md)|Отображает список допустимых счетчиков ЦП для текущего компьютера.|
|[WinCounter](../profiling/wincounter.md) **:** *путь*|Задает событие счетчика производительности Windows, которое следует включить в данные меток профиля. Используйте только с **Start**.|
|[AutoMark](../profiling/automark.md) **:** *n*|Задает интервал времени (в миллисекундах) между событиями сбора данных счетчика производительности Windows. Используйте с только с **WinCounter**.|
|[Events](../profiling/events-vsperfcmd.md) **:** `option`|Управляет сбором сведений о заданных событиях из трассировки событий Windows. Данные трассировки событий Windows собираются в *ITL*-файл, который отличается от файлов данных профилирования (*VSP*).|
|[Состояние](../profiling/status.md)|Отображает состояние профилировщика, сведения о профилируемых в настоящий момент процессах и учетные записи, имеющие разрешения на управление профилировщиком.|
|[Shutdown](../profiling/shutdown.md)[ **:** `n`]|Закрывает файл данных профилирования и отключает профилировщик.|
|[GlobalOn](../profiling/globalon-and-globaloff.md)|Возобновляет сбор данных после вызова **VSPerfCmdGlobalOff**.|
|[GlobalOff](../profiling/globalon-and-globaloff.md)|Останавливает сбор всех данных, но не завершает сеанс профилирования.|
|[ProcessOn](../profiling/processon-and-processoff.md) **:** `pid`|Возобновляет сбор данных для указанного процесса после того, как профилирование было приостановлено путем вызова **VSPerfCmdProcessOff**.|
|[ProcessOff](../profiling/processon-and-processoff.md) **:** `pid`|Останавливает сбор данных для указанного процесса.|
|[ThreadOn и ThreadOff](../profiling/threadon-and-threadoff.md) **:** *tid*|Возобновляет профилирование для указанного процесса после того, как оно было приостановлено путем вызова **VSPerfCmdThreadOff**. Используйте **ThreadOn** только при профилировании с помощью метода инструментирования.|
|[ThreadOn и ThreadOff](../profiling/threadon-and-threadoff.md) **:** *tid*|Приостанавливает профилирование для заданного потока. Используйте **ThreadOff** только при профилировании с помощью метода инструментирования.|
|[Mark](../profiling/mark.md) **:** _MarkNum_[ **,** _MarkText_ **]**|Вставляет метку с необязательным текстом в файл данных профилирования.|

## <a name="sample-method-options"></a>Параметры метода выборки
 Приведенные ниже параметры доступны только при использовании метода профилирования с выборкой.

|Параметр|Описание|
|------------|-----------------|
|[Launch](../profiling/launch.md) **:** *исполняемый файл*|Запускает заданное приложение и начинает профилирование.|
|[Args](../profiling/args.md) **:** *аргументы*|Задает аргументы командной строки для передачи в запущенное приложение.|
|[Консоль](../profiling/console.md)|Запускает указанную команду в новом окне командной строки.|
|[Attach](../profiling/attach.md) **:** *PID*[ **,** _PID_]|Начинает профилирование указанных процессов. Процессы можно задавать по идентификатору или имени процесса.|
|[Detach](../profiling/detach.md)[ **:** _PID_[,_PID_]]|Останавливает профилирование указанных процессов. Процессы можно задавать по идентификатору или имени процесса. Если процесс не указан, профилирование останавливается для всех процессов.|
|[GC](../profiling/gc-vsperfcmd.md)[ **:** {**Allocation**`&#124;`**Lifetime**}]|Собирает данные о выделении памяти и времени существования объектов в .NET. Используйте только с параметром **VSPerfCmdLaunch**.|

### <a name="sample-interval-options"></a>Параметры интервала выборки
 Приведенные ниже параметры определяют тип и продолжительность интервалов выборки. Значение по умолчанию — **Timer**. Кроме того, с помощью параметра **Counter** можно задать в качестве интервала счетчик ЦП. Эти параметры можно задавать только с параметром **Launch** или с первым параметром **Attach** сеанса профилирования.

|Параметр|Описание|
|------------|-----------------|
|[PF](../profiling/pf.md)[ **:** _n_]|Выполняет выбор на каждой n-ой ошибке страницы (значение по умолчанию — 10).|
|[Sys](../profiling/sys-vsperfcmd.md)[ **:** _n_]|Выполняет выбор при каждом n-ом системном вызове (значение по умолчанию — 10).|
|[Timer](../profiling/timer.md)[ **:** _n_]|Выполняет выбор на каждом n-ом цикле процессора (значение по умолчанию — 10 000 000).|

## <a name="service-component-and-kernel-mode-device-options"></a>Параметры для компонентов служб и работающих в режиме ядра драйверов устройств
 Перечисленные ниже параметры Admin поддерживают компоненты служб профилирования или работающие в режиме ядра драйверы устройств. Параметры Admin задают разрешения профилирования и управляют профилируемой службой или драйвером устройства.

 Параметры Admin следует использовать в командной строке, запущенной от имени учетной записи с правами администратора.

|Параметр|Описание|
|------------|-----------------|
|**Admin:Security**, \<**ALLOW&#124;DENY**>, *Right*[ *Right*], \<*User*&#124;*Group*>|Разрешает или запрещает указанному пользователю или указанной группе доступ к службам профилирования.<br /><br /> Параметр `Right` может принимать следующие значения:<br /><br /> CrossSession — предоставляет пользователю доступ к службе для выполнения межсеансового профилирования.<br /><br /> SampleProfiling — предоставляет пользователю доступ к драйверу для включения профилирования с выборкой. Также используется для доступа к сведениям о переходе в режим ядра во время профилирования с трассировкой.<br /><br /> FullAccess — предоставляет пользователю права, определяемые параметрами CrossSession и SampleProfiling.|
|**Admin:Security, List**|Выводит текущее состояние служб профилирования и разрешения пользователей.|
|**Admin:** \<*Service*&#124;*Driver*>\<**START**&#124;**STOP**&#124;**INSTALL**&#124;**UNINSTALL**>|Запускает, останавливает, устанавливает или удаляет компонент службы профилирования (служба) или драйвер устройства, работающий в режиме ядра (драйвер).|
|**Admin:** \<*Service*&#124;*Driver*>**AutoStart**\<**ON**&#124;**OFF**>|Включает или отключает автоматический запуск службы профилирования (служба) или драйвер устройства, работающий в режиме ядра (драйвер), после перезапуска.|

## <a name="vsperfcmd-driver"></a>VSPerfCmd /Driver
 Параметр **VSPerfCmd/Driver** больше не используется. Вместо него следует использовать параметры **VsPerfCmd Admin**.

## <a name="see-also"></a>См. также
- [VSInstr](../profiling/vsinstr.md)
- [VSPerfMon](../profiling/vsperfmon.md)
- [VSPerfReport](../profiling/vsperfreport.md)
