---
title: Профилирование в кластерах высокопроизводительных вычислительных систем (HPC) | Документы Майкрософт
description: Сведения о профилировании вычислительных узлов кластеров Microsoft Windows HPC с использованием выборки средств профилирования Visual Studio.
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- vs.performance.hpc.wizard.exeoptions
- vs.performance.hpc.wizard.summary
- vs.performance.hpc.wizard.startoptions
- vs.performance.hpc.wizard.intro
- vs.performance.hpc.property.basic
- vs.performance.hpc.wizard.application
- vs.performance.hpc.wizard.clusteroptions
- vs.performance.hpc.property.advanced
helpviewer_keywords:
- profililng tools,HPC
- HPC profiling
author: mikejo5000
ms.author: mikejo
manager: jmartens
monikerRange: vs-2017
ms.workload:
- multiple
ms.openlocfilehash: 3faea797d57ca8874a198e5ee1bf76708ee20e7a
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99917561"
---
# <a name="profile-on-hpc-high-performance-computing-clusters"></a>Профилирование в кластерах высокопроизводительных вычислительных систем (HPC)

Профилирование вычислительных узлов кластеров Microsoft Windows HPC можно выполнять с использованием выборки Средств профилирования Visual Studio. Дополнительные сведения о HPC см. в разделе [Windows HPC](https://azure.microsoft.com/solutions/big-compute/) на странице веб-сайта корпорации Майкрософт.

## <a name="prerequisites"></a>Предварительные требования

Для профилирования на вычислительном узле HPC нужно выполнить следующие действия.

- Установите пакет Microsoft HPC 2008 на компьютере с Visual Studio. Этот компьютер не должен входить в состав кластера HPC. Можно установить пакет HPC из [Центра загрузки Майкрософт](https://www.microsoft.com/download/details.aspx?id=4812).

- Установите .NET Framework 4 и автономную версию Средств профилирования на вычислительном узле HPC. Установите программы для .NET Framework и автономного профилировщика, доступные на установочном носителе Visual Studio. **Примечание**. Необходимо перезапустить компьютер после установки .NET Framework, но перед установкой Средств профилирования.

  Чтобы установить .NET Framework 4 и автономные Средства профилирования на активном вычислительном узле HPC и включить профилирование на компьютере кластера, выполните следующие действия:

1. Откройте окно командной строки, которая устанавливается вместе с пакетом HPC.

2. В отдельных командных строках введите следующие команды:

    1. `clusrun /all /scheduler:` *%HeadNode% %FxPath%* `/q /norestart`

    2. `clusrun /all /scheduler:` *%HeadNode%* `shutdown /r /t 0 /d u:4:2 /c "Microsoft .NET Framework install required restart"`

    3. `clusrun /all /scheduler:` *%HeadNode% %ProfilerPath%* `/q /norestart`

| | |
|------------------| - |
| *%HeadNode%* | Имя головного узла кластера. |
| *%FxPath%* | Путь к установщику .NET Framework 4. На установочном носителе Visual Studio этот путь — WCU\dotNetFramework\dotNetFx40_Full_x86_x64.exe. |
| *%ProfilerPath%* | Путь к автономной версии установщика средств профилирования. На установочном носителе Visual Studio этот путь — Standalone Profiler\x64\vs_profiler.exe. |

## <a name="profile-on-an-hpc-compute-node"></a>Профилирование в вычислительном узле HPC

Чтобы задать кластер HPC и целевые данные, нужно настроить сеанс профилирования с помощью мастера производительности HPC. На страницах свойств сеанса производительности можно задать дополнительные параметры. Средства профилирования автоматически развертывают необходимые целевые двоичные файлы и запускают профилировщик и приложение HPC.

1. В меню **Анализ** выберите команду **Запустить мастер производительности HPC**. Если команда недоступна, убедитесь в наличии перечисленных выше необходимых компонентов.

2. На первой странице мастера нажмите кнопку **Далее**.

3. На второй странице мастера выберите приложение, которое требуется профилировать.

   - Для профилирования проекта, открытого в [!INCLUDE[vs_current_short](../code-quality/includes/vs_current_short_md.md)], выберите параметр **Один или несколько доступных проектов**, а затем имя проекта в списке.

   - Для профилирования двоичного файла, не находящегося в открытом проекте, выберите параметр **Исполняемый файл (EXE-файл)**.

4. Щелкните **Далее**.

5. На третьей странице мастера:

    - При профилировании исполняемого файла, не находящегося в открытом проекте, задайте путь к двоичному файлу в поле **Каков полный путь к исполняемому файлу**.

    - При профилировании исполняемого файла, не находящегося в открытом проекте, можно задать в качестве значения аргумента командной строки путь к процессу в поле **Аргументы командной строки**.

    - В поле **Удаленный рабочий каталог** укажите путь к папке, которая используется экземплярами процесса в отдельных вычислительных узлах.

    - В поле **Расположение развертывания** укажите путь к каталогу, используемому сервером HPC для размещения образов для развертывания.

6. Щелкните **Далее**.

7. На четвертой странице мастера выполните следующие действия.

    - В списке **Головной узел** щелкните компьютер, выполняющий функцию головного узла HPC в сеансе профилирования. Головным узлом может быть "localhost", который позволяет выполнять профилирование на локальном компьютере без необходимости использования кластера.

    - В списке **Число процессов** выберите число экземпляров приложения, которые необходимо запустить.

    - В списке **Параметры профилирования** выберите целевой объект профилирования.

         Для профилирования определенных процессов в кластере выберите параметр **Профиль в ранге**, а затем ранг процесса в раскрывающемся списке.

         Для профилирования процесса или процессов, выполняемых в определенном узле кластера HPC, выберите параметр **Профиль в узле**, а затем узел процесса в раскрывающемся списке.

8. Щелкните **Далее**.

9. На пятой странице мастера можно выбрать непосредственный запуск профилировщика и процесса профилирования или выполнение профилирования позже с помощью обозревателя производительности.

    - Установите флажок **Запустить профилирование после завершения работы мастера**, чтобы запустить профилирование непосредственно сразу, или снимите этот флажок, чтобы запустить его вручную.

10. Нажмите кнопку **Готово**.

## <a name="set-hpc-profiling-properties-by-using-performance-session-property-pages"></a>Настройка свойств профилирования HPC с помощью страниц свойств сеанса анализа производительности

Свойства сеанса анализа производительности, заданные в мастере профилирования HPC, можно изменить на странице "Свойства запуска HPC". На странице "Дополнительные свойства HPC" можно задать дополнительные параметры.

### <a name="to-open-the-performance-session-property-pages"></a>Открытие страниц свойств сеанса производительности

1. При необходимости файл сеанса анализа производительности (PSESS) можно открыть в обозревателе производительности. В меню **Файл** щелкните **Открыть** и выберите файл.

2. В обозревателе производительности щелкните правой кнопкой мыши имя сеанса анализа производительности и выберите пункт **Свойства**.

3. В диалоговом окне "Страницы свойств" воспользуйтесь одним из следующих методов.

    - Перейдите на вкладку **Общие** и установите флажок **Сбор на кластере HPC**, чтобы включить профилирование HPC, или снимите этот флажок, чтобы его отключить.

    - Щелкните **Свойства запуска HPC**, чтобы изменить свойства, используемые при запуске приложения HPC.

    - Щелкните **Дополнительные свойства HPC**, чтобы задать дополнительные параметры.

### <a name="hpc-launch-properties"></a>Свойства запуска HPC

|Свойство|Описание|
|--------------|-----------------|
|**Головной узел**|Задает компьютер, выполняющий функцию головного узла HPC в сеансе профилирования.|
|**Число процессов**|Задает число экземпляров приложения, которые необходимо запустить в профилируемом приложении.|
|**Профиль в ранге**|Для профилирования определенных процессов в кластере выберите параметр **Профиль в ранге**, а затем ранг процесса в раскрывающемся списке.|
|**Профиль в узле**|Для профилирования процесса или процессов, выполняемых в определенном узле кластера HPC, выберите параметр **Профиль в узле**, а затем узел процесса в раскрывающемся списке.|
|**Удаленный рабочий каталог**|Задает путь к папке, которая используется экземплярами процесса в отдельных вычислительных узлах.|
|**Расположение развертывания**|Задает путь к каталогу, используемому сервером HPC для размещения образов для развертывания.|

### <a name="advanced-properties"></a>Дополнительные свойства

| Свойство | Описание |
|---------------------------------------| - |
| **Имя проекта** | Имя текущего проекта или решения [!INCLUDE[vs_current_short](../code-quality/includes/vs_current_short_md.md)]. |
| **Выполнить очистку после остановки профилировщика** | Если этот параметр активен, удаляет двоичные файлы, развернутые в каталоге выполнения. Файлы и каталоги, созданные пользовательской программой, на этом этапе не удаляются. Если каталог выполнения и каталог развертывания были созданы интерфейсом IDE, IDE пытается их удалить, однако если в этих каталогах есть файлы, развернутые не интерфейсом IDE, он этого не делает. |
| **Дополнительные файлы, которые необходимо развернуть** | Задает список всех дополнительных файлов для развертывания на вычислительном узле, разделенных точкой с запятой. Можно нажать кнопку с многоточием (**...**), чтобы выбрать несколько файлов с помощью диалогового окна. |
| **Команда mpiexec** | Задает приложение, которое запускает MPI-приложение. Значение по умолчанию — **mpiexec.exe**. |
| **Аргументы команды mpiexec** | Задает аргументы, передаваемые команде mpiexec.exe. |
| **Запрошенные узлы в кластере** | Задает число узлов в кластере, в котором необходимо запустить приложение. |
| **Развернуть CRT-файлы** | Если это свойство активно, развертывает в кластере среду выполнения C/C++. |
| **Скрипт предварительного профилирования** | Задает путь и имя файла скрипта для запуска на локальном компьютере разработки перед запуском сеанса профилирования. |
| **Аргументы скрипта предварительного профилирования** | Задает аргументы, передаваемые скрипту предварительного профилирования. |
| **Скрипт пост-профилирования** | Задает путь и имя файла скрипта для запуска на локальном компьютере разработки после завершения сеанса профилирования. |
| **Аргументы скрипта пост-профилирования** | Задает аргументы, передаваемые скрипту пост-профилирования. |
