---
title: "Анализ потребления ресурсов для приложений XAML в Visual Studio | Документация Майкрософт"
ms.custom: H1Hack27Feb2017
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-debug
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: df7d854b-0a28-45a9-8a64-c015a4327701
caps.latest.revision: "11"
author: mikejo5000
ms.author: mikejo
manager: ghogen
ms.openlocfilehash: 32d6ac2581f71196d1f1d826d8f1024906b7cab9
ms.sourcegitcommit: 26419ab0cccdc30d279c32d6a841758cfa903806
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/11/2017
---
# <a name="analyze-resource-consumption-and-ui-thread-activity-xaml"></a>Анализ потребления ресурсов и активности потоков пользовательского интерфейса (XAML)
Используйте профилировщик **Временная шкала приложения** , чтобы найти и исправить проблемы производительности в работе приложений XAML, связанные с взаимодействием. Это средство помогает улучшить производительность приложений XAML, предоставляя подробные сведения об использовании ресурсов приложений. Вы можете проанализировать время, затраченное приложением на подготовку кадров пользовательского интерфейса (макет и обработка), обработку запросов от сети и дисков, а также на такие сценарии, как запуск приложения, загрузка страницы и изменение размера окон.  
  
 **Временная шкала приложения** — это одно из средств, которое можно запустить, выбрав **Отладка | Профилировщик производительности**.  
  
 Это средство заменяет средство **проверки скорости реагирования пользовательского интерфейса XAML** , которое входило в набор средств диагностики для Visual Studio 2013.  
  
 Вы можете использовать это средство на следующих платформах:  
  
1.  универсальные приложения для Windows (на Windows 10);  
  
2.  Windows 8.1  
  
3.  Windows Phone 8.1 (обычная платформа XAML);  
  
4.  Windows Presentation Foundation (.NET 4.0 и более поздней версии).  
  
5.  Windows 7  
  
> [!NOTE]
>  Вы можете собирать и анализировать данные о загрузке ЦП и энергопотреблении вместе с данными средства **Временная шкала приложения** . См. статью [Running Profiling Tools with or without the Debugger](../profiling/running-profiling-tools-with-or-without-the-debugger.md) (Выполнение средств профилирования с отладчиком или без него).
  
##  <a name="BKMK_Collect_Timeline_data_for_your_app"></a> Сбор данных временной шкалы приложения  
 Скорость реагирования приложения можно профилировать на локальном компьютере, подключенном устройстве, симуляторе или эмуляторах Visual Studio либо на удаленном устройстве. См. статью [Running Profiling Tools with or without the Debugger](../profiling/running-profiling-tools-with-or-without-the-debugger.md) (Выполнение средств профилирования с отладчиком или без него).
  
> [!TIP]
>  Если это возможно, запустите приложение непосредственно на устройстве. Производительность приложения, наблюдаемая на имитаторе или посредством подключения к удаленному рабочему столу, может отличаться от фактической производительности на устройстве. С другой стороны, сбор данных с помощью инструментов удаленной отладки Visual Studio не влияет на данные о производительности.  
  
 Ниже перечислены основные шаги.  
  
1.  Откройте приложение XAML.  
  
2.  Выберите **Отладка/профилировщик производительности**. Должен появиться список средств профилирования в окне DIAGSESSION.  
  
3.  Выберите **Временная шкала приложения** и щелкните **Запустить** в нижней части окна.  
  
    > [!NOTE]
    >  Может появиться окно «Контроль учетных записей» с запросом на разрешение запуска файла VsEtwCollector.exe. Нажмите кнопку **Да**.  
  
4.  Запустите интересующий вас сценарий профилирования в приложении, чтобы собрать данные о производительности.  
  
5.  Чтобы остановить профилирование, переключитесь обратно на окно DIAGSESSION и щелкните **Остановить** в верхней части окна.  
  
     Visual Studio анализирует собранные данные и отображает результаты.  
  
     ![Отчет профилировщика временной шкалы](../profiling/media/timeline_base.png "TIMELINE_Base")  
  
##  <a name="BKMK_Analyze_Timeline_profiling_data"></a> Анализ данных профилирования средства "Временная шкала"  
 После сбора данных профилирования выполните следующие действия для запуска анализа.  
  
1.  Просмотрите информацию на диаграммах **Использование потока пользовательского интерфейса** и **Пропускная способность визуализации (кадров/с)** , а затем с помощью панелей навигации временной шкалы выберите диапазон времени, который требуется проанализировать.  
  
2.  Используя информацию на диаграммах **Использование потока пользовательского интерфейса** или **Пропускная способность визуализации (кадров/с)** , просмотрите сведения в представлении **Сведения о временной шкале** , чтобы определить возможные причины любой явной нехватки скорости реагирования.  
  
###  <a name="BKMK_Report_scenarios_categories_and_events"></a> Сценарии отчетов, категории и события  
 Средство **Временная шкала приложения** отображает данные о времени для сценариев, категорий и событий, которые относятся к производительности XAML.  
  
###  <a name="BKMK_Diagnostic_session_timeline"></a> Временная шкала диагностического сеанса  
 ![Временная шкала производительности и диагностики](../profiling/media/diaghub_timelinewithusermarks.png "DIAGHUB_TimelineWithUserMarks")  
  
 На линейке в верхней части страницы отображается временная шкала профилированной информации. Эта шкала применяется для диаграмм **Использование потока пользовательского интерфейса** и **Пропускная способность визуализации** . Область отчета можно сузить, перетащив панели навигации на временной шкале, чтобы выбрать ее сегмент.  
  
 На временной шкале также отображаются все вставленные пользовательские отметки и события жизненного цикла активации приложения.  
  
###  <a name="BKMK_UI_thread_utilization_graph"></a> Диаграмма использования потока пользовательского интерфейса  
 ![Диаграмма использования ЦП](../profiling/media/timeline_cpuutilization.png "TIMELINE_CpuUtilization")  
  
 Диаграмма **Использование потока пользовательского интерфейса (%)** представляет собой линейчатую диаграмму, которая отображает относительный объем потраченного времени в категории в ходе сбора данных.  
  
###  <a name="BKMK_Visual_throughput_FPS_graph"></a> Диаграмма пропускной способности визуализации (кадров/с)  
 ![Диаграмма пропускной способности визуализации](../profiling/media/timeline_visualthroughput.png "TIMELINE_VisualThroughput")  
  
 На диаграмме **Пропускная способность визуализации (кадров/с)** отображается число кадров в секунду в пользовательском интерфейсе и потоке компоновки приложения.  
  
###  <a name="BKMK_Timeline_details_"></a> Сведения о временной шкале  
 Большая часть времени будет уходить на анализ отчета в подробном представлении. В нем показаны все сведения о загрузке ЦП в приложении по категориям: для подсистемы платформы пользовательского интерфейса или для компонента системы, который использует ресурсы ЦП.  
  
 Поддерживаются следующие события:  
  
|||  
|-|-|  
|**Синтаксический анализ**|Время, затраченное на синтаксический анализ файлов XAML и создание объектов.<br /><br /> Расширение узла **Синтаксический анализ** в представлении **Сведения о временной шкале** позволяет отображать цепочку зависимостей всех файлов XAML, которые были проанализированы в результате корневого события. Это позволит идентифицировать ненужный синтаксический анализ файлов и создание объектов в сценариях, чувствительных к производительности, и оптимизировать их.|  
|**Макет**|В больших приложениях на экране могут одновременно отображаться тысячи элементов. Это может привести к низкой частоте кадров пользовательского интерфейса и, соответственно, низкой скорости ответа приложения. Событие макета (Layout) точно определяет затраты на размещение каждого элемента (например, время затраченное на Arrange, Measure, ApplyTemplate, ArrangeOverride и ArrangeOverride) и выполняет сборку визуальных деревьев, которые участвуют в передаче макета. Вы можете использовать эту визуализацию, чтобы определить, какие логические деревья требуют очистки, а также для оценки других механизмов отсрочки для оптимизации передачи макета.|  
|**Прорисовка**|Время, затраченное на прорисовку элементов XAML на экране.|  
|**Операции ввода-вывода**|Время, затраченное на получение данных с локального диска или из сетевых ресурсов, доступ к которым выполняется через [Microsoft Windows Internet (WinINet) API](https://msdn.microsoft.com/en-us/library/windows/desktop/aa385331.aspx).|  
|**Код приложения**|Время, затраченное на выполнение (пользовательского) кода приложения, который не связан с синтаксическим анализом и созданием макета.|  
|**Другие данные XAML**|Время, потраченное на исполнение кода среды выполнения XAML.|  
  
> [!TIP]
>  Выберите средство **Использование ЦП** вместе со средством **Временная шкала приложения** при запуске профилирования, чтобы просмотреть методы приложений, которые выполняются в потоке пользовательского интерфейса. Перемещение кода приложения с длительным временем выполнения в фоновый поток может повысить скорость реагирования ИП.  
  
####  <a name="BKMK_Customizing_Timeline_details_"></a> Настройка сведений о временной шкале  
 Для сортировки, фильтрации и указания заметок для записей представления **Сведения о временной шкале** используйте панель инструментов **Сведения о временной шкале** .  
  
|||  
|-|-|  
|**Сортировать по**|Сортировка по времени начала или длительности событий.|  
|![Группировка событий по кадру](../profiling/media/timeline_groupbyframes.png "TIMELINE_GroupByFrames")|Добавляет или удаляет категорию **Кадр** верхнего уровня, которая группирует события по кадрам.|  
|![Фильтрация списка сведений о временной шкале](../profiling/media/timeline_filter.png "TIMELINE_Filter")|Фильтрует список по выбранным категориям и длительности событий.|  
|![Настройка сведений о временной шкале](../profiling/media/timeline_viewsettings.png "TIMELINE_ViewSettings")|Позволяет указать заметки для событий.|  
  
## <a name="see-also"></a>См. также  
 [Блог группы разработчиков WPF. Новое средство анализа производительности пользовательского интерфейса для приложений WPF](http://blogs.msdn.com/b/wpf/archive/2015/01/16/new-ui-performance-analysis-tool-for-wpf-applications.aspx)  
 [Рекомендации по повышению производительности для приложений универсальной платформы Windows на C++, C# и Visual Basic](http://msdn.microsoft.com/en-us/567bcefa-5da5-4e42-a4b8-1358c71adfa2)   
 [Улучшение производительности приложений WPF](/dotnet/framework/wpf/advanced/optimizing-wpf-application-performance)  
 [Профилирование в Visual Studio](../profiling/index.md)  
 [Обзор возможностей профилирования](../profiling/profiling-feature-tour.md)
