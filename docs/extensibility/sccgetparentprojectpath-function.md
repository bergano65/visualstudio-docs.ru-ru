---
title: Функция Сккжетпарентпрожектпас | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccGetParentProjectPath
helpviewer_keywords:
- SccGetParentProjectPath function
ms.assetid: 62a71579-36b3-48b9-a1c8-04ab100efa08
author: acangialosi
ms.author: anthc
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 825586ed29152bddf0f5dd909f71f96c96db8624
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99958405"
---
# <a name="sccgetparentprojectpath-function"></a>Функция Сккжетпарентпрожектпас
Эта функция определяет родительский путь к проекту для указанного проекта. Эта функция вызывается, когда пользователь добавляет проект Visual Studio в систему управления версиями.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccGetParentProjectPath(
   LPVOID pContext,
   HWND   hWnd,
   LPSTR  lpUser,
   LPCSTR lpProjPath,
   LPSTR  lpAuxProjPath,
   LPSTR  lpParentProjPath
);
```

### <a name="parameters"></a>Параметры
 pContext

окне Указатель контекста для подключаемого модуля системы управления версиями.

 hWnd

окне Обработчик окна интегрированной среды разработки, который может использоваться подключаемым модулем системы управления версиями в качестве родительского для любых предоставляемых им диалоговых окон.

 лпусер

[вход, выход] Имя пользователя (до SCC_USER_SIZE, включая знак завершения NULL).

 лппрожпас

окне Строка, идентифицирующая путь к проекту (до SCC_PRJPATH_SIZE, включая знак завершения NULL).

 лпаукспрожпас

[вход, выход] Вспомогательная строка, идентифицирующая проект (до SCC_PRJPATH_SIZE, включая знак завершения NULL).

 лппарентпрожпас

[вход, выход] Выходная строка, идентифицирующая родительский путь проекта (до SCC_PRJPATH_SIZE, включая знак завершения NULL).

## <a name="return-value"></a>Возвращаемое значение
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Путь к родительскому проекту успешно получен.|
|SCC_E_INITIALIZEFAILED|Не удалось инициализировать проект.|
|SCC_E_INVALIDUSER|Пользователь не смог войти в подключаемый модуль системы управления версиями.|
|SCC_E_UNKNOWNPROJECT|Проект неизвестен для подключаемого модуля системы управления версиями.|
|SCC_E_INVALIDFILEPATH|Недопустимый или непригодный к использованию путь к файлу.|
|SCC_E_NOTAUTHORIZED|Пользователю не разрешено выполнять эту операцию.|
|SCC_E_ACCESSFAILURE|Возникла проблема при доступе к системе управления версиями, возможно, из-за проблем с сетью или состязаниями. Рекомендуется повторить попытку.|
|SCC_E_PROJSYNTAXERR|Недопустимый синтаксис проекта.|
|SCC_E_CONNECTIONFAILURE|Проблема с подключением к хранилищу.|
|SCC_E_NONSPECIFICERROR<br /><br /> SCC_E_UNKNOWNERROR|Неконкретный сбой.|

## <a name="remarks"></a>Remarks
 Эта функция возвращает код успешного или неуспешного выполнения, и в случае успеха заполняет переменную `lpParentProjPath` полным путем к указанному проекту.

 Эта функция возвращает путь к родительскому проекту существующего проекта. Для корневого проекта функция возвращает путь к переданному проекту (то есть тот же корневой путь проекта). Обратите внимание, что путь проекта — это строка, которая имеет смысл только для подключаемого модуля системы управления версиями.

 Интегрированная среда разработки готова принять изменения `lpUser` `lpAuxProjPath` параметров и. Интегрированная среда разработки сохранит эти строки и передаст их в [сккопенпрожект](../extensibility/sccopenproject-function.md) , когда пользователь откроет этот проект в будущем. Таким образом, эти строки позволяют подключаемому модулю системы управления версиями контролировать информацию, которую необходимо связать с проектом.

 Эта функция похожа на [сккжетпрожпас](../extensibility/sccgetprojpath-function.md), за исключением того, что она не предлагает пользователю выбрать проект. Он также никогда не создает новый проект, но работает только с существующим проектом.

 При `SccGetParentProjectPath` вызове метод `lpProjPath` и `lpAuxProjPath` не будет пустым и будет соответствовать допустимому проекту. Эти строки обычно получаются интегрированной средой разработки из предыдущего вызова `SccGetProjPath` функции.

 `lpUser`Аргумент — это имя пользователя. Интегрированная среда разработки передает то же имя пользователя, которое ранее было получено от `SccGetProjPath` функции, а подключаемый модуль системы управления версиями должен использовать имя в качестве значения по умолчанию. Если у пользователя уже есть открытое подключение к подключаемому модулю, то подключаемый модуль должен попытаться устранить все запросы, чтобы убедиться, что функция работает автоматически. Однако если происходит сбой входа, подключаемый модуль должен запрашивать у пользователя имя входа и при получении допустимого имени входа снова передавать его в `lpUser` . Так как подключаемый модуль может изменить эту строку, интегрированная среда разработки всегда будет распределять буфер размера ( `SCC_USER_LEN` + 1). Если строка изменена, Новая строка должна быть допустимым именем для входа (по крайней мере, как и старая строка).

## <a name="technical-notes-for-scccreatesubproject-and-sccgetparentprojectpath"></a>Технические примечания для Скккреатесубпрожект и Сккжетпарентпрожектпас
 Добавление решений и проектов в систему управления версиями было упрощено в Visual Studio, чтобы максимально сокращать число запросов на выбор расположений в системе управления версиями. Эти изменения активируются Visual Studio, если подключаемый модуль системы управления версиями поддерживает обе новые функции, [скккреатесубпрожект](../extensibility/scccreatesubproject-function.md) и `SccGetParentProjectPath` функцию. Однако можно использовать следующую запись реестра для отключения этих изменений и вернуться к предыдущему поведению Visual Studio (интерфейс API подключаемого модуля системы управления версиями 1,1):

 **[HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\8.0\SourceControl] "Доноткреатесолутионрутфолдеринсаурцеконтрол" = DWORD: 00000001**

 Если эта запись реестра не существует или имеет значение "DWORD": 00000000, Visual Studio пытается использовать новые функции `SccCreateSubProject` и `SccGetParentProjectPath` .

 Если для записи реестра задано значение DWORD: 00000001, Visual Studio не пытается использовать эти новые функции, а операции добавления в систему управления версиями работают так же, как и в предыдущих версиях Visual Studio.

## <a name="see-also"></a>См. также раздел
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccCreateSubProject](../extensibility/scccreatesubproject-function.md)
- [SccGetProjPath](../extensibility/sccgetprojpath-function.md)
