---
title: Функция Скксетоптион | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccSetOption
helpviewer_keywords:
- SccSetOption function
ms.assetid: 4b5e6666-c24c-438a-a9df-9c52f58f8175
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 1adcbb47e9fce7037fe8942326e8836ade51e3eb
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/02/2020
ms.locfileid: "80700313"
---
# <a name="sccsetoption-function"></a>Функция SccSetOption
Эта функция задает параметры, управляющие поведением подключаемого модуля системы управления версиями.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccSetOption(
   LPVOID pvContext,
   LONG   nOption,
   LONG   dwVal
);
```

#### <a name="parameters"></a>Параметры
 пвконтекст

окне Структура контекста подключаемого модуля системы управления версиями.

 ноптион

окне Заданный параметр.

 дввал

окне Параметры для параметра.

## <a name="return-value"></a>Возвращаемое значение
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Параметр успешно установлен.|
|SCC_I_SHARESUBPROJOK|Возвращается, если `nOption` WAS `SCC_OPT_SHARESUBPROJ` и подключаемый модуль системы управления версиями позволяют интегрированной среде разработки задать целевую папку.|
|SCC_E_OPNOTSUPPORTED|Параметр не был задан, и на него не следует полагаться.|

## <a name="remarks"></a>Remarks
 Интегрированная среда разработки вызывает эту функцию для управления поведением подключаемого модуля системы управления версиями. Первый параметр, `nOption` , указывает заданное значение, а второе — `dwVal` указывает, что делать с этим значением. Подключаемый модуль хранит эти сведения, связанные с a, `pvContext``,` Поэтому интегрированная среда разработки должна вызвать эту функцию после вызова [скЦинитиализе](../extensibility/sccinitialize-function.md) (но не обязательно после каждого вызова [сккопенпрожект](../extensibility/sccopenproject-function.md)).

 Сводка параметров и их значений:

|`nOption`|`dwValue`|Описание|
|---------------|---------------|-----------------|
|`SCC_OPT_EVENTQUEUE`|`SCC_OPT_EQ_DISABLE`<br /><br /> `SCC_OPT_EQ_ENABLE`|Включает или отключает фоновую очередь событий.|
|`SCC_OPT_USERDATA`|Произвольное значение|Указывает значение пользователя, передаваемое функции обратного вызова [оптнамечанжепфн](../extensibility/optnamechangepfn.md) .|
|`SCC_OPT_HASCANCELMODE`|`SCC_OPT_HCM_NO`<br /><br /> `SCC_OPT_HCM_YES`|Указывает, поддерживает ли IDE в настоящее время отмену операции.|
|`SCC_OPT_NAMECHANGEPFN`|Указатель на функцию обратного вызова [оптнамечанжепфн](../extensibility/optnamechangepfn.md)|Задает указатель на функцию обратного вызова изменения имени.|
|`SCC_OPT_SCCCHECKOUTONLY`|`SCC_OPT_SCO_NO`<br /><br /> `SCC_OPT_SCO_YES`|Указывает, допускает ли интегрированная среда разработки извлечение файлов вручную (через пользовательский интерфейс системы управления версиями) или они должны извлекаться только через подключаемый модуль системы управления версиями.|
|`SCC_OPT_SHARESUBPROJ`|Н/Д|Если подключаемый модуль системы управления версиями позволяет интегрированной среде разработки указать локальную папку проекта, подключаемый модуль возвращает `SCC_I_SHARESUBPROJOK` .|

## <a name="scc_opt_eventqueue"></a>SCC_OPT_EVENTQUEUE
 Если `nOption` имеет значение `SCC_OPT_EVENTQUEUE` , интегрированная среда разработки отключает (или повторно включает) фоновую обработку. Например, во время компиляции в интегрированной среде разработки может быть указано, что подключаемый модуль системы управления версиями должен останавливаться на неактивной обработке любого типа. После компиляции будет повторно включен режим фоновой обработки для обновления очереди событий подключаемого модуля. В соответствии со `SCC_OPT_EVENTQUEUE` значением `nOption` , существует два возможных значения для `dwVal` , `SCC_OPT_EQ_ENABLE` а именно и `SCC_OPT_EQ_DISABLE` .

## <a name="scc_opt_hascancelmode"></a>SCC_OPT_HASCANCELMODE
 Если значение для параметра `nOption` равно `SCC_OPT_HASCANCELMODE` , интегрированная среда разработки позволяет пользователям отменять длительные операции. Значение `dwVal` `SCC_OPT_HCM_NO` (по умолчанию) указывает, что в интегрированной среде разработки нет режима отмены. Подключаемый модуль системы управления версиями должен предоставлять собственную кнопку отмены, если требуется, чтобы пользователь мог отменить операцию. `SCC_OPT_HCM_YES` Указывает, что интегрированная среда разработки предоставляет возможность отмены операции, поэтому подключаемому модулю SCC не требуется отображать собственную кнопку отмены. Если интегрированная среда `dwVal` разработки `SCC_OPT_HCM_YES` имеет значение, то она готова реагировать `SCC_MSG_STATUS` на `DOCANCEL` сообщения, отправляемые `lpTextOutProc` функции обратного вызова (см. [лптекстаутпрок](../extensibility/lptextoutproc.md)). Если в интегрированной среде разработки не задана эта переменная, подключаемый модуль не должен отсылать эти два сообщения.

## <a name="scc_opt_namechangepfn"></a>SCC_OPT_NAMECHANGEPFN
 Если для Ноптион задано значение `SCC_OPT_NAMECHANGEPFN` , а также подключаемый модуль системы управления версиями и интегрированная среда разработки, то подключаемый модуль может переименование или перемещение файла во время операции системы управления версиями. `dwVal`Для будет задан указатель на функцию типа [оптнамечанжепфн](../extensibility/optnamechangepfn.md). Во время операции системы управления версиями подключаемый модуль может вызывать эту функцию, передавая три параметра. Это старое имя файла (с полным путем), новое имя (с полным путем) для этого файла и указатель на сведения, имеющие релевантность для интегрированной среды разработки. Интегрированная среда разработки отправляет этот последний указатель, вызывая с параметром с параметром `SccSetOption` `nOption` `SCC_OPT_USERDATA` , `dwVal` указав данные. Поддержка этой функции является необязательной. Подключаемый модуль ВССЦИ, использующий эту возможность, должен инициализировать его указатель на функцию и пользовательские переменные данных в `NULL` и не должен вызывать функцию переименования, если ей не было предоставлено значение. Также следует подготовиться к удержанию значения, которое было предоставлено, или изменить его в ответ на новый вызов `SccSetOption` . Это не произойдет в середине операции команды системы управления версиями, но может произойти между командами.

## <a name="scc_opt_scccheckoutonly"></a>SCC_OPT_SCCCHECKOUTONLY
 Если для Ноптион задано значение `SCC_OPT_SCCCHECKOUTONLY` , интегрированная среда разработки указывает, что файлы в текущем открытом проекте никогда не должны извлекаться вручную с помощью пользовательского интерфейса системы управления версиями. Вместо этого файлы должны быть извлечены только через подключаемый модуль системы управления версиями в разделе элемент управления IDE. Если параметр `dwValue` имеет значение `SCC_OPT_SCO_NO` , то файлы должны обрабатываться подключаемым модулем обычным образом и могут быть извлечены с помощью пользовательского интерфейса системы управления версиями. Если параметр `dwValue` имеет значение `SCC_OPT_SCO_YES` , то только подключаемый модуль может извлекать файлы, и пользовательский интерфейс системы управления версиями не должен вызываться. Это относится к ситуациям, когда в интегрированной среде разработки могут быть «псевдо-файлы», имеющие смысл извлечь только через интегрированную среду разработки.

## <a name="scc_opt_sharesubproj"></a>SCC_OPT_SHARESUBPROJ
 Если параметр `nOption` имеет значение `SCC_OPT_SHARESUBPROJ` , интегрированная среда разработки проверяет, может ли подключаемый модуль системы управления версиями использовать указанную локальную папку при добавлении файлов из системы управления версиями. Значение `dwVal` параметра не имеет значения в этом случае. Если подключаемый модуль позволяет интегрированной среде разработки указать локальную папку назначения, в которую файлы будут добавляться из системы управления версиями при вызове [сккаддфромскк](../extensibility/sccaddfromscc-function.md) , то подключаемый модуль должен возвращать значение `SCC_I_SHARESUBPROJOK` при `SccSetOption` вызове функции. Затем интегрированная среда разработки использует `lplpFileNames` параметр `SccAddFromScc` функции для передачи в конечную папку. Подключаемый модуль использует эту конечную папку для размещения файлов, добавленных из системы управления версиями. Если подключаемый модуль не возвращает `SCC_I_SHARESUBPROJOK` `SCC_OPT_SHARESUBPROJ` значение, если задан параметр, то в интегрированной среде разработки предполагается, что подключаемый модуль может добавлять файлы только в текущую локальную папку.

## <a name="see-also"></a>См. также раздел
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccInitialize](../extensibility/sccinitialize-function.md)
- [SccOpenProject](../extensibility/sccopenproject-function.md)
- [SccAddFilesFromSCC](../extensibility/sccaddfromscc-function.md)
- [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)
- [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md)
