---
title: Функция Скксетоптион | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccSetOption
helpviewer_keywords:
- SccSetOption function
ms.assetid: 4b5e6666-c24c-438a-a9df-9c52f58f8175
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: f48cb84a64c036b373308dfe29bfaf5d2e028b91
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/22/2019
ms.locfileid: "72720560"
---
# <a name="sccsetoption-function"></a>Функция SccSetOption
Эта функция задает параметры, управляющие поведением подключаемого модуля системы управления версиями.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccSetOption(
   LPVOID pvContext,
   LONG   nOption,
   LONG   dwVal
);
```

#### <a name="parameters"></a>Параметры
 пвконтекст

окне Структура контекста подключаемого модуля системы управления версиями.

 ноптион

окне Заданный параметр.

 дввал

окне Параметры для параметра.

## <a name="return-value"></a>Возвращаемое значение
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:

|значения|Описание|
|-----------|-----------------|
|SCC_OK|Параметр успешно установлен.|
|SCC_I_SHARESUBPROJOK|Возвращается, если `nOption` был `SCC_OPT_SHARESUBPROJ` и подключаемый модуль системы управления версиями позволяет интегрированной среде разработки задать целевую папку.|
|SCC_E_OPNOTSUPPORTED|Параметр не был задан, и на него не следует полагаться.|

## <a name="remarks"></a>Заметки
 Интегрированная среда разработки вызывает эту функцию для управления поведением подключаемого модуля системы управления версиями. Первый параметр, `nOption`, указывает значение, которое задается, а вторая `dwVal` указывает, что делать с этим значением. Подключаемый модуль хранит эти сведения, связанные с `pvContext``,`, поэтому интегрированная среда разработки должна вызвать эту функцию после вызова [скЦинитиализе](../extensibility/sccinitialize-function.md) (но не обязательно после каждого вызова [сккопенпрожект](../extensibility/sccopenproject-function.md)).

 Сводка параметров и их значений:

|`nOption`|`dwValue`|Описание|
|---------------|---------------|-----------------|
|`SCC_OPT_EVENTQUEUE`|`SCC_OPT_EQ_DISABLE`<br /><br /> `SCC_OPT_EQ_ENABLE`|Включает или отключает фоновую очередь событий.|
|`SCC_OPT_USERDATA`|Произвольное значение|Указывает значение пользователя, передаваемое функции обратного вызова [оптнамечанжепфн](../extensibility/optnamechangepfn.md) .|
|`SCC_OPT_HASCANCELMODE`|`SCC_OPT_HCM_NO`<br /><br /> `SCC_OPT_HCM_YES`|Указывает, поддерживает ли IDE в настоящее время отмену операции.|
|`SCC_OPT_NAMECHANGEPFN`|Указатель на функцию обратного вызова [оптнамечанжепфн](../extensibility/optnamechangepfn.md)|Задает указатель на функцию обратного вызова изменения имени.|
|`SCC_OPT_SCCCHECKOUTONLY`|`SCC_OPT_SCO_NO`<br /><br /> `SCC_OPT_SCO_YES`|Указывает, допускает ли интегрированная среда разработки извлечение файлов вручную (через пользовательский интерфейс системы управления версиями) или они должны извлекаться только через подключаемый модуль системы управления версиями.|
|`SCC_OPT_SHARESUBPROJ`|Н/Д|Если подключаемый модуль системы управления версиями позволяет интегрированной среде разработки указать папку локального проекта, подключаемый модуль возвращает `SCC_I_SHARESUBPROJOK`.|

## <a name="scc_opt_eventqueue"></a>SCC_OPT_EVENTQUEUE
 Если `nOption` `SCC_OPT_EVENTQUEUE`, интегрированная среда разработки отключается (или повторно включает) фоновую обработку. Например, во время компиляции в интегрированной среде разработки может быть указано, что подключаемый модуль системы управления версиями должен останавливаться на неактивной обработке любого типа. После компиляции будет повторно включен режим фоновой обработки для обновления очереди событий подключаемого модуля. В соответствии с `SCC_OPT_EVENTQUEUE` значением `nOption` есть два возможных значения для `dwVal`, а именно `SCC_OPT_EQ_ENABLE` и `SCC_OPT_EQ_DISABLE`.

## <a name="scc_opt_hascancelmode"></a>SCC_OPT_HASCANCELMODE
 Если значение для `nOption` равно `SCC_OPT_HASCANCELMODE`, интегрированная среда разработки позволяет пользователям отменять длительные операции. Установка значения `dwVal` `SCC_OPT_HCM_NO` (по умолчанию) означает, что в интегрированной среде разработки отсутствует режим отмены. Подключаемый модуль системы управления версиями должен предоставлять собственную кнопку отмены, если требуется, чтобы пользователь мог отменить операцию. `SCC_OPT_HCM_YES` указывает, что интегрированная среда разработки предоставляет возможность отмены операции, поэтому подключаемому модулю SCC не требуется отображать собственную кнопку отмены. Если в интегрированной среде разработки задается `dwVal` `SCC_OPT_HCM_YES`, она подготавливается для реагирования на сообщения `SCC_MSG_STATUS` и `DOCANCEL`, отправляемые функции обратного вызова `lpTextOutProc` (см. [лптекстаутпрок](../extensibility/lptextoutproc.md)). Если в интегрированной среде разработки не задана эта переменная, подключаемый модуль не должен отсылать эти два сообщения.

## <a name="scc_opt_namechangepfn"></a>SCC_OPT_NAMECHANGEPFN
 Если Ноптион имеет значение `SCC_OPT_NAMECHANGEPFN`, а также подключаемый модуль системы управления версиями и интегрированная среда разработки, то подключаемый модуль может переименование или перемещение файла во время операции системы управления версиями. Для `dwVal` будет задан указатель на функцию типа [оптнамечанжепфн](../extensibility/optnamechangepfn.md). Во время операции системы управления версиями подключаемый модуль может вызывать эту функцию, передавая три параметра. Это старое имя файла (с полным путем), новое имя (с полным путем) для этого файла и указатель на сведения, имеющие релевантность для интегрированной среды разработки. Интегрированная среда разработки отправляет этот последний указатель, вызывая `SccSetOption` с `nOption` установленным в `SCC_OPT_USERDATA`, с `dwVal` указывающим на данные. Поддержка этой функции является необязательной. Подключаемый модуль ВССЦИ, использующий эту возможность, должен инициализировать его указатель на функцию и пользовательские переменные данных для `NULL` и не должен вызывать функцию переименования, если ей не была предоставлена одна. Также необходимо подготовиться к удержанию значения, которое было предоставлено, или изменить его в ответ на новый вызов `SccSetOption`. Это не произойдет в середине операции команды системы управления версиями, но может произойти между командами.

## <a name="scc_opt_scccheckoutonly"></a>SCC_OPT_SCCCHECKOUTONLY
 Если Ноптион имеет значение `SCC_OPT_SCCCHECKOUTONLY`, интегрированная среда разработки указывает, что файлы в текущем открытом проекте никогда не должны извлекаться вручную с помощью пользовательского интерфейса системы управления версиями. Вместо этого файлы должны быть извлечены только через подключаемый модуль системы управления версиями в разделе элемент управления IDE. Если `dwValue` имеет значение `SCC_OPT_SCO_NO`, это означает, что файлы должны считаться подключаемым модулем обычным образом и могут быть извлечены с помощью пользовательского интерфейса системы управления версиями. Если `dwValue` имеет значение `SCC_OPT_SCO_YES`, то только подключаемому модулю разрешается извлечение файлов, и пользовательский интерфейс системы управления версиями не должен вызываться. Это относится к ситуациям, когда в интегрированной среде разработки могут быть «псевдо-файлы», имеющие смысл извлечь только через интегрированную среду разработки.

## <a name="scc_opt_sharesubproj"></a>SCC_OPT_SHARESUBPROJ
 Если `nOption` имеет значение `SCC_OPT_SHARESUBPROJ`, интегрированная среда разработки проверяет, может ли подключаемый модуль системы управления версиями использовать указанную локальную папку при добавлении файлов из системы управления версиями. Значение параметра `dwVal` не имеет значения в этом случае. Если подключаемый модуль позволяет интегрированной среде разработки указать локальную папку назначения, в которую файлы будут добавляться из системы управления версиями при вызове [сккаддфромскк](../extensibility/sccaddfromscc-function.md) , то подключаемый модуль должен возвращать `SCC_I_SHARESUBPROJOK` при вызове функции `SccSetOption`. Затем интегрированная среда разработки использует параметр `lplpFileNames` функции `SccAddFromScc` для передачи в конечную папку. Подключаемый модуль использует эту конечную папку для размещения файлов, добавленных из системы управления версиями. Если подключаемый модуль не возвращает `SCC_I_SHARESUBPROJOK` при установке параметра `SCC_OPT_SHARESUBPROJ`, интегрированная среда разработки предполагает, что подключаемый модуль может добавлять файлы только в текущую локальную папку.

## <a name="see-also"></a>См. также
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [SccInitialize](../extensibility/sccinitialize-function.md)
- [SccOpenProject](../extensibility/sccopenproject-function.md)
- [SccAddFilesFromSCC](../extensibility/sccaddfromscc-function.md)
- [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)
- [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md)