---
title: Развертывание настраиваемых начальных страниц | Документация Майкрософт
description: Узнайте, как развертывать настраиваемые начальные страницы с помощью развертывания VSIX или путем копирования файлов в нужные расположения на целевом компьютере.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- package start page
- deploy start page
ms.assetid: 4a7eb360-de83-41d5-be53-3cfb160d19f9
author: acangialosi
ms.author: anthc
manager: jmartens
ms.workload:
- vssdk
monikerRange: vs-2017
ms.openlocfilehash: 3deac1637bb6b4ed054a8a9afc7ab78bf26d0183
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99968415"
---
# <a name="deploy-custom-start-pages"></a>Развертывание настраиваемых начальных страниц

Вы можете развернуть настраиваемые начальные страницы с помощью развертывания VSIX или скопировать файлы в нужные расположения на целевом компьютере.

## <a name="vsix-deployment-by-using-the-start-page-project-template"></a>Развертывание VSIX с помощью шаблона проекта начальной страницы

При создании начальной страницы с помощью шаблона проекта начальной страницы и последующей сборке проекта Visual Studio создает *VSIX* -файл, который можно распространить. Упаковка начальной страницы в *VSIX* -файл предоставляет следующие возможности для развертывания в зависимости от предполагаемой аудитории:

- Файл *VSIX* можно разместить в общей сетевой папке или на общедоступном веб-сайте. Когда пользователь открывает файл, начальная страница устанавливается автоматически.

- Вы можете передать *VSIX* -файл на сайт [Visual Studio Marketplace](https://marketplace.visualstudio.com/) , чтобы пользователи могли установить его с помощью **диспетчера расширений**.

Шаблон проекта начальной страницы создает копию начальной страницы Visual Studio по умолчанию, чтобы можно было изменить копию и сохранить оригинал.

Шаблон проекта начальной страницы можно получить с помощью **диспетчера расширений** или путем его загрузки с веб-сайта.

## <a name="vsix-deployment-without-using-the-start-page-project-template"></a>Развертывание VSIX без использования шаблона проекта начальной страницы
 Для успешного развертывания VSIX требуется установить расширение в папки, распознаваемые процессом регистрации VSIX и **диспетчером расширений**. Поскольку в шаблоне проекта начальной страницы уже указаны правильные папки, рекомендуется использовать его всякий раз, когда требуется упаковать расширение для развертывания VSIX. Однако при наличии варианта, в котором нельзя использовать шаблон, можно создать развертывание VSIX без его использования.

 Чтобы создать развертывание VSIX без использования шаблона проекта начальной страницы, сначала создайте *VSIX* -файл для начальной страницы одним из следующих двух способов:

- Путем добавления пользовательских файлов начальной страницы в пустой проект VSIX. Дополнительные сведения см. в разделе [Шаблон проекта VSIX](../extensibility/vsix-project-template.md).

- Путем создания *VSIX* -файла вручную. Чтобы создать *VSIX* -файл вручную, выполните следующие действия.

   1. Создайте файл *Extension. vsixmanifest* и файл *[Content_Types]. XML* в новой папке. Дополнительные сведения см. в разделе [Анатомия пакета VSIX](../extensibility/anatomy-of-a-vsix-package.md).

   2. В проводнике Windows щелкните правой кнопкой мыши папку, содержащую два XML-файла, выберите пункт **Отправить**, а затем пункт Сжатая ZIP-папка. Переименуйте полученный *ZIP* -файл в *filename. VSIX*, где filename — это имя распространяемого файла, который устанавливает пакет.

Чтобы в Visual Studio можно было распознать начальную страницу, в `Content Element` манифесте VSIX должен содержаться `CustomExtension Element` `Type` атрибут, для атрибута которого задано значение `"StartPage"` . Расширение начальной страницы, установленное с помощью развертывания VSIX, отображается в списке **Настройка начальной страницы** на странице Параметры **запуска** как *имя расширения* **[установлено расширение]** .

Если пакет начальной страницы содержит сборки, необходимо добавить регистрацию пути привязки, чтобы они были доступны при запуске Visual Studio. Для этого убедитесь, что пакет содержит файл *pkgdef* , содержащий следующие сведения.

```
[$RootKey$\BindingPaths\{Insert a new GUID here}]
"$PackageFolder$"=""
```

### <a name="vsix-deployment-for-all-users"></a>Развертывание VSIX для всех пользователей
 По умолчанию расширения, развернутые в пакетах VSIX, устанавливаются только для текущего пользователя. Вы можете установить начальную страницу для всех пользователей целевого компьютера, создав All-Usersное развертывание.

### <a name="to-create-an-all-users-deployment"></a>Создание развертывания All-Users

1. Откройте файл *Extension. vsixmanifest* в представлении кода.

2. В `Identifier` элементе манифеста VSIX добавьте `AllUsers` элемент со значением `true` .

    ```
    <AllUsers>true</AllUsers>
    ```

     В результате установщик VSIX запрашивает разрешения администратора, а затем устанавливает файлы в *\Common7\IDE\Extensions*.

3. Откройте файл *pkgdef* .

4. Измените файл *pkgdef* , чтобы задать начальную страницу по умолчанию в HKLM, добавив следующий код, где *мистартпаже. XAML* — это имя *XAML* -файла, содержащего начальную страницу.

     [$RootKey $ \Стартпаже\дефаулт]

     "URI" = "$PackageFolder $ \\ *мистартпаже. XAML*"

     Это означает, что Visual Studio будет искать новое расположение начальной страницы.

## <a name="file-copy-deployment"></a>Развертывание копирования файлов
 Для развертывания настраиваемой начальной страницы не нужно создавать *VSIX* -файл. Вместо этого можно скопировать разметку и вспомогательные файлы непосредственно в <em>папку \стартпажес пользователя \* . В списке **настроить начальную страницу</em>* на странице Параметры **запуска** перечислены все *XAML* -файлы в этой папке, а также путь, например *%UserProfile%\My Documents\Visual Studio {версия} \стартпажес \\ {имя файла}. XAML*. Если начальная страница содержит ссылки на закрытые сборки, их необходимо скопировать и вставить в папку * \Приватеассемблиес \* .

 Чтобы распространить начальную страницу, созданную без упаковки в *VSIX* -файл, рекомендуется использовать базовую стратегию копирования файлов, например пакетный сценарий или любую другую технологию развертывания, позволяющую разместить файлы в нужных каталогах.

### <a name="to-manually-install-a-custom-start-page"></a>Установка настраиваемой начальной страницы вручную

1. Скопируйте *XAML* -файл, содержащий разметку начальной страницы, вместе с любыми вспомогательными файлами, отличными от сборок, и вставьте их в папку пользователя * \стартпажес \* .

2. Если начальная страница требует наличия сборок, скопируйте их и вставьте в *... \\ {Папка установки Visual Studio} \Common7\IDE\PrivateAssemblies \\*.

3. В списке **настроить начальную страницу** на странице Параметры **запуска** выберите новую начальную страницу. Дополнительные сведения см. [в разделе Настройка начальной страницы](../ide/customizing-the-start-page-for-visual-studio.md).

## <a name="see-also"></a>См. также раздел

- [Настройка начальной страницы](../ide/customizing-the-start-page-for-visual-studio.md)
- [Добавление пользовательского элемента управления на начальную страницу](../extensibility/adding-user-control-to-the-start-page.md)
