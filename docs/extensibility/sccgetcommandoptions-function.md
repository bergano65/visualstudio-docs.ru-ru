---
title: Функция SccGetCommandOptions | Документация Майкрософт
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- SccGetCommandOptions
helpviewer_keywords:
- SccGetCommandOptions function
ms.assetid: bbe4aa4e-b4b0-403e-b7a0-5dd6eb24e5a9
author: acangialosi
ms.author: anthc
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 3b1f465e6709932cd89794c5c0558d608fadd2a8
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99965204"
---
# <a name="sccgetcommandoptions-function"></a>Функция SccGetCommandOptions
Эта функция запрашивает у пользователя дополнительные параметры для данной команды.

## <a name="syntax"></a>Синтаксис

```cpp
SCCRTN SccGetCommandOptions(
   LPVOID pvContext,
   HWND hWnd,
   enum SCCCOMMAND iCommand,
   LPCMDOPTS* ppvOptions
);
```

### <a name="parameters"></a>Параметры
 пвконтекст

окне Структура контекста подключаемого модуля системы управления версиями.

 hWnd

окне Обработчик окна интегрированной среды разработки, который может использоваться подключаемым модулем системы управления версиями в качестве родительского для любых предоставляемых им диалоговых окон.

 iCommand

окне Команда, для которой запрашиваются дополнительные параметры (см. раздел [код команды](../extensibility/command-code-enumerator.md) для возможных значений).

 ппвоптионс

окне Структура параметра (также может быть `NULL` ).

## <a name="return-value"></a>Возвращаемое значение
 Реализация подключаемого модуля системы управления версиями для этой функции должна возвращать одно из следующих значений:

|Значение|Описание|
|-----------|-----------------|
|SCC_OK|Успешно.|
|SCC_I_ADV_SUPPORT|Подключаемый модуль системы управления версиями поддерживает дополнительные параметры для команды.|
|SCC_I_OPERATIONCANCELED|Пользователь отменил диалоговое окно " **Параметры** " для подключаемого модуля системы управления версиями.|
|SCC_E_OPTNOTSUPPORTED|Подключаемый модуль системы управления версиями не поддерживает эту операцию.|
|SCC_E_ISCHECKEDOUT|Невозможно выполнить эту операцию над файлом, который в настоящее время извлечен.|
|SCC_E_ACCESSFAILURE|Возникла проблема при доступе к системе управления версиями, возможно, из-за проблем с сетью или состязаниями. Рекомендуется повторить попытку.|
|SCC_E_NONSPECIFICERROR|Неконкретный сбой.|

## <a name="remarks"></a>Remarks
 Интегрированная среда разработки вызывает эту функцию в первый раз с `ppvOptions` = `NULL` , чтобы определить, поддерживает ли подключаемый модуль системы управления версиями функцию дополнительных параметров для указанной команды. Если подключаемый модуль поддерживает функцию для этой команды, интегрированная среда разработки вызывает эту функцию снова, когда пользователь запрашивает дополнительные параметры (обычно реализуется в виде **расширенной** кнопки в диалоговом окне) и предоставляет указатель, отличный от NULL, для объекта `ppvOptions` , указывающего на `NULL` указатель. Подключаемый модуль хранит все дополнительные параметры, указанные пользователем в закрытой структуре, и возвращает указатель на эту структуру в `ppvOptions` . Эта структура затем передается всем другим функциям API подключаемого модуля системы управления версиями, которые должны знать о ней, включая последующие вызовы `SccGetCommandOptions` функции.

 Пример может помочь прояснить эту ситуацию.

 Пользователь выбирает команду **Get** , и интегрированная среда разработки отображает диалоговое окно **получить** . Интегрированная среда разработки вызывает `SccGetCommandOptions` функцию со `iCommand` значением `SCC_COMMAND_GET` и `ppvOptions` значением `NULL` . Это интерпретируется подключаемым модулем системы управления версиями в качестве вопроса «у вас есть дополнительные параметры для этой команды?». Если подключаемый модуль возвращает `SCC_I_ADV_SUPPORT` , в диалоговом окне **Get** в интегрированной среде разработки отображается кнопка **Дополнительно** .

 В первый раз, когда пользователь нажимает кнопку " **Дополнительно** ", интегрированная среда разработки снова вызывает `SccGetCommandOptions` функцию, на этот раз с `NULL``ppvOptions` нессылкой на `NULL` указатель. Подключаемый модуль отображает собственное диалоговое окно " **Получение параметров** ", запрашивает у пользователя сведения, помещает эту информацию в собственную структуру и возвращает указатель на эту структуру в `ppvOptions` .

 Если пользователь нажмет кнопку " **Дополнительно** " в том же диалоговом окне, интегрированная среда разработки снова вызывает эту `SccGetCommandOptions` функцию без изменения `ppvOptions` , чтобы структура была передана обратно подключаемому модулю. Это позволяет подключаемому модулю повторно инициализировать свое диалоговое окно до значений, заданных пользователем ранее. Подключаемый модуль изменяет структуру на месте перед возвратом.

 Наконец, когда пользователь нажимает кнопку **ОК** в диалоговом окне **Get** интегрированной среды разработки, среда IDE вызывает [сккжет](../extensibility/sccget-function.md), передавая структуру, возвращенную в `ppvOptions` , содержащую дополнительные параметры.

> [!NOTE]
> Команда `SCC_COMMAND_OPTIONS` используется, когда в интегрированной среде разработки отображается диалоговое окно **Параметры** , позволяющее настроить пользовательские параметры, управляющие работой интеграции. Если подключаемый модуль системы управления версиями хочет предоставить собственное диалоговое окно настроек, оно может отобразить его на **дополнительной** кнопке в диалоговом окне "настройки" интегрированной среды разработки. Подключаемый модуль несет ответственность за получение и сохранение этих сведений; Интегрированная среда разработки не использует ее или не изменяет.

## <a name="see-also"></a>См. также раздел
- [Функции API подключаемого модуля системы управления версиями](../extensibility/source-control-plug-in-api-functions.md)
- [Код команды](../extensibility/command-code-enumerator.md)
