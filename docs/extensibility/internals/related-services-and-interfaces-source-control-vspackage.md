---
title: Связанные службы и интерфейсы (пакет VSPackage системы управления версиями)
titleSuffix: ''
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- source control packages, interfaces
- interfaces, source control packages
ms.assetid: 3e96e838-5675-46bb-99cf-40d420086038
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: af08c8e0ea15751f5d8e6c0a1a01549fdb9227c3
ms.sourcegitcommit: 4ae5e9817ad13edd05425febb322b5be6d3c3425
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/11/2020
ms.locfileid: "90034798"
---
# <a name="related-services-and-interfaces-source-control-vspackage"></a>Связанные службы и интерфейсы (пакет VSPackage системы управления версиями)

В этом разделе перечислены все интерфейсы пакета VSPackage, связанные с управлением версиями, в [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] . Пакет VSPackage для системы управления версиями реализует некоторые из этих интерфейсов и использует других для выполнения задач системы управления версиями.

## <a name="interfaces-implemented-by-and-for-source-control-vspackages"></a>Интерфейсы, реализованные в и для пакетов VSPackage системы управления версиями

 Следующие интерфейсы описаны в [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] , а пакет VSPackage системы управления версиями реализует их подмножество в зависимости от требуемого набора функций. Некоторые интерфейсы помечаются как обязательные и должны быть реализованы каждым пакетом VSPackage системы управления версиями.

 Для тех интерфейсов, которые пакет не реализует, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] предоставляет реализацию по умолчанию. Обратите внимание, что реализация по умолчанию разработана для случая, когда не зарегистрирован пакет VSPackage и проект не контролируется. Правильно написанный пакет VSPackage для системы управления версиями реализует все необходимые интерфейсы вместо того, чтобы сохранять его в реализации по умолчанию этих интерфейсов.

 Пакет VSPackage системы управления версиями должен реализовывать закрытую службу, которая инкапсулирует некоторые или все из следующих интерфейсов.

 Используются следующие интерфейсы:

- Обязательный. соответствующая сущность (пакет VSPackage системы управления версиями, заглушка системы управления версиями, проект) должна реализовывать интерфейс.

- Рекомендуется: сущность должна реализовывать этот интерфейс; в противном случае функциональность системы управления версиями может быть ограничена.

- Необязательно. сущность может реализовать этот интерфейс, чтобы предоставить более широкий набор функций.

| Интерфейс | Назначение | Реализовано | Применить? |
| - | - |--------------------------|-------------|
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2> | Редакторы вызывают этот интерфейс перед изменением или сохранением файла. Пакет VSPackage системы управления версиями может извлечь файл или отклонить операцию в случае сбоя при извлечении. | Пакет VSPackage системы управления версиями | Рекомендованное |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccManager2> | Этот интерфейс обеспечивает базовую функциональность управления версиями для проектов, таких как регистрация и Отмена регистрации проектов в системе управления версиями и предоставление поддержки основных глифов системы управления версиями. | Пакет VSPackage системы управления версиями | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccProject2> | Этот интерфейс получается из с <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> помощью <xref:System.Runtime.InteropServices.Marshal.QueryInterface%2A> функции или путем простого приведения объекта, реализующего `IVsHierarchy` `IVsSccProject2` . Он используется для получения файлов в системе управления версиями в проекте или для формирования проекта текущего состояния или расположения системы управления версиями. | Project | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccProvider> | Модуль интеграции использует этот интерфейс для задания текущего активного пакета VSPackage. | Пакет VSPackage системы управления версиями | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsTrackProjectDocuments2> | Этот интерфейс основан на модели подписки. Любой пакет VSPackage может дать сигнал о том, что он хочет получать события документа и быть в состоянии быть рекомендованным оболочкой для событий, которые будут выполняться. Он реализуется и обрабатывается методом [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] , который, в свою очередь, передает события, реализующие интерфейс `IVsTrackProjectDocumentsEvents2` VSPackage. | Заглушка системы управления версиями | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsTrackProjectDocuments3> | Этот интерфейс обеспечивает пакетную обработку, синхронизированные операции чтения и записи, а также расширенный `OnQueryAddFiles` метод. | Заглушка системы управления версиями | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsTrackProjectDocumentsEvents2> | **Обозреватель решений** и проекты вызывают этот интерфейс при добавлении новых файлов в проекты или при переименовании или удалении файлов и папок из проектов. Пакет VSPackage системы управления версиями может извлечь файл проекта или отменить операцию. | Пакет VSPackage системы управления версиями | Рекомендованное |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsTrackProjectDocumentsEvents3> | **Обозреватель решений** и проекты вызывают этот интерфейс в ответ на вызовы методов интерфейса IVstrackProjectDocuments3. Пакет VSPackage системы управления версиями может выполнять Пакетированные операции, синхронизированные операции чтения и записи и работать с более сложным `OnQueryAddFiles` методом. | Пакет VSPackage системы управления версиями | Рекомендованное |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccEnlistmentPathTranslation> | Этот интерфейс обеспечивает поддержку управления прикреплениями для веб-проектов. | Пакет VSPackage системы управления версиями | Рекомендованное |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccManagerTooltip> | Этот интерфейс используется для получения подсказок для файлов, находящихся в системе управления версиями в проектах. | Пакет VSPackage системы управления версиями | Необязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccOpenFromSourceControl> | Этот интерфейс обеспечивает поддержку расширения пространства имен. | Пакет VSPackage системы управления версиями | Необязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccControlNewSolution> | Пакет VSPackage использует этот интерфейс для интеграции расширения пространства имен в диалоговые окна **Создание**, **Открытие**или **Сохранение** . Следовательно, проекты могут автоматически добавляться в систему управления версиями при создании или добавляться в систему управления версиями, когда действует операция сохранения. | Пакет VSPackage системы управления версиями | Необязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccGlyphs> | Пакет VSPackage использует этот интерфейс для определения дополнительных глифов в качестве глифов системы управления версиями для узлов в **Обозреватель решений**. | Пакет VSPackage системы управления версиями | Необязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccAddWebProjectFromSourceControl> | Этот интерфейс используется для диалогового окна **Добавление** веб-проектов. Он предоставляет методы для обзора расположения системы управления версиями и для открытия веб-проекта, ранее добавленного в репозиторий системы управления версиями в этом расположении. | Пакет VSPackage системы управления версиями | Рекомендованное |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsAsynchOpenFromScc> | Этот интерфейс обеспечивает поддержку асинхронной (фоновой) загрузки проектов из системы управления версиями. | Пакет VSPackage системы управления версиями | Необязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsAsynchOpenFromSccProjectEvents> | Этот интерфейс позволяет проектам отслеживать ход выполнения асинхронной загрузки, инициированной <xref:Microsoft.VisualStudio.Shell.Interop.IVsAsynchOpenFromScc> . | Project | Необязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSccToolsOptions> | Этот интерфейс позволяет интегрированной среде разработки запрашивать пакет VSPackage активного управления версиями. Интегрированная среда разработки запрашивает значения параметров системы управления версиями, которые имеют значение, даже если отсутствует зарегистрированный пакет VSPackage активного управления версиями. Этот интерфейс реализуется и обрабатывается [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] . | Заглушка системы управления версиями | Обязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsRegisterScciProvider> | Этот интерфейс используется при регистрации пакета VSPackage системы управления версиями. | Заглушка системы управления версиями | Обязательно |
| <xref:EnvDTE.SourceControl> | Этот интерфейс используется в службе автоматизации. Таким образом, он предоставляет только те функции, которые могут быть выполнены без отображения пользовательского интерфейса. | Пакет VSPackage системы управления версиями | Необязательно |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistSolutionProps> | Этот интерфейс используется для сохранения параметров системы управления версиями в файле решения (SLN). К параметрам относятся расположение системы управления версиями и флаги состояния системы управления версиями. | Пакет VSPackage системы управления версиями | Рекомендованное |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistSolutionOpts> | Этот интерфейс используется для сохранения параметров системы управления версиями в файле параметров решения (. suo). Это могут быть пользовательские параметры системы управления версиями, такие как расположение прикрепления текущего пользователя. | Пакет VSPackage системы управления версиями | Рекомендованное |
| <xref:Microsoft.VisualStudio.Shell.Interop.IVsSolutionEvents3> | Этот интерфейс используется для мониторинга событий, чтобы выполнять такие операции, как возврат файлов проекта перед закрытием решений, или получение новых файлов из системы управления версиями при открытии проекта. | Пакет VSPackage системы управления версиями | Рекомендованное |

## <a name="see-also"></a>См. также раздел
- [Элементы проектирования](../../extensibility/internals/source-control-vspackage-design-elements.md)
