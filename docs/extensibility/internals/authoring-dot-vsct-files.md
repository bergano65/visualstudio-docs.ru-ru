---
title: Работы. Файлы vsct | Документация Майкрософт
description: Узнайте, как создавать vsct-файлы, добавляющие элементы меню, панели инструментов и другие элементы пользовательского интерфейса в интегрированную среду разработки Visual Studio (IDE).
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- VSCT files, manual authoring
ms.assetid: e9f715dc-12b7-439b-bdf3-f3dc75e62f1c
author: acangialosi
ms.author: anthc
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 3c484c08b3335d51283f1f6e1a7b29757a2271aa
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99906069"
---
# <a name="author-vsct-files"></a>Файлы Author. vsct
В этом документе показано, как создать файл *vsct* для добавления пунктов меню, панелей инструментов и других элементов пользовательского интерфейса в интегрированную среду разработки (IDE) Visual Studio. Используйте эти шаги при добавлении элементов пользовательского интерфейса в пакет Visual Studio (VSPackage), в котором еще нет *vsct* -файла.

 Для новых проектов рекомендуется использовать шаблон пакета Visual Studio, так как он создает *vsct* -файл, который в зависимости от выбранных параметров уже содержит необходимые элементы для команды меню, окна инструментов или пользовательского редактора. Этот *vsct* файл можно изменить в соответствии с требованиями пакета VSPackage. Дополнительные сведения об изменении *vsct* -файла см. в примерах в разделе [Расширение меню и команд](../../extensibility/extending-menus-and-commands.md).

## <a name="author-the-file"></a>Создание файла
 Создайте *vsct* -файл на следующих этапах: создание структуры для файлов и ресурсов, объявление элементов пользовательского интерфейса, размещение элементов пользовательского интерфейса в интегрированной среде разработки и добавление любых специализированных поведений.

### <a name="file-structure"></a>Структура файла
 Базовая структура *vsct* -файла — это корневой элемент [коммандтабле](../../extensibility/commandtable-element.md) , который содержит элемент [Commands](../../extensibility/commands-element.md) и элемент [SYMBOLS](../../extensibility/symbols-element.md) .

#### <a name="to-create-the-file-structure"></a>Создание файловой структуры

1. Добавьте *vsct* -файл в проект, выполнив действия, описанные в разделе [как создать vsct-файл](../../extensibility/internals/how-to-create-a-dot-vsct-file.md).

2. Добавьте необходимые пространства имен в `CommandTable` элемент, как показано в следующем примере:

    ```xml
    <CommandTable xmlns="http://schemas.microsoft.com/VisualStudio/2005-10-18/CommandTable"
        xmlns:xs="http://www.w3.org/2001/XMLSchema">

    ```

3. В `CommandTable` элементе добавьте `Commands` элемент для размещения всех пользовательских меню, панелей инструментов, групп команд и команд. Чтобы элементы пользовательского интерфейса могли загружаться, `Commands` элементу должен быть `Package` присвоен атрибут имени пакета.

     После `Commands` элемента добавьте `Symbols` элемент, чтобы определить идентификаторы GUID для пакета, а также имена и идентификаторы команд для элементов пользовательского интерфейса.

### <a name="include-visual-studio-resources"></a>Включить ресурсы Visual Studio
 Используйте элемент [extern](../../extensibility/extern-element.md) для доступа к файлам, которые определяют команды Visual Studio, и меню, необходимых для размещения элементов пользовательского интерфейса в интегрированной среде разработки. Если вы будете использовать команды, определенные за пределами пакета, используйте элемент [уседкоммандс](../../extensibility/usedcommands-element.md) для информирования Visual Studio.

#### <a name="to-include-visual-studio-resources"></a>Включение ресурсов Visual Studio

1. В верхней части `CommandTable` элемента добавьте по одному `Extern` элементу для каждого внешнего файла, на который будет ссылаться, и задайте `href` для атрибута имя файла. Чтобы получить доступ к ресурсам Visual Studio, вы можете ссылаться на следующие файлы заголовков:

   - *Стдидкмд. h*: определяет идентификаторы для всех команд, предоставляемых Visual Studio.

   - *Всшлидс. h*: содержит идентификаторы команд для меню Visual Studio.

2. Если пакет вызывает любые команды, определенные Visual Studio или другими пакетами, добавьте `UsedCommands` элемент после `Commands` элемента. Заполните этот элемент элементом [уседкомманд](../../extensibility/usedcommand-element.md) для каждой вызываемой команды, которая не является частью пакета. Присвойте `guid` `id` атрибутам и элементов идентификаторы `UsedCommand` GUID и ID команд для вызова.

   Дополнительные сведения о поиске идентификаторов GUID и идентификаторов команд Visual Studio см. в разделе [идентификаторы GUID и идентификаторы команд Visual Studio](../../extensibility/internals/guids-and-ids-of-visual-studio-commands.md). Для вызова команд из других пакетов используйте идентификатор GUID и идентификатор команды, как определено в файле *. vsct* для этих пакетов.

### <a name="declare-ui-elements"></a>Объявление элементов пользовательского интерфейса
 Объявите все новые элементы пользовательского интерфейса в `Symbols` разделе файла *vsct* .

#### <a name="to-declare-ui-elements"></a>Объявление элементов пользовательского интерфейса

1. В `Symbols` элементе добавьте три элемента [GuidSymbol](../../extensibility/guidsymbol-element.md) . Каждый `GuidSymbol` элемент имеет `name` атрибут и `value` атрибут. Задайте `name` атрибут таким образом, чтобы он отражал назначение элемента. `value`Атрибут принимает идентификатор GUID. (Чтобы создать GUID, в меню **Сервис** выберите команду **Создать GUID**, а затем выберите **Формат реестра**.)

     Первый `GuidSymbol` элемент представляет пакет и обычно не имеет дочерних элементов. Второй `GuidSymbol` элемент представляет набор команд и будет содержать все символы, определяющие меню, группы и команды. Третий `GuidSymbol` элемент представляет ваше хранилище образов и содержит символы для всех значков команд. Если у вас нет команд, использующих значки, можно опустить третий `GuidSymbol` элемент.

2. В `GuidSymbol` элементе, представляющем набор команд, добавьте один или несколько элементов [IDSymbol](../../extensibility/idsymbol-element.md) . Каждый из них представляет меню, панель инструментов, группу или команду, добавляемую в пользовательский интерфейс.

     Для каждого `IDSymbol` элемента задайте для `name` атрибута имя, которое будет использоваться для ссылки на соответствующее меню, группу или команду, а затем установите `value` для элемента шестнадцатеричное число, которое будет представлять идентификатор команды. Ни один `IDSymbol` из двух элементов, имеющих один и тот же родительский элемент, не может иметь одинаковое значение.

3. Если для любого из элементов пользовательского интерфейса требуются значки, добавьте `IDSymbol` элемент для каждого значка в `GuidSymbol` элемент, представляющий хранилище изображений.

### <a name="put-ui-elements-in-the-ide"></a>Размещение элементов пользовательского интерфейса в интегрированной среде разработки
 Элементы [меню](../../extensibility/menus-element.md), [группы](../../extensibility/groups-element.md)и [кнопки](../../extensibility/buttons-element.md) содержат определения всех меню, групп и команд, определенных в пакете. Размещение этих меню, групп и команд в интегрированной среде разработки либо с помощью [родительского](../../extensibility/parent-element.md) элемента, который является частью определения элемента пользовательского интерфейса, либо с помощью элемента [CommandPlacement](../../extensibility/commandplacement-element.md) , определенного в других местах.

 Каждый `Menu` `Group` элемент, и `Button` имеет `guid` атрибут и `id` атрибут. Всегда устанавливайте `guid` атрибут в соответствии с именем `GuidSymbol` элемента, представляющего набор команд, и присвойте `id` атрибуту имя `IDSymbol` элемента, представляющего меню, группу или команду в `Symbols` разделе.

#### <a name="to-define-ui-elements"></a>Определение элементов пользовательского интерфейса

1. При определении новых меню, подменю, контекстных меню или панелей инструментов добавьте `Menus` элемент в `Commands` элемент. Затем для каждого создаваемого меню добавьте элемент [меню](../../extensibility/menu-element.md) в `Menus` элемент.

    Задайте `guid` атрибуты и `id` `Menu` элемента, а затем задайте `type` для атрибута нужный тип меню. Вы также можете задать `priority` атрибут, чтобы установить относительное расположение меню в родительской группе.

   > [!NOTE]
   > `priority`Атрибут не применяется к панелям инструментов и контекстным меню.

2. Все команды в интегрированной среде разработки Visual Studio должны размещаться в группах команд, которые являются прямыми дочерними элементами меню и панелей инструментов. При добавлении новых меню или панелей инструментов в интегрированную среду разработки они должны содержать новые группы команд. Вы также можете добавлять группы команд в существующие меню и панели инструментов для визуального группирования команд.

    При добавлении новых групп команд необходимо сначала создать `Groups` элемент, а затем добавить в него элемент [группы](../../extensibility/group-element.md) для каждой группы команд.

    Задайте `guid` атрибуты и `id` `Group` для каждого элемента, а затем установите атрибут, `priority` чтобы установить относительное расположение группы в родительском меню. Дополнительные сведения см. в разделе [Создание многократно используемых групп кнопок](../../extensibility/creating-reusable-groups-of-buttons.md).

3. При добавлении новых команд в интегрированную среду разработки добавьте `Buttons` элемент в `Commands` элемент. Затем для каждой команды добавьте в элемент элемент [Button](../../extensibility/button-element.md) `Buttons` .

   1. Задайте `guid` атрибуты и `id` `Button` для каждого элемента, а затем присвойте `type` атрибуту нужный тип кнопки. Вы также можете задать `priority` атрибут, чтобы установить относительное расположение команды в родительской группе.

       > [!NOTE]
       > Используйте `type="button"` для стандартных команд меню и кнопок на панелях инструментов.

   2. В `Button` элементе добавьте элемент [Strings](../../extensibility/strings-element.md) , содержащий элемент [ButtonText](../../extensibility/buttontext-element.md) и элемент [CommandName](../../extensibility/commandname-element.md) . `ButtonText`Элемент предоставляет текстовую метку для элемента меню или подсказку для кнопки на панели инструментов. `CommandName`Элемент предоставляет имя команды для использования в команде.

   3. Если у команды есть значок, создайте в элементе элемент [Icon](../../extensibility/icon-element.md) `Button` и установите его `guid` `id` атрибуты и в `Bitmap` элемент для значка.

       > [!NOTE]
       > Кнопки панели инструментов должны иметь значки.

   Дополнительные сведения см. в разделе [команды MenuCommand и олеменукоммандс](/previous-versions/visualstudio/visual-studio-2015/misc/menucommands-vs-olemenucommands?preserve-view=true&view=vs-2015).

4. Если какой-либо из команд требует значков, добавьте в элемент элемент [Bitmaps](../../extensibility/bitmaps-element.md) `Commands` . Затем для каждого значка добавьте элемент [Bitmap](../../extensibility/bitmap-element.md) к `Bitmaps` элементу. Здесь указывается расположение ресурса точечного рисунка. Дополнительные сведения см. [в разделе Добавление значков в команды меню](../../extensibility/adding-icons-to-menu-commands.md).

   Для правильного размещения большинства меню, групп и команд можно использовать родительскую структуру. Для очень больших наборов команд, а также если меню, группа или команда должны отображаться в нескольких местах, рекомендуется указать размещение команд.

#### <a name="to-rely-on-parenting-to-place-ui-elements-in-the-ide"></a>Полагаться на родительский элемент для размещения элементов пользовательского интерфейса в интегрированной среде разработки

1. Для типичного родительского объекта создайте `Parent` элемент в каждом `Menu` элементе, `Group` и, `Command` который определен в пакете.

    Целевым `Parent` элементом элемента является меню или группа, которые будут содержать меню, группу или команду.

   1. Присвойте `guid` атрибуту имя `GuidSymbol` элемента, определяющего набор команд. Если целевой элемент не является частью пакета, используйте GUID для этого набора команд, как определено в соответствующем *vsct* -файле.

   2. Установите `id` атрибут в соответствии с `id` атрибутом целевого меню или группы. Список меню и групп, предоставляемых Visual Studio, см. в разделе [идентификаторы GUID и идентификаторы меню Visual Studio](../../extensibility/internals/guids-and-ids-of-visual-studio-menus.md) , идентификаторы [GUID и идентификаторы панелей инструментов Visual Studio](../../extensibility/internals/guids-and-ids-of-visual-studio-toolbars.md).

   При наличии большого количества элементов пользовательского интерфейса для размещения в интегрированной среде разработки или при наличии элементов, которые должны отображаться в нескольких местах, определите их размещение в элементе [CommandPlacements](../../extensibility/commandplacements-element.md) , как показано в следующих шагах.

#### <a name="to-use-command-placement-to-place-ui-elements-in-the-ide"></a>Использование размещения команд для размещения элементов пользовательского интерфейса в интегрированной среде разработки

1. После элемента `Commands` добавьте элемент `CommandPlacements`.

2. В `CommandPlacements` элементе добавьте `CommandPlacement` элемент для каждого меню, группы или команды для размещения.

    Каждый `CommandPlacement` элемент или `Parent` элемент помещает одно меню, группу или команду в одно расположение IDE. У элемента пользовательского интерфейса может быть только один родительский элемент, но может быть несколько командных размещений. Чтобы поместить элемент пользовательского интерфейса в несколько расположений, добавьте `CommandPlacement` элемент для каждого расположения.

3. Задайте `guid` атрибуты и для `id` каждого элемента в `CommandPlacement` меню или группе размещения, точно так же, как и для `Parent` элемента. Можно также задать атрибут, `priority` чтобы установить относительное расположение элемента пользовательского интерфейса.

   Размещение можно смешивать путем наследования и размещения команд. Однако для очень больших наборов команд рекомендуется использовать только размещение команд.

### <a name="add-specialized-behaviors"></a>Добавление специализированных поведений
 Элемент [CommandFlag](../../extensibility/command-flag-element.md) можно использовать для изменения поведения меню и команд, например для изменения их внешнего вида и видимости. Можно также повлиять на видимость команды с помощью элемента [висибилитиконстраинтс](../../extensibility/visibilityconstraints-element.md) или добавить сочетания клавиш с помощью элемента [сочетания клавиш](../../extensibility/keybindings-element.md) . Некоторые виды меню и команд уже имеют специализированные поведения, встроенные в.

#### <a name="to-add-specialized-behaviors"></a>Добавление специализированных поведений

1. Чтобы сделать элемент пользовательского интерфейса видимым только в определенных контекстах пользовательского интерфейса, например при загрузке решения, используйте ограничения видимости.

   1. После элемента `Commands` добавьте элемент `VisibilityConstraints`.

   2. Для каждого элемента пользовательского интерфейса, который необходимо ограничить, добавьте элемент [висибилититем](../../extensibility/visibilityitem-element.md) .

   3. Для каждого `VisibilityItem` элемента задайте `guid` `id` атрибуты и для меню, группы или команды, а затем присвойте `context` АТРИБУТУ нужный контекст пользовательского интерфейса, как определено в <xref:Microsoft.VisualStudio.Shell.Interop.UIContextGuids80> классе.

2. Чтобы задать видимость или доступность элемента пользовательского интерфейса в коде, используйте один или несколько следующих флагов команды:

   - `DefaultDisabled`

   - `DefaultInvisible`

   - `DynamicItemStart`

   - `DynamicVisibility`

   - `NoShowOnMenuController`

   - `NotInTBList`

   Дополнительные сведения см. в описании элемента [CommandFlag](../../extensibility/command-flag-element.md) .

3. Чтобы изменить способ отображения элемента или динамически изменить его внешний вид, используйте один или несколько следующих флагов команды:

   - `AlwaysCreate`

   - `CommandWellOnly`

   - `DefaultDocked`

   - `DontCache`

   - `DynamicItemStart`

   - `FixMenuController`

   - `IconAndText`

   - `Pict`

   - `StretchHorizontally`

   - `TextMenuUseButton`

   - `TextChanges`

   - `TextOnly`

   Дополнительные сведения см. в описании элемента [CommandFlag](../../extensibility/command-flag-element.md) .

4. Чтобы изменить способ реагирования элемента при получении команд, используйте один или несколько следующих флагов команды:

   - `AllowParams`

   - `CaseSensitive`

   - `CommandWellOnly`

   - `FilterKeys`

   - `NoAutoComplete`

   - `NoButtonCustomize`

   - `NoKeyCustomize`

   - `NoToolbarClose`

   - `PostExec`

   - `RouteToDocs`

   - `TextIsAnchorCommand`

   Дополнительные сведения см. в описании элемента [CommandFlag](../../extensibility/command-flag-element.md) .

5. Чтобы присоединить заданное меню сочетание клавиш к меню или элементу меню, добавьте символ амперсанда (&) в `ButtonText` элемент меню или пункта меню. Символ, следующий за амперсандом, является активным сочетанием клавиш при открытом родительском меню.

6. Чтобы присоединить независимое от меню сочетание клавиш к команде, используйте элемент [сочетания клавиш](../../extensibility/keybindings-element.md) . Дополнительные сведения см. в описании элемента [настраиваемое сочетание клавиш](../../extensibility/keybinding-element.md) .

7. Чтобы локализовать текст меню, используйте `LocCanonicalName` элемент. Дополнительные сведения см. в элементе [Strings](../../extensibility/strings-element.md) .

   Некоторые типы меню и кнопок включают специализированные поведения. В следующем списке описаны некоторые специализированные типы меню и кнопок. Для других типов см `types` . Описание атрибутов в [меню](../../extensibility/menu-element.md), [кнопке](../../extensibility/button-element.md)и элементах [со списком](../../extensibility/combo-element.md) .

   - Поле со списком: поле со списком — это раскрывающийся список, который можно использовать на панели инструментов. Чтобы добавить поля со списком в пользовательский интерфейс, создайте элемент [КомБОС](../../extensibility/combos-element.md) в `Commands` элементе. Затем добавьте в `Combos` элемент элемент a `Combo` для каждого добавляемого поля со списком. `Combo` элементы имеют одинаковые атрибуты и дочерние элементы, `Button` а также `DefaultWidth` `idCommandList` атрибуты и. `DefaultWidth`Атрибут задает ширину в пикселях, а `idCommandList` атрибут указывает на идентификатор команды, который используется для заполнения поля со списком.

   - Контроллер меню. контроллер меню — это кнопка со стрелкой рядом с ней. При нажатии стрелки открывается список. Чтобы добавить контроллер меню в пользовательский интерфейс, создайте `Menu` элемент и присвойте его `type` атрибуту значение `MenuController` или `MenuControllerLatched` , в зависимости от желаемого поведения. Чтобы заполнить контроллер меню, установите его в качестве родительского элемента для `Group` элемента. Контроллер меню отобразит все дочерние элементы этой группы в раскрывающемся списке.

## <a name="see-also"></a>См. также раздел
- [Расширение меню и команд](../../extensibility/extending-menus-and-commands.md)
- [Файлы таблицы команд Visual Studio (. vsct)](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md)
- [Справочник по XML-схеме VSCT](../../extensibility/vsct-xml-schema-reference.md)