---
title: Просмотр потоков в окне "Параллельные стеки" | Документация Майкрософт
description: Использование окна "Параллельные стеки" для оптимизации отладки многопоточных приложений. Вы можете просмотреть сведения о стеке для всех потоков, а также сведения о связанном с задачами стеке вызовов.
ms.custom: SEO-VS-2020
ms.date: 11/20/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.parallelstacks
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- debugger, parallel tasks window
ms.assetid: f50efb78-5206-4803-bb42-426ef8133f2f
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 7b92f4e2faf2043c26c7119b6f9754edd3bdc990
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99884394"
---
# <a name="view-threads-and-tasks-in-the-parallel-stacks-window-c-visual-basic-c"></a>Просмотр потоков и задач в окне "Параллельные стеки" (C#, Visual Basic, C++)

Окно **Параллельные стеки** применяется при отладке многопотоковых приложений. В нем есть несколько представлений.

- [Представление потоков](#threads-view) содержит сведения о стеке вызовов для всех потоков приложения. Вы можете переходить в различные потоки и кадры стека в потоках.

- [Представление задач](#tasks-view) содержит сведения о связанном с задачами стеке вызовов.
  - В управляемом коде в представлении **Задачи** отображаются стеки вызовов объектов <xref:System.Threading.Tasks.Task?displayProperty=fullName>.
  - В машинном коде в представлении **Задачи** отображаются стеки вызовов [групп задач](/cpp/parallel/concrt/task-parallelism-concurrency-runtime), [параллельных алгоритмов](/cpp/parallel/concrt/parallel-algorithms), [асинхронных агентов](/cpp/parallel/concrt/asynchronous-agents) и [упрощенных задач](/cpp/parallel/concrt/task-scheduler-concurrency-runtime).

- [Представление метода](#method-view) содержит стек вызовов в выбранном методе.

## <a name="use-the-parallel-stacks-window"></a>Использование окна "Параллельные стеки"

Чтобы открыть окно **Параллельные стеки**, необходимо находиться в сеансе отладки. Выберите **Отладка** > **Окна** > **Параллельные стеки**.

### <a name="toolbar-controls"></a>Элементы управления панели инструментов

Окно **Параллельные стеки** содержит следующие элементы управления панели инструментов.

![Панель инструментов в окне параллельных стеков](../debugger/media/parallel_stackstoolbar.png "Всплывающие подсказки параллельных стеков")

|Значок|Элемент управления|Описание|
|-|-|-|
|![Поле со списком "Потоки"/"Задачи"](media/parallel_toolbar1.png "Поле со списком "Потоки"/"Задачи"")|Поле со списком **Потоки**/**Задачи**|Переключает отображение между стеками вызова для потоков и стеками вызова для задач. Дополнительные сведения см. в разделах [Представление "Задачи"](#tasks-view) и [Представление "Потоки"](#threads-view).|
|![Значок "Показывать только отмеченные"](media/parallel_toolbar2.png "Значок "Показывать только отмеченные"")|Показывать только помеченные|Отображает стеки вызовов только для потоков, которые помечены в других окнах отладки, таких как окно **Потоки GPU** и окно **Контроль параллельных данных**.|
|![Значок "Переключение представления метода"](media/parallel_toolbar3.png "Значок "Переключение представления метода"")|Переключение **представления метода**|Переключает представления стека и **представление метода**. Дополнительные сведения см. в разделе [Представление "Метод"](#method-view).|
|![Значок "Автопрокрутка к текущему кадру"](media/parallel_toolbar4.png "Значок "Автопрокрутка к текущему кадру"")|Автопрокрутка к текущему кадру стека|Автоматически прокручивает граф для отображения текущего кадра стека. Этот компонент применяется при изменении текущего кадра стека из других окон или при попадании в новую точку останова в крупных графах.|
|![Значок "Переключить масштаб"](media/parallel_toolbar5.png "Значок "Переключить масштаб"")|Переключить элемент управления масштабом|Показывает или скрывает элемент управления масштаба в левой части окна. <br /><br />Чтобы изменить масштаб вне зависимости от видимости элемента управления масштаба, можно также нажать клавишу **CTRL** и повернуть колесо мыши. Или можно нажать сочетание клавиш **CTRL**+**SHIFT**+ **+** для увеличения масштаба и **CTRL**+**SHIFT**+ **-** для уменьшения масштаба. |

### <a name="stack-frame-icons"></a>Значки кадров стека
Следующие значки предоставляют сведения об активных и текущих кадрах стека во всех представлениях.

|Значок|Описание|
|-|-|
|![Желтая стрелка](media/icon_parallelyellowarrow.gif)|Указывает текущее расположение (активный кадр стека) текущего потока.|
|![Значок "Потоки"](media/icon_parallelthreads.gif)|Указывает текущее расположение (активный кадр стека) потока, не являющегося текущим.|
|![Зеленая стрелка](media/icon_parallelgreenarrow.gif)|Указывает текущий кадр стека (текущий контекст отладчика). Имя метода выделяется полужирным шрифтом везде, где оно отображается.|

### <a name="context-menu-items"></a>Элементы контекстного меню
Следующие элементы контекстного меню доступны при щелчке правой кнопкой мыши метода в представлении **Потоки** или **Задачи**. Последние шесть элементов аналогичны элементам в окне [Стек вызовов](how-to-use-the-call-stack-window.md).

![Контекстное меню окна параллельных стеков](../debugger/media/parallel_contmenu.png "Контекстное меню окна параллельных стеков")

|Элемент меню|Описание|
|-|-|
|**Пометить**|Помечает выбранный элемент.|
|**Снять пометку**|Снимает пометку с выбранного элемента.|
|**Заморозить**|Замораживает выбранный элемент.|
|**Разморозить**|Размораживает выбранный элемент.|
|**Перейти к кадру**|Выполняет те же функции, то и соответствующая команда меню в окне **Стек вызовов**. Однако в окне **Параллельные стеки** один метод может находиться в нескольких кадрах. Вы можете выбрать нужный фрейм в подменю для этого элемента. Если один из кадров стека расположен в текущем потоке, этот кадр выбирается по умолчанию в подменю.|
|**Перейти к задаче** или **Перейти к потоку**|Переключает представление **Задача** или **Потоки** и сохраняет выделенным тот же кадр стека.|
|**Перейти к исходному коду**|Переходит к соответствующему расположению в окне исходного кода. |
|**Перейти к дизассемблированию**|Переходит к соответствующему расположению в окне **Дизассемблирование**.|
|**Показать внешний код**|Скрывает и показывает внешний код.|
|**Шестнадцатеричный вывод**|Переключается между десятичным и шестнадцатеричным отображением.|
|**Показать потоки в исходном коде**|Помечает расположение потока в окне исходного кода. |
|**Сведения о загрузке символов**|Открывает диалоговое окно **Сведения о загрузке символов**.|
|**Параметры символов**|Открывает диалоговое окно **Параметры символов**. |

## <a name="threads-view"></a>Представление "Потоки"

В представлении **Потоки** кадр стека и путь вызова текущего потока выделены синим цветом. Текущее расположение потока указано желтой стрелкой.

Чтобы изменить текущий кадр стека, дважды щелкните другой метод. При этом также может измениться текущий поток в зависимости от того, входит ли выбранный метод в текущий поток или является частью другого потока.

Если граф представления **Потоки** слишком велик и не помещается в окне, в окне появляется элемент управления **Вид с высоты птичьего полета**. Вы можете поместить кадр в элемент управления и переходить к разным частям графа.

На следующем рисунке показан один поток, идущий от основного кода к управляемому, а затем — к машинному. В текущем методе находятся шесть потоков. Один из них переходит в Thread.Sleep, другой переходит в Console.WriteLine, а затем в SyncTextWriter.WriteLine.

 ![Представление потоков в окне параллельных стеков](../debugger/media/parallel_stack1.png "Представление потоков в окне параллельных стеков")

В следующей таблице описаны основные функции представления **Потоки**.

|Выноска|Имя элемента|Описание|
|-|-|-|
|1|Сегмент или узел стека вызова|Содержит последовательности методов для одного потока или нескольких. Если кадр не имеет линий со стрелками, то он представляет собой единый путь вызова для потоков.|
|2|Синее выделение|Указывает путь вызова текущего потока.|
|3|Линии со стрелками|Соединяют узлы и показывают единый путь вызова для потоков.|
|4|Заголовок узла|Показывает количество процессов и потоков для узла.|
|5|Метод|Представляет один или несколько кадров стека одного метода.|
|6|Всплывающая подсказка для метода|Отображается при наведении указателя мыши на метод. В представлении **Потоки** в подсказке отображаются все потоки в виде таблицы, похожей на таблицу окна **Потоки**. |

## <a name="tasks-view"></a>Представление задач
Если для выражения параллелизма приложение использует объекты <xref:System.Threading.Tasks.Task?displayProperty=fullName> (управляемый код) или объекты `task_handle` (машинный код), можно использовать представление **Задачи**. Представление **Задачи** отображает стеки вызова задач вместо потоков.

В представлении **Задачи**

- Стеки вызовов потоков, не выполняющие задачи, не отображаются.
- Стеки вызовов потоков, выполняющие задачи, визуально отделяются в верхней и нижней частях для отображения наиболее релевантных кадров, относящихся к задачам.
- Когда несколько задач расположено в одном потоке, стеки вызовов этих задач отображаются в отдельных узлах.

Чтобы просмотреть весь стек вызовов, вернитесь в представление **Потоки**. Для этого щелкните кадр стека правой кнопкой мыши и выберите команду **Перейти к потоку**.

На следующем рисунке показано представление **Потоки** в верхней части и соответствующее представление **Задачи** в нижней части.

![Представления потоков и задач](../debugger/media/parallel_threads-tasks.png "Представления потоков и задач")

Наведите указатель мыши на метод, чтобы отобразить подсказку с дополнительными сведениями. В представлении **Задачи** подсказка отображает все задачи в виде таблицы, похожей на таблицу окна **Задачи**.

На следующем рисунке показана подсказка для метода в представлении **Потоки** в верхней части и соответствующее представление **Задачи** в нижней части.

![Подсказки для потоков и задач](../debugger/media/parallel_threads-tasks-tooltips.png "Подсказки для потоков и задач")

## <a name="method-view"></a>Представление метода
Из представления **Потоки** или **Задачи** можно прикрепить график для текущего метода. Для этого следует щелкнуть значок **Переключить представление метода** на панели инструментов. **Представление "Методы"** показывает все методы для всех потоков, которые вызывают текущий метод или вызываются им. На следующем рисунке показано отображение одной и той же информации в представлении **Потоки** слева и в **представлении "Методы"** справа.

![Представление "Потоки" и представление "Методы"](../debugger/media/parallel_methodview.png "Представление "Потоки" и представление "Методы"")

Переключение на новый кадр стека делает этот метод текущим методом, и в **представлении "Методы"** отображаются все вызывающие и вызываемые объекты нового метода. Из-за этого некоторые потоки могут появиться на представлении или исчезнуть из него (в зависимости от того, отображается ли этот метод в их стеках вызова). Чтобы вернуться в представление стека вызовов, еще наз щелкните значок **Представление "Методы"** на панели инструментов.

## <a name="see-also"></a>См. также
- [Начало отладки многопоточных приложений](../debugger/get-started-debugging-multithreaded-apps.md)
- [Пошаговое руководство: отладка параллельного приложения](../debugger/walkthrough-debugging-a-parallel-application.md)
- [Первое знакомство с отладчиком](../debugger/debugger-feature-tour.md)
- [Отладка управляемого кода](../debugger/debugging-managed-code.md)
- [Параллельное программирование](/dotnet/standard/parallel-programming/index)
- [Использование окна задач](../debugger/using-the-tasks-window.md)
- [Класс Task](../extensibility/debugger/task-class-internal-members.md)
