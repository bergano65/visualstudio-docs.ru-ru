---
title: Включение отладки для приложений ASP.NET | Документация Майкрософт
description: Узнайте, как включить отладку для приложений ASP.NET и ASP.NET Core в Visual Studio. Процесс можно запустить на сервере IIS Express или на локальном сервере IIS.
ms.custom: SEO-VS-2020
ms.date: 10/29/2020
ms.topic: how-to
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- debugging ASP.NET Web applications
- Web.config configuration file, debug mode
- debugging [Visual Studio], ASP.NET
ms.assetid: 3beed819-cece-4864-8184-bd410000973a
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- aspnet
ms.openlocfilehash: 8ef65fbd9452aef52d807210f84928a4eef14100
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99877750"
---
# <a name="debug-aspnet-or-aspnet-core-apps-in-visual-studio"></a>Отладка приложений ASP.NET и ASP.NET Core в Visual Studio

Вы можете выполнять отладку приложений ASP.NET и ASP.NET Core в Visual Studio. Точный процесс зависит от типа приложения (ASP.NET или ASP.NET Core) и от того, выполняется ли он в IIS Express или на локальном сервере IIS.

>[!NOTE]
>Приведенные далее шаги и параметры относятся только к отладке приложений на локальном сервере. При отладке приложений на удаленном сервере IIS используется **подключение к процессу**, а эти параметры игнорируются. Дополнительные сведения и инструкции по удаленной отладке приложений ASP.NET в IIS см. в разделе [Удаленная отладка ASP.NET на компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md) или [Удаленная отладка ASP.NET Core на удаленном компьютере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-computer.md).

Встроенный сервер IIS Express входит в состав Visual Studio. IIS Express является сервером отладки по умолчанию для проектов ASP.NET и ASP.NET Core. Он уже предварительно настроен. Это самый простой способ отладки, идеально подходящий для первоначальной отладки и тестирования.

Можно также выполнять отладку приложения ASP.NET или ASP.NET Core на локальном сервере IIS (версии 8.0 или более поздней), настроенном для запуска этого приложения. Для отладки на локальном сервере IIS необходимо выполнить следующие требования.

<a name="iis"></a>
- Если она не установлена, установите рабочую нагрузку **ASP.NET и веб-разработка**. (Перезапустите Visual Studio Installer, выберите **Изменить** и добавьте эту рабочую нагрузку.)

   ::: moniker range="vs-2017"
   В Visual Studio 2017 найдите компонент **Поддержка IIS во время разработки**. Убедитесь, что он выбран при добавлении рабочей нагрузки.
   ::: moniker-end
- Запустите Visual Studio от имени администратора.
- Установить и правильно настроить IIS, указав соответствующие версии ASP.NET и (или) ASP.NET Core. Дополнительные сведения об использовании IIS с ASP.NET Core см. в статье [Размещение ASP.NET Core в Windows со службами IIS](/aspnet/core/host-and-deploy/iis/index). Инструкции для ASP.NET см. в статье [Установка служб IIS и модулей ASP.NET](/iis/application-frameworks/scenario-build-an-aspnet-website-on-iis/configuring-step-1-install-iis-and-asp-net-modules).
- Убедиться, что приложение работает в IIS без ошибок.

## <a name="debug-aspnet-apps"></a>Отладка приложений ASP.NET

Сервер IIS Express используется по умолчанию и уже предварительно настроен. Если вы хотите выполнять отладку на локальном сервере IIS, убедитесь, что выполняются [требования для отладки на локальном сервере IIS](#iis).

1. Выберите проект ASP.NET в **Обозревателе решений** Visual Studio, щелкните значок **Свойства** и нажмите сочетание клавиш **Alt**+**Enter**, или щелкните проект правой кнопкой мыши и выберите пункт **Свойства**.

1. Перейдите на вкладку **Интернет**.

1. В области **Свойства** в разделе **Серверы** выполните следующее.
   - Для сервера IIS Express выберите **IIS Express** в раскрывающемся списке.
   - Для локального сервера IIS:
     1. в раскрывающемся списке выберите **Локальный сервер IIS**;
     1. рядом с полем **URL-адрес проекта** установите флажок **Создать виртуальный каталог**, если вы еще не настроили приложение в службах IIS.

1. В разделе **Отладчики** выберите **ASP.NET**.

   ![Параметры отладчика ASP.NET](media/dbg-aspnet-enable-debugging2.png "Параметры отладчика ASP.NET")

1. Выберите **Файл** > **Сохранить выбранные элементы** или нажмите сочетание клавиш **CTRL**+**S**, чтобы сохранить изменения.

1. Для отладки приложения установите точки останова в некоторых местах кода проекта. В панели инструментов Visual Studio убедитесь, что для конфигурации задано значение **Отладка**, и нужный вам браузер отображается в поле эмулятора **IIS Express (\<Browser name>)** или **Локальный сервер IIS (\<Browser name>)** .

1. Чтобы начать отладку, в панели инструментов выберите **IIS Express (\<Browser name>)** или **Локальный сервер IIS(\<Browser name>)** , а затем выберите **Начать отладку** в меню **Отладка** или нажмите клавишу **F5**. Отладчик приостанавливает выполнение в точках останова. Если отладчик не может попасть в точки останова, см. раздел [Устранение неполадок при отладке](#troubleshoot-debugging).

## <a name="debug-aspnet-core-apps"></a>Отладка приложений ASP.NET Core

Сервер IIS Express используется по умолчанию и уже предварительно настроен. Если вы хотите выполнять отладку на локальном сервере IIS, убедитесь, что выполняются [требования для отладки на локальном сервере IIS](#iis).

1. Выберите проект ASP.NET Core в **Обозревателе решений** Visual Studio, щелкните значок **Свойства** и нажмите сочетание клавиш **Alt**+**Enter**, или щелкните проект правой кнопкой мыши и выберите пункт **Свойства**.

1. Выберите вкладку **Отладка**.

1. В области **Свойства** рядом с полем **Профиль** выполните следующее.
   - Для сервера IIS Express выберите **IIS Express** в раскрывающемся списке.
   - Для локального сервера IIS выберите в раскрывающемся списке имя приложения или нажмите **Создать**, создайте новое имя профиля и нажмите кнопку **ОК**.

1. В раскрывающемся списке рядом с полем **Запуск** выберите **IIS Express** или **IIS**.

1. Убедитесь, что флажок **Запуск браузера** установлен.

1. В разделе **Переменные среды** убедитесь, что параметр **ASPNETCORE_ENVIRONMENT** существует и имеет значение **Разработка**. Если этот параметр отсутствует, нажмите кнопку **Добавить** и добавьте его.

   ![Параметры отладчика ASP.NET Core](../debugger/media/dbg-aspnet-enable-debugging3.png "Параметры отладчика ASP.NET Core")

1. Выберите **Файл** > **Сохранить выбранные элементы** или нажмите сочетание клавиш **CTRL**+**S**, чтобы сохранить изменения.

1. Для отладки приложения установите точки останова в некоторых местах кода проекта. В панели инструментов Visual Studio убедитесь, что для конфигурации задано значение **Отладка**, а в поле эмулятора указано **IIS Express** или имя нового профиля IIS.

1. Чтобы начать отладку, в панели инструментов выберите **IIS Express** или **\<IIS profile name>** , а затем выберите **Начать отладку** в меню **Отладка** или нажмите клавишу **F5**. Отладчик приостанавливает выполнение в точках останова. Если отладчик не может попасть в точки останова, см. раздел [Устранение неполадок при отладке](#troubleshoot-debugging).

## <a name="troubleshoot-debugging"></a>Устранение неполадок отладки

Если при отладке на локальном сервере IIS не удается достичь точки останова, выполните следующие шаги для устранения неполадок.

1. Запустите веб-приложение из IIS и убедитесь, что оно работает правильно. Оставьте веб-приложение работать.

2. В Visual Studio выберите **Отладка > Подключиться к процессу** или нажмите сочетание клавиш **Ctrl**+**Alt**+**P**, а затем подключитесь к процессу ASP.NET или ASP.NET (обычно это процесс **w3wp.exe** или **dotnet.exe**). Дополнительные сведения см. в разделах [Подключение к процессу](attach-to-running-processes-with-the-visual-studio-debugger.md) и [Поиск имени процесса ASP.NET](how-to-find-the-name-of-the-aspnet-process.md).

Если вы можете подключиться и попасть в точку останова путем выбора пункта **Подключиться к процессу**, но не путем выбора **Отладка** > **Начать отладку** или нажатия клавиши **F5**, скорее всего, в свойствах проекта неправильно задан параметр. Если вы используете файл HOSTS, также проверьте правильность его настройки.

## <a name="configure-debugging-in-the-webconfig-file"></a>Настройка отладки в файле web.config

В проектах ASP.NET по умолчанию имеются файлы *web.config*, которые содержат сведения о конфигурации и запуске, в том числе параметры отладки. Файлы *web.config* должны быть правильно настроены для отладки. Обновить файлы *web.config* можно с помощью параметров **Свойства**, которые рассматривались в предыдущих разделах, но можно также настроить эти файлы вручную.

> [!NOTE]
> В проектах ASP.NET Core изначально нет файлов *web.config*, но для настройки сведений о конфигурации и запуске можно использовать файлы *appsettings.json* и *launchSettings.json*. При развертывании приложения в этом проекте создается файл (или файлы) *web.config*, но обычно в нем отсутствуют сведения об отладке.

> [!TIP]
> Процесс развертывания может обновить параметры в *web.config*, поэтому, прежде чем приступить к отладке, проверьте, настроена ли отладка в файле *web.config*.

**Чтобы вручную настроить отладку в файле *web.config*, выполните следующие действия.**

1. В Visual Studio откройте файл *web.config* проекта ASP.NET.

2. Файл *web.config* — это XML-файл, поэтому он содержит вложенные разделы, помеченные тегами. Найдите раздел `configuration/system.web/compilation`. (Если элемент `compilation` не существует, создайте его.)

3. Убедитесь, что атрибут `debug` в элементе `compilation` имеет значение `true`. (Если в элементе `compilation` отсутствует атрибут `debug`, добавьте его и установите для него значение `true`.)

   Если вместо сервера IIS Express по умолчанию вы используете локальный сервер IIS, убедитесь, что значение атрибута `targetFramework` в элементе `compilation` соответствует платформе на сервере IIS.

   Элемент `compilation` в файле *web.config* должен выглядеть, как показано в следующем примере:

   > [!NOTE]
   > Этот пример представляет часть файла *web.config*. Обычно в элементах `configuration` и `system.web` имеются дополнительные разделы XML, а элемент `compilation` может также содержать другие атрибуты и элементы.

   ```xml
   <configuration>
      ...
      <system.web>
          <compilation  debug="true"  targetFramework="4.6.1" ... >
             ...
          </compilation>
      </system.web>
   </configuration>
   ```

[!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] автоматически обнаруживает изменения в файлах *web.config* и применяет новые параметры конфигурации. Не нужно перезагружать компьютер или сервер IIS, чтобы изменения вступили в силу.

Веб-сайт может содержать несколько виртуальных каталогов и подкаталогов, и в каждом из них могут быть файлы *web.config*. Приложения [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] наследуют параметры конфигурации от файлов *web.config*, находящихся на более высоких уровнях в пути URL-адреса. Параметры иерархических файлов *web.config* применяются ко всем приложениям [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)], находящимся на более низком уровне в иерархической структуре. Настройка другой конфигурации в файле *web.config*, находящемся ниже в иерархической структуре, переопределяет параметры, заданные в файле на более высоком уровне.

Например, если задать `debug="true"` в файле <em>www.microsoft.com/aaa/web.config</em>, все приложения в папке *aaa* и во всех вложенных папках *aaa* наследуют этот параметр, кроме тех приложений, у которых имеется собственный файл *web.config*.

## <a name="publish-in-debug-mode-using-the-file-system"></a>Публикация в режиме отладки с помощью файловой системы

Существуют разные способы публикации приложений в IIS. Приведенные далее действия показывают, как можно создать и развернуть профиль публикации в режиме отладки с помощью файловой системы. Для этого необходимо запустить Visual Studio от имени администратора.

> [!IMPORTANT]
> После изменения кода или повторной сборки необходимо еще раз выполнить эти действия для повторной публикации.

1. В Visual Studio щелкните проект правой кнопкой мыши и выберите **Опубликовать**.

3. Выберите **IIS, FTP и т. п.** и нажмите **Опубликовать**.

    ![Снимок экрана: диалоговое окно "Выберите целевой объект публикации" в Visual Studio. Выбраны пункты IIS, FTP и "Веб-развертывание", а также выделена кнопка "Опубликовать".](media/dbg-aspnet-local-iis.png)

4. В диалоговом окне **CustomProfile** в качестве **метода публикации** выберите **файловую систему**.

5. В поле **Целевое расположение** нажмите кнопку **Обзор** ( **...** ).

   - Для приложения ASP.NET выберите значок **Локальный сервер IIS**, выберите веб-сайт, созданный для приложения, а затем нажмите кнопку **Открыть**.

     ![Публикация ASP.NET в IIS](media/dbg-aspnet-local-iis1.png "Публикация ASP.NET в IIS")

   - Для приложения ASP.NET Core выберите значок **Файловая система**, выберите папку, настроенную для приложения, а затем нажмите кнопку **Открыть**.

1. Выберите **Далее**.

1. В разделе **Конфигурация** выберите в раскрывающемся списке пункт **Отладка**.

1. Нажмите кнопку **Сохранить**.

1. В диалоговом окне **Опубликовать** убедитесь, что отображается **CustomProfile** (или имя только что созданного профиля), и параметр **LastUsedBuildConfiguration** имеет значение **Отладка**.

1. Нажмите **Публиковать**.

    ![Снимок экрана: диалоговое окно "Опубликовать" с выбранным приложением CustomProfile, выделенной кнопкой "Опубликовать" и LastBuildConfiguration с заданным значением "Отладка".](media/dbg-aspnet-local-iis-select-site.png)

> [!IMPORTANT]
> Режим отладки значительно снижает производительность приложения. Для улучшения производительности установите `debug="false"` в файле *web.config*, а при развертывании рабочего приложения или при выполнении измерений производительности указывайте сборку выпуска.

## <a name="see-also"></a>См. также
- [Отладка ASP.NET: системные требования](aspnet-debugging-system-requirements.md)
- [Практическое руководство. Запуск рабочего процесса в учетной записи пользователя](how-to-run-the-worker-process-under-a-user-account.md)
- [Практическое руководство. Поиск имени процесса ASP.NET](how-to-find-the-name-of-the-aspnet-process.md)
- [Отладка развернутых веб-приложений](debugging-deployed-web-applications.md)
- [Пошаговое руководство: Отладка веб-формы](walkthrough-debugging-a-web-form.md)
- [Практическое руководство. Отладка исключений ASP.NET](how-to-debug-aspnet-exceptions.md)
- [Отладка веб-приложений: ошибки и устранение неполадок](debugging-web-applications-errors-and-troubleshooting.md)
