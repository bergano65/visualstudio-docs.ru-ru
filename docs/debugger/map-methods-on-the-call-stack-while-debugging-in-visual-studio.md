---
title: Создание визуальной карты стека вызовов | Документация Майкрософт
ms.date: 11/26/2018
ms.topic: conceptual
f1_keywords:
- vs.progression.debugwithcodemaps
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- call stacks, code maps
- Call Stack window, mapping calls
- debugging [Visual Studio], diagramming the call stack
- call stacks, mapping
- Call Stack window, visualizing
- debugging code visually
- debugging [Visual Studio], mapping the call stack
- call stacks, visualizing
- debugging, code maps
- Call Stack window, tracing calls visually
- Call Stack window, show on code map
- debugging [Visual Studio], tracing the call stack visually
- debugging [Visual Studio], visualizing the call stack
ms.assetid: d6a72e5e-f88d-46fc-94a3-1789d34805ef
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: da49cd81ea309df2d8e2bd0b4c41c28a84564fa8
ms.sourcegitcommit: 3ca33862c1cfc3ccb83de3e95f1e69e860ab143a
ms.translationtype: MTE95
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2019
ms.locfileid: "57526094"
---
# <a name="create-a-visual-map-of-the-call-stack-while-debugging-c-visual-basic-c-javascript"></a>Создание визуальной карты стека вызовов при отладке (C#, Visual Basic, C++, JavaScript)

Для визуального отслеживания стека вызовов при отладке можно создать карту кода. Вы можете вести заметки на карте, чтобы следить за деятельностью кода и сосредоточиться на поиске ошибок.

Пошаговое руководство просмотрите это видео: Видео: [Визуальная отладка с интеграцией отладчика сопоставления кода (канал 9)](http://go.microsoft.com/fwlink/?LinkId=293418)

Сведения о командах и действия, которые можно использовать с помощью карт кода, см. в разделе [Просмотр и реорганизация карт кода](../modeling/browse-and-rearrange-code-maps.md).

>[!IMPORTANT]
>Можно создать только в карты кода [Visual Studio Enterprise edition](https://visualstudio.microsoft.com/downloads/).

Ниже приведен краткий обзор карту кода.

 ![Отладка со стеками вызовов на картах кода](../debugger/media/debuggermap_overview.png "DebuggerMap_Overview")

##  <a name="MapStack"></a> Сопоставление стека вызова

1. В Visual Studio Enterprise C#, Visual Basic, C++ или JavaScript проекта, начать отладку, выбрав **Отладка** > **начать отладку** или нажав клавиши **F5**.

1. Когда ваше приложение переходит в режим приостановки выполнения или при входе в функцию, выберите **отладки** > **карта кода**, или нажмите клавишу **Ctrl**+**Shift** +**`**.

   Текущий стек вызовов выделен в новой карте кода оранжевым цветом:

   ![См. в разделе стек вызовов на карте кода](../debugger/media/debuggermap_seeundocallstack.png "DebuggerMap_SeeUndoCallStack")

Код сопоставления обновления автоматически в процессе продолжения отладки. Изменение элементов карты или макет не влияет на код любым способом. Можно свободно переименовать, изменить или удалить любой элемент в сопоставлении.

Чтобы получить дополнительные сведения об элементе, наведите на нее и просмотрите подсказку элемента. Можно также выбрать **условных обозначений** на панели инструментов, чтобы узнать, что означает каждый значок.

![Условные обозначения карты кода](../debugger/media/debuggermap_showlegend.png "условные обозначения карты кода")

>[!NOTE]
>Сообщение **диаграмме могут основываться на более старой версии кода** в верхней части кода карты означает, что с момента последнего обновления сопоставления код мог измениться. Например, вызов в сопоставлении может уже не существовать в коде. Закройте сообщение, а затем попытайтесь повторить сборку решения, прежде чем повторно обновлять сопоставление.

## <a name="map-external-code"></a>Сопоставить внешний код

По умолчанию в сопоставлении отображается только ваш код. Чтобы просмотреть внешний код на карте:

- Щелкните правой кнопкой мыши в **стек вызовов** и выберите **Показать внешний код**:

  ![Отображение внешнего кода, в окне стека вызовов](../debugger/media/debuggermap_callstackmenu.png "DebuggerMap_CallStackMenu")
- Или отмените его выбор **включить только мой код** в Visual Studio **средства** (или **Отладка**) > **параметры**  >   **Отладка**:

  ![Показать внешний код, используя диалоговое окно параметров](../debugger/media/debuggermap_debugoptions.png "DebuggerMap_DebugOptions")

## <a name="control-the-maps-layout"></a>Управлять макетом сопоставления

Изменение макета карты не влияет на код любым способом.

Чтобы управлять макетом сопоставления, выберите **макета** меню на панели инструментов карты.

В **макета** меню, вы можете:

-   Измените макет по умолчанию.
-   Остановить автоматическую, перекомпоновку сопоставления, отменив выделение **автоматически формировать макет при отладке**.
-   Изменить расположение как можно реже карты при добавлении элементов, отменяя **последовательный макет**.

##  <a name="MakeNotes"></a> Добавление примечаний к коду

Можно добавить комментарии, чтобы отслеживать, что происходит в коде.

Чтобы добавить комментарий, щелкните правой кнопкой мыши на карте кода и выберите **изменить** > **новый комментарий**, затем введите комментарий.

Чтобы добавить новую строку в комментарий, нажмите клавишу **Shift**+**ввод**.

 ![Добавление комментария к стеку вызовов на карте кода](../debugger/media/debuggermap_addcomment.png "DebuggerMap_AddComment")

##  <a name="UpdateMap"></a> Обновление сопоставления путем добавления следующего стека вызовов

Как запустить приложение для следующей точки останова или шаг с заходом в функцию, карты автоматически добавляет новые стеки вызова.

![Обновление карты кода следующим стеком вызовов](../debugger/media/debuggermap_addclearcallstack.png "DebuggerMap_AddClearCallStack")

Чтобы остановить сопоставление добавляло новые стеки вызова автоматически, выберите ![стек вызовов Показать на карте кода автоматически](../debugger/media/debuggermap_automaticupdateicon.gif "стек вызовов Показать на карте кода автоматически") на панели инструментов карты кода. Карты продолжает выделять существующие стеки вызовов. Чтобы вручную добавить текущий стек вызовов на карту, нажмите клавишу **Ctrl**+**Shift**+**`**.

##  <a name="AddRelatedCode"></a> Добавление связанного кода в сопоставление

Теперь, когда у вас есть карты в C# или Visual Basic, вы можете добавить элементы, такие как поля, свойства и другие методы, чтобы отслеживать, что происходит в коде.

Чтобы перейти к определению метода в коде, дважды щелкните метод в сопоставлении, или выберите его и нажмите клавишу **F12**, или щелкните его правой кнопкой мыши и выберите **перейти к определению**.

![Перейти к определению кода для метода на карте кода](../debugger/media/debuggermap_gotocodedefinition.png "DebuggerMap_GoToCodeDefinition")

Чтобы добавить элементы, которые вы хотите отслеживать в сопоставление, щелкните правой кнопкой мыши метод и выберите элементы, которые требуется отслеживать. Последние добавленные элементы отображаются зеленым цветом.

![Поля, связанные с методом на карте кода со стеком вызовов](../debugger/media/debuggermap_showedfields.png "DebuggerMap_ShowedFields")

>[!NOTE]
>По умолчанию при добавлении элементов в сопоставление также добавляются узлы родительской группы, соответствующие, например, классу, пространству имен или сборке. Эту функцию можно выключить и включить, выбрав **включить родительские элементы** кнопки на панели инструментов карты кода или нажав **Ctrl** при добавлении элементов.

![Отображение полей в методе на карте кода со стеком вызовов](../debugger/media/debuggermap_showfields.png "DebuggerMap_ShowFields")

Продолжайте формировать сопоставление, чтобы увидеть дополнительный код.

 ![См. в разделе методов, использующие поле: карте кода со стеком вызовов](../debugger/media/debuggermap_findallreferences.png "DebuggerMap_FindAllReferences")

 ![Методы, использующие поле на карте кода со стеком вызовов](../debugger/media/debuggermap_foundallreferences.png "DebuggerMap_FoundAllReferences")

##  <a name="FindBugs"></a> Поиск ошибок с помощью сопоставления
 Визуализация кода поможет вам быстрее находить ошибки. Например предположим, что вы ищите ошибку в приложении рисования. Когда вы создаете линию и пробуете отменить ее создание, ничего не происходит до тех пор, пока не будет нарисована следующая линия.

 Установив точки останова в методах `clear`, `undo` и `Repaint`, вы начинаете отладку и создаете сопоставление, аналогичное представленному ниже:

 ![Добавление другого стека вызовов на карте кода](../debugger/media/debuggermap_addpaintobjectcallstack.png "DebuggerMap_AddPaintObjectCallStack")

 Учтите, что все жесты пользователя в сопоставлении вызывают метод `Repaint`, за исключением `undo`. Возможно, именно поэтому функция `undo` срабатывает не сразу.

 После исправления ошибки и продолжения выполнения приложения, в сопоставление будет добавлен новый вызов из `undo` для `Repaint`:

 ![Добавить новый стек вызова к вызову метода на карте кода](../debugger/media/debuggermap_addnewcallforrepaint.png "DebuggerMap_AddNewCallForRepaint")

## <a name="share-the-map-with-others"></a>Использовать сопоставление совместно с другими пользователями

Можно экспортировать карту, отправить его другим пользователям с помощью Microsoft Outlook, сохраните его в решение и вернуть его в систему управления версиями.

Для совместного использования или сохранения карты используйте **совместно использовать** в панели инструментов карты кода.

![Карта кода стек вызова общей папки с другими пользователями](../debugger/media/debuggermap_sharewithothers.png "карте кода стек вызовов общей папки с другими пользователями")

## <a name="see-also"></a>См. также
[Сопоставление зависимостей во всех решениях](../modeling/map-dependencies-across-your-solutions.md)

[Использование карт кода для отладки приложений](../modeling/use-code-maps-to-debug-your-applications.md)

[Поиск потенциальных проблем с помощью анализаторов карт кода](../modeling/find-potential-problems-using-code-map-analyzers.md)

[Просмотр и реорганизация карт кода](../modeling/browse-and-rearrange-code-maps.md)
