---
title: Просмотр потоков в отладчике | Документация Майкрософт
description: Использование окна "Потоки" для проверки потоков и управления ими. Вы можете группировать, сортировать, помечать, замораживать, размораживать и искать потоки, выбирать столбцы, а также отображать стеки вызовов.
ms.custom: SEO-VS-2020
ms.date: 10/29/2018
ms.topic: conceptual
f1_keywords:
- vs.debug.threads
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- threading [Visual Studio], debugging
- Thread.Name property
- debugger, Threads window
- SetThreadName function
- Threads window
- '@TIB'
- debugging [Visual Studio], threads
ms.assetid: 590ffd57-0556-43d8-8962-ee27e5b2b7d7
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: cd11e722886b77e9faaace768cc30a74c759903f
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99884212"
---
# <a name="view-threads-in-the-visual-studio-debugger-by-using-the-threads-window-c-visual-basic-c"></a>Просмотр потоков в отладчике Visual Studio с помощью окна потоков (C#, Visual Basic, C++)
В окне **Потоки** можно проверять потоки и работать с ними в отлаживаемом приложении. Пошаговые инструкции по использованию **окна потоков** см. в разделе [Пошаговое руководство. Отладка с помощью окна потоков](../debugger/how-to-use-the-threads-window.md).

## <a name="use-the-threads-window"></a>Использование окна потоков
 В окне **Потоки** имеется таблица, каждая строка которой описывает отдельный поток в приложении. По умолчанию в таблице перечисляются все потоки приложения, но можно фильтровать этот список, чтобы в нем показывались только нужные потоки. В каждом столбце содержится свой тип сведений. Можно также скрывать некоторые столбцы. Если отображаются все столбцы, то в них имеются следующие сведения (слева направо).

- **Флаг**. В этом непомеченном столбце можно пометить поток, которому планируется уделить особое внимание. Сведения о способе пометки потока см. в разделе [Практическое руководство. Установка и снятие отметки для потоков](../debugger/how-to-flag-and-unflag-threads.md).

- **Текущий поток**. В этом столбце без метки желтая стрелка указывает текущий поток. Контур стрелки указывает текущий контекст отладчика для потока, отличного от текущего.

- **Идентификатор**. Отображает идентификационный номер для каждого потока.

- **Управляемый ИД**. Отображает управляемый идентификационный номер для каждого управляемого потока.

- **Категория**: Отображает категорию потоков: потоки пользовательского интерфейса, обработчики удаленного вызова процедур и рабочие потоки. Особая категория идентифицирует главный поток приложения.

- **Имя**: Указывает каждый поток по имени, если оно имеется, или значение \<No Name>.

- **Расположение.** Показывает, где работает поток. Можно развернуть это расположение, чтобы отобразить полный стек вызова для потока.

- **Приоритет**. Расширенный столбец (скрытый по умолчанию), отображающий приоритет, назначенный системой каждому потоку.

- **Маска сходства**. Расширенный столбец (скрытый по умолчанию), который показывает маску сходства процессоров для каждого потока. В многопроцессорной системе маска сходства определяет, какой процессор в каком потоке может работать.

- **Счетчик приостановок**. Расширенный столбец (скрытый по умолчанию), отображающий счетчик приостановок. Этот счетчик определяет, может ли поток выполняться. Дополнительные сведения о счетчиках приостановок см. в разделе [Замораживание и размораживание потоков](#freeze-and-thaw-threads).

- **Имя процесса**. Расширенный столбец (скрытый по умолчанию), отображающий процесс, к которому относится каждый поток. Данные в этом столбце могут быть полезны при отладке большого количества процессов.

- **Идентификатор процесса**. Расширенный столбец (скрытый по умолчанию), отображающий идентификатор процесса, к которому относится каждый поток.

- **Квалификатор транспорта**. Расширенный столбец (скрытый по умолчанию), однозначно определяющий компьютер, к которому подключен отладчик.

### <a name="to-display-the-threads-window-in-break-mode-or-run-mode"></a>Открытие окна потоков в режиме приостановки или в режиме выполнения

- Пока Visual Studio находится в режиме отладки, выберите меню **Отладка**, наведите указатель мыши на пункт **Windows**, а затем выберите **Потоки**.

### <a name="to-display-or-hide-a-column"></a>Отображение или скрытие столбца

- На панели инструментов, находящейся в верхней части окна **Потоки**, выберите **Столбцы**. Затем выберите или очистите имя столбца, который необходимо отобразить или скрыть.

## <a name="display-flagged-threads"></a>Отобразить только помеченные потоки
 Поток, которому планируется уделить особое внимание, можно пометить, поставив рядом с ним значок в окне **Потоки**. Дополнительные сведения см. в разделе [Практическое руководство. устанавливать и снимать отметки для потока](../debugger/how-to-flag-and-unflag-threads.md). В окне **Потоки** можно выбрать отображение всех потоков или только помеченных потоков.

### <a name="to-display-only-flagged-threads"></a>Отображение только помеченных потоков

- Выберите **Показывать только помеченные потоки** на панели инструментов в верхней части окна **Потоки**. (Если вариант недоступен, сначала необходимо пометить некоторые потоки.)

## <a name="freeze-and-thaw-threads"></a>Замораживание и размораживание потоков
 Если поток заморожен, то система не начнет его выполнение, даже если будут доступны все ресурсы.

 В машинном коде потоки могут быть приостановлены или возобновлены путем вызова функций Windows `SuspendThread` и `ResumeThread`. Или вызовите функции MFC [CWinThread::SuspendThread](/cpp/mfc/reference/CWinThread-class#suspendthread) и [CWinThread::ResumeThread](/cpp/mfc/reference/CWinThread-class#resumethread). Если вы вызываете `SuspendThread` или `ResumeThread`, будет изменен *счетчик приостановок* в окне **Потоки**. Счетчик приостановок не меняется при замораживании или размораживании собственного потока. В машинном коде поток не может выполняться, пока он не будет разморожен, а счетчик приостановок не будет равен нулю.

 В управляемом коде счетчик приостановок изменяется при замораживании или размораживании потока. Если вы заморозите поток в управляемом коде, его счетчик приостановок будет равен 1. При замораживании потока в машинном коде его счетчик приостановок равен 0, если только не использовался вызов `SuspendThread`.

> [!NOTE]
> При отладке вызова управляемого кода из машинного кода управляемый код выполняется в том же физическом потоке, что и вызывающий его машинный код. Приостановка выполнения или замораживание присущего данному объекту кода приводит также к замораживанию управляемого кода.

### <a name="to-freeze-or-thaw-execution-of-a-thread"></a>Заморозка и разморозка выполнения потока

- На панели инструментов, находящейся в верхней части окна **Потоки**, нажмите **Заморозить потоки** или **Разморозить потоки**.

     Это действие влияет только на потоки, выбранные в окне **Потоки**.

### <a name="switch-to-another-thread"></a>Переключение на другой поток

Желтая стрелка указывает текущий поток (и размещение указателя выполнения). Зеленая стрелка с загнутым наконечником указывает, что поток, не являющийся текущим, имеет текущий контекст отладчика.

#### <a name="to-switch-to-another-thread"></a>Переключение на другой поток

- Выполните одно из следующих действий:

  - Дважды щелкните любой поток.

  - Щелкните правой кнопкой мыши поток и выберите пункт **Переключиться на поток**.

## <a name="group-and-sort-threads"></a>Группирование и сортировка потоков
 При группировании потоков в таблице появляется заголовок для каждой группы. В заголовке содержится описание группы, например **Рабочие потоки** или **Непомеченные потоки**, и элемент управления "Дерево". Потоки-элементы каждой группы отображаются под заголовком группы. Если требуется скрыть потоки-элементы в какой-либо группе, можно свернуть эту группу с помощью элемента управления "Дерево".

 Поскольку группирование имеет приоритет перед сортировкой, можно, например, группировать потоки по категориям, а затем по идентификаторам внутри каждой категории.

### <a name="to-sort-threads"></a>Сортировка потоков

1. На панели инструментов, находящейся в верхней части окна **Потоки**, нажмите кнопку в верхней части любого столбца.

     Теперь потоки отсортированы по значениям в этом столбце.

2. Если требуется изменить порядок сортировки, нажмите кнопку еще раз.

     Потоки, которые отображались вверху списка, теперь отображаются внизу.

### <a name="to-group-threads"></a>Группирование потоков

- На панели инструментов окна **Потоки** нажмите список **Группировать по**, а затем выберите критерий, по которому требуется группировать потоки.

### <a name="to-sort-threads-within-groups"></a>Сортировка потоков в группах

1. На панели инструментов в верхней части окна **Потоки** нажмите список **Группировать по**, а затем выберите критерий, по которому требуется группировать потоки.

2. В окне **Потоки** нажмите кнопку в верхней части любого столбца.

     Теперь потоки отсортированы по значениям в этом столбце.

### <a name="to-expand-or-collapse-all-groups"></a>Сворачивание и разворачивание всех групп

- На панели инструментов в верхней части окна **Потоки**, нажмите **Развернуть группы** или **Свернуть группы**.

## <a name="search-for-specific-threads"></a>Поиск конкретных потоков
 В окне **Потоки** можно искать потоки, соответствующие указанной строке. При поиске потоков в окне отображаются все потоки, в одном из столбцов которых найдено соответствие строке поиска. Эти сведения включают расположение потока, которое отображается вверху стека вызова в столбце **Расположение**. По умолчанию поиск в полном стеке вызовов не выполняется.

### <a name="to-search-for-specific-threads"></a>Поиск конкретных потоков

1. В панели инструментов, находящейся в верхней части окна **Потоки**, перейдите в поле **Поиск** и выполните одно из следующих действий:

     - введите строку поиска и нажмите клавишу **ВВОД**

     \- или -

     - нажмите раскрывающийся список рядом с полем **Поиск** и выберите строку поиска из предыдущего поиска.

2. Чтобы включить в поиск полный стек вызова, выберите **Поиск в стеке вызова** (необязательно).

## <a name="display-thread-call-stacks-and-switch-between-frames"></a>Отображение стека вызовов потоков и переключение между фреймами
В многопотоковых программах каждый поток имеет свой собственный стек вызовов. Окно **Потоки** обеспечивает удобный способ просмотра этих стеков.

> [!TIP]
> Для визуального представления стека вызовов для каждого потока используйте окно [Параллельные стеки](../debugger/get-started-debugging-multithreaded-apps.md).

### <a name="to-view-the-call-stack-of-a-thread"></a>Просмотр стека вызовов потока

- В столбце **Расположение** нажмите перевернутый треугольник рядом с расположением потока.

     Расположение будет развернуто, и будет отображен стек вызова для потока.

### <a name="to-view-or-collapse-the-call-stacks-of-all-threads"></a>Просмотр и сворачивание стеков вызовов всех потоков

- На панели инструментов, которая находится в верхней части окна **Потоки**, нажмите **Развернуть стеки вызовов** или **Свернуть стеки вызовов**.

## <a name="see-also"></a>См. также
- [Отладка многопоточных приложений](../debugger/debug-multithreaded-applications-in-visual-studio.md)
- [Начало отладки многопоточных приложений](../debugger/get-started-debugging-multithreaded-apps.md)
