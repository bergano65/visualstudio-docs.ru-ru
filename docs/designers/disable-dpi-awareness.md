---
title: Отключение поддержки DPI в Visual Studio
description: В этой статье рассматриваются ограничения конструктора Windows Forms на HDPI-мониторах и приводятся сведения о запуске Visual Studio без поддержки DPI.
ms.date: 09/28/2020
author: TerryGLee
ms.author: tglee
manager: jmartens
ms.topic: conceptual
ms.openlocfilehash: f63d831127951815f28955e72ae29b1a4d7f5a3e
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99917094"
---
# <a name="disable-dpi-awareness-in-visual-studio"></a>Отключение поддержки DPI в Visual Studio

Visual Studio — это приложение с поддержкой DPI, что означает автоматическое масштабирование монитора. Если в приложении указано, что оно не поддерживает DPI, операционная система масштабирует приложение в виде точечного рисунка. Такое поведение также называется виртуализацией DPI. Приложение по-прежнему считает, что работает в полном масштабе (100 % соответствует 96 точкам на дюйм).

В этой статье рассматриваются ограничения конструктора Windows Forms на HDPI-мониторах и приводятся сведения о запуске Visual Studio без поддержки DPI.

## <a name="windows-forms-designer-on-hdpi-monitors"></a>Конструктор Windows Forms на HDPI-мониторах

**Конструктор Windows Forms** в Visual Studio не поддерживает масштабирование. Поэтому при открытии некоторых форм в **конструкторе Windows Forms** возникают проблемы с отображением на HDPI-мониторах. Например, элементы управления могут перекрываться, как показано на следующем рисунке:

![Конструктор Windows Forms на HDPI-мониторе](./media/win-forms-designer-hdpi.png)

Когда вы открываете форму в **конструкторе Windows Forms** в Visual Studio на HDPI-мониторе, в верхней части конструктора отображается желтая информационная панель.

![Информационная панель в Visual Studio для перезапуска без поддержки DPI](./media/scaling-gold-bar.png)

На панели выводится сообщение: **Масштаб основного дисплея равен 200 % (192 DPI). Это может вызвать проблемы c отображением в окне конструктора**.

> [!NOTE]
> Эта информационная панель появилась в Visual Studio 2017 версии 15.8.

Если вы не работаете в конструкторе и вам не нужно настраивать макет формы, игнорируйте информационную панель и продолжайте использовать редактор кода или конструкторы других типов. (Можно также [отключить уведомления](#disable-notifications), чтобы информационная панель больше не появлялась.) Затрагивается только **конструктор Windows Forms**. Чтобы продолжить работу в **конструкторе Windows Forms**, выполните приведенные в следующем разделе действия по [устранению этой проблемы](#to-resolve-the-display-problem).

## <a name="to-resolve-the-display-problem"></a>Устранение проблемы с отображением

Существует три варианта устранения проблемы с отображением.

- [Перезапуск Visual Studio без поддержки DPI](#restart-visual-studio-as-a-dpi-unaware-process)
- [Добавление записи реестра](#add-a-registry-entry)
- [Установка параметра масштаба дисплея равным 100 %](#set-your-display-scaling-setting-to-100)

> [!TIP]
> Если вы предпочитаете управлять параметрами из командной строки, [`devenv.exe`](../ide/reference/devenv-command-line-switches.md) принимает `/noscale` в качестве параметра командной строки для выполнения в режиме с масштабом 100 %.

### <a name="restart-visual-studio-as-a-dpi-unaware-process"></a>Перезапуск Visual Studio без поддержки DPI

Чтобы перезапустить Visual Studio без поддержки DPI, выберите соответствующий параметр на желтой информационной панели. Это предпочтительный способ решения проблемы.

После запуска Visual Studio без поддержки DPI проблемы с макетом конструктора будут устранены, но шрифты могут выглядеть размытыми. Если Visual Studio работает без поддержки DPI, выводится другое желтое информационное сообщение: **Visual Studio выполняется без поддержки DPI. Конструкторы WPF и XAML могут отображаться некорректно**. На информационной панели также доступен параметр **Перезапустить Visual Studio с поддержкой DPI**.

> [!NOTE]
> - Если при выборе параметра перезапуска без поддержки DPI в Visual Studio были незакрепленные окна инструментов, положение этих окон инструментов может измениться.
> - Если используется профиль Visual Basic по умолчанию или в меню **Сервис** > **Параметры** > **Проекты и решения** не выбран параметр **Сохранять новые проекты в момент создания**, Visual Studio не сможет повторно открыть проект, перезапускаемый без поддержки DPI. Однако проект можно открыть, выбрав его в разделе **Файл** > **Последние проекты и решения**.

По завершении работы в **конструкторе Windows Forms** необходимо обязательно перезапустить Visual Studio с поддержкой DPI. При запуске без поддержки DPI шрифты могут выглядеть размытыми, а в других конструкторах, таких как **конструктор XAML**, могут возникать проблемы. Если закрыть и повторно открыть среду Visual Studio, запущенную без поддержки DPI, она снова будет поддерживать DPI. Можно также выбрать параметр **Перезапустить Visual Studio как процесс с поддержкой DPI** на информационной панели.

### <a name="add-a-registry-entry"></a>Добавление записи реестра

Вы можете пометить Visual Studio без поддержки DPI, изменив реестр. Откройте **редактор реестра** и добавьте запись в подраздел **HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers**:

**Запись**: В зависимости от версии Visual Studio — 2017 или 2019 — используйте одно из следующих значений:

- C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\devenv.exe
- C:\Program Files (x86)\Microsoft Visual Studio\2019\Community\Common7\IDE\devenv.exe

> [!NOTE]
> Если вы используете выпуск Professional или Enterprise, в записи замените **Community** на **Professional** или **Enterprise**. При необходимости замените букву диска.

**Тип:** REG_SZ

**Значение**. DPIUNAWARE

> [!NOTE]
> Visual Studio останется в режиме без поддержки DPI до удаления записи реестра.

### <a name="set-your-display-scaling-setting-to-100"></a>Установка параметра масштаба дисплея равным 100 %

Чтобы в Windows 10 задать параметр масштаба дисплея равным 100 %, в поле поиска на панели задач введите **параметры дисплея**, а затем выберите **Изменить параметры дисплея**. В окне **Параметры** задайте параметру **Изменить размер текста, приложений и других элементов** значение **100 %** .

Масштаб дисплея, равный 100 %, может быть нежелателен, так как пользовательский интерфейс может отображаться слишком мелко.

## <a name="disable-notifications"></a>Отключение уведомлений

Вы можете отказаться от вывода уведомлений о проблемах масштабирования DPI в Visual Studio. Если вы не работаете в конструкторе, уведомления можно отключить.

Для этого выберите **Сервис** > **Параметры**. Откроется диалоговое окно **Параметры**. Затем выберите **Конструктор Windows Forms** > **Общие** и задайте параметру **Уведомления о масштабировании DPI** значение **False**.

![Параметр "Уведомления о масштабировании DPI" в Visual Studio](./media/notifications-option.png)

Чтобы позднее повторно включить уведомления об масштабировании, задайте свойству значение **True**.

## <a name="troubleshoot"></a>Устранение неполадок

Если переход с поддержкой DPI не работает в Visual Studio должным образом, проверьте наличие значения `dpiAwareness` в подразделе **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\devenv.exe** в редакторе реестра. Удалите значение, если оно там есть.

## <a name="see-also"></a>См. также

- [Автоматическое масштабирование в Windows Forms](/dotnet/framework/winforms/automatic-scaling-in-windows-forms)
