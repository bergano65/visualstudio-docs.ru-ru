---
title: API нагрузочного теста
description: Узнайте, как использовать API нагрузочного теста, поддерживающий подключаемые модули теста, которые могут управлять нагрузочными тестами и улучшать их.
ms.custom: SEO-VS-2020
ms.date: 10/19/2016
ms.topic: how-to
helpviewer_keywords:
- code, load tests
- plug-ins, load test
- APIs, load tests
ms.assetid: e15567bc-1f21-4feb-b81d-f17ba35cfde5
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.openlocfilehash: 281e64f83766b6b42dd9f076726c429c9432245b
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99879557"
---
# <a name="how-to-use-the-load-test-api"></a>Практическое руководство. Использование API-интерфейса нагрузочного теста

Visual Studio поддерживает подключаемые модули нагрузочных тестов, которые могут управлять нагрузочными тестами или расширять их возможности. Подключаемые модули нагрузочных тестов представляют собой пользовательские классы, которые реализуют интерфейс <xref:Microsoft.VisualStudio.TestTools.LoadTesting.ILoadTestPlugin>, содержащийся в пространстве имен <xref:Microsoft.VisualStudio.TestTools.LoadTesting>. Подключаемые модули нагрузочных тестов позволяют осуществлять пользовательское управление нагрузочными тестами, например прерывать выполнение теста при достижении порога счетчиков или ошибок. Чтобы получить или установить параметры нагрузочного теста из пользовательского кода, используйте свойства класса <xref:Microsoft.VisualStudio.TestTools.LoadTesting.LoadTest>. Чтобы присоединить делегаты для отправки уведомлений при выполнении нагрузочного теста, используйте события класса <xref:Microsoft.VisualStudio.TestTools.LoadTesting.LoadTest>.

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

> [!TIP]
> Для просмотра пространства имен <xref:Microsoft.VisualStudio.TestTools.LoadTesting> используется обозреватель объектов. Редакторы Visual C# и Visual Basic предоставляют поддержку IntelliSense для создания кода с помощью классов из этого пространства имен.

Можно также создавать подключаемые модули для веб-тестов производительности. Дополнительные сведения см. в разделе [Практическое руководство. Создание подключаемого модуля веб-теста производительности](../test/how-to-create-a-web-performance-test-plug-in.md) и [Практическое руководство. Создание подключаемого модуля уровня запроса](../test/how-to-create-a-request-level-plug-in.md).

## <a name="to-use-the-loadtesting-namespace"></a>Использование пространства имен LoadTesting

1. Откройте проект веб-тестов производительности и нагрузочных тестов, содержащий нагрузочный тест.

2. Добавьте проект библиотеки классов Visual C# или Visual Basic в тестовое решение.

3. Добавьте ссылку на проект библиотеки классов в проект веб-тестов производительности и нагрузочных тестов.

4. Добавьте ссылку на DLL-библиотеку Microsoft.VisualStudio.QualityTools.LoadTestFramework в проект библиотеки классов.

5. В файл класса, расположенный в проекте библиотеки классов, добавьте оператор `using` для пространства имен <xref:Microsoft.VisualStudio.TestTools.LoadTesting>.

6. Создайте открытый класс, реализующий интерфейс <xref:Microsoft.VisualStudio.TestTools.LoadTesting.ILoadTestPlugin>.

7. Выполните построение проекта.

8. Добавьте новый подключаемый модуль нагрузочных тестов с помощью редактора тестовой нагрузки:

    1. Щелкните правой кнопкой мыши корневой узел нагрузочного теста и выберите команду **Добавить подключаемый модуль нагрузочных тестов**.

    2. Откроется диалоговое окно **Добавить подключаемый модуль нагрузочных тестов**.

    3. В области **Свойства выбранного подключаемого модуля** задайте начальные значения для подключаемого модуля, которые будут использоваться во время выполнения.

        > [!NOTE]
        > С помощью подключаемых модулей можно предоставить доступ к произвольному количеству свойств. Их необходимо сделать общедоступными, задаваемыми и относящимися к базовому типу, например к целочисленному, логическому или строковому. Кроме того, свойства подключаемого модуля нагрузочных тестов можно изменить позже в окне **Свойства**.

9. Запустите нагрузочный тест.

     Реализацию интерфейса <xref:Microsoft.VisualStudio.TestTools.LoadTesting.ILoadTestPlugin> см. в разделе [Практическое руководство. Создание подключаемого модуля нагрузочных тестов](../test/how-to-create-a-load-test-plug-in.md).

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualStudio.TestTools.LoadTesting>
- [Создание пользовательского кода и подключаемых модулей для нагрузочных тестов](../test/create-custom-code-and-plug-ins-for-load-tests.md)
- [Практическое руководство. Использование интерфейса API веб-теста производительности](../test/how-to-use-the-web-performance-test-api.md)
- [Практическое руководство. Создание подключаемого модуля нагрузочных тестов](../test/how-to-create-a-load-test-plug-in.md)
