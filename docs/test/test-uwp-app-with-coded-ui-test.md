---
title: Тестирование приложения UWP с помощью закодированного теста пользовательского интерфейса
description: Узнайте, как создать закодированный тест пользовательского интерфейса для приложения универсальной платформы Windows, создав приложение UWP для тестирования и создания закодированного теста пользовательского интерфейса.
ms.custom: SEO-VS-2020
ms.date: 05/31/2018
ms.topic: how-to
author: mikejo5000
ms.author: mikejo
manager: jmartens
dev_langs:
- CSharp
- VB
ms.workload:
- uwp
ms.openlocfilehash: 0fb60de87fa98e4715d872512c120a408ec8339e
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99911511"
---
# <a name="create-a-coded-ui-test-to-test-a-uwp-app"></a>Создание закодированного теста пользовательского интерфейса для тестирования приложения UWP

В этой статье описывается создание закодированного теста пользовательского интерфейса для приложения универсальной платформы Windows (UWP).

[!INCLUDE [coded-ui-test-deprecation](includes/coded-ui-test-deprecation.md)]

## <a name="create-a-uwp-app-to-test"></a>Создание приложения UWP для тестирования

Первым шагом является создание простого приложения UWP для выполнения теста.

1. В Visual Studio создайте проект UWP с помощью шаблона **Пустое приложение (универсальное приложение)** для Visual C# или Visual Basic.

   ::: moniker range="vs-2017"

   ![Пустое приложение (универсальное приложение Windows)](../test/media/blank-uwp-app-template.png)

   ::: moniker-end

1. В диалоговом окне **Новый проект универсальной платформы Windows** нажмите кнопку **ОК**, чтобы принять версию платформы по умолчанию.

1. В **обозревателе решений** выберите файл *MainPage.xaml*.

   Файл откроется в **конструкторе XAML**.

1. Перетащите элемент управления "Кнопка" и "Текстовое поле" из **панели инструментов** на поверхность разработки.

     ![Проектирование приложения UWP](../test/media/toolbox-controls.png)

1. Присвойте имена элементам управления. Выберите элемент управления "Текстовое поле", а затем в окне **Свойства** введите **textBox** в поле **Имя**. Выберите элемент управления "Кнопка", а затем в окне **Свойства** введите **button** в поле **Имя**.

1. Дважды щелкните элемент управления "Кнопка" и добавьте следующий код в тело метода `Button_Click`. Этот код задает текст в текстовом поле, соответствующий имени элемента управления "Кнопка", исключительно в целях проверки с помощью закодированного теста пользовательского интерфейса, который мы создадим позже.

   ```csharp
   this.textBox.Text = this.button.Name;
   ```

   ```vb
   Me.textBox.Text = Me.button.Name
   ```

1. Нажмите клавишу **Ctrl**+**F5** для запуска приложения. Вы должны увидеть нечто вроде этого:

   ![Приложение UWP с кнопкой и текстовым полем](media/uwp-app.png)

## <a name="create-a-coded-ui-test"></a>Создание закодированного теста пользовательского интерфейса

1. Чтобы добавить тестовый проект в решение, в **обозревателе решений** щелкните решение правой кнопкой мыши и выберите пункты **Добавить** > **Новый проект**.

1. Найдите и выберите шаблон **Проект закодированного теста пользовательского интерфейса (универсальное приложение для Windows)**.

   ::: moniker range="vs-2017"

   ![Новый проект закодированного теста пользовательского интерфейса](../test/media/coded-ui-test-project-uwp-template.png)

   ::: moniker-end

   > [!NOTE]
   > Если вы не видите шаблон **Проект закодированного теста пользовательского интерфейса (универсальное приложение для Windows)**, необходимо [установить компонент закодированного теста пользовательского интерфейса](../test/use-ui-automation-to-test-your-code.md#install-the-coded-ui-test-component).

1. В диалоговом окне **Формирование кода для кодированного теста пользовательского интерфейса** выберите **Редактировать тест вручную**.

   ![Диалоговое окно "Формирование кода для кодированного теста пользовательского интерфейса"](../test/media/manually-edit-the-test.png)

1. Если приложение UWP еще не запущено, запустите его, нажав клавишу **Ctrl**+**F5**.

1. Откройте диалоговое окно **построитель кодированных тестов ИП**, поместив курсор в метод `CodedUITestMethod1`, а затем выбрав **Тест** > **Сформировать код для кодированного теста ИП** > **Использовать построитель кодированных тестов ИП**.

1. Добавьте элементы управления на карту элементов управления пользовательского интерфейса. Используйте перекрестье **построителя кодированных тестов ИП**, чтобы выбрать элемент управления "Кнопка" в приложении UWP. В диалоговом окне **Добавление утверждений** при необходимости разверните область **Карта элементов управления ИП**, а затем выберите **Добавить элемент управления на карту элементов управления пользовательского интерфейса**.

     ![Добавление элемента на карту ИП](../test/media/add-control-to-ui-control-map.png)

1. Повторите этот шаг, чтобы добавить элемент управления "Текстовое поле" на карту ИП.

1. В диалоговом окне **Построитель кодированных тестов ИП** выберите **Сформировать код** или нажмите клавиши **Ctrl**+**G**. Затем нажмите кнопку **Сформировать**, чтобы создать код для изменений карты элементов управления ИП.

     ![Формирование кода для карты ИП](../test/media/generate-code-dialog.png)

1. Чтобы убедиться, что текст в текстовом поле меняется на **button** при нажатии кнопки, нажмите кнопку.

     ![Нажмите элемент управления "кнопка", чтобы задать значение текстового поля](../test/media/uwp-app-button-textbox.png)

1. Добавьте утверждение для проверки текста в элементе управления "Текстовое поле". С помощью перекрестья выберите текстовое поле, а затем свойство **Text** в диалоговом окне **Добавление утверждений**. Выберите **Добавить утверждение** или нажмите клавиши **Alt**+**A**. В поле **Сообщение о сбое проверочного утверждения** введите **Непредвиденное значение текстового поля**. Затем нажмите кнопку **ОК**.

     ![Выбор текстового поля с помощью перекрестья и добавление утверждения](../test/media/add-assertion-for-text.png)

1. Сформируйте тестовый код для утверждения. В диалоговом окне **Построитель кодированных тестов ИП** выберите **Сформировать код**. В диалоговом окне **Сформировать код** выберите **Добавить и сформировать**.

     ![Формирование кода для утверждения текстового поля](../test/media/add-and-generate-assert-method.png)

   В **обозревателе решений** откройте файл *UIMap.Designer.cs*, чтобы просмотреть добавленный код для метода assert и элементов управления.

   > [!TIP]
   > Если вы используете Visual Basic, откройте *CodedUITest1.vb*. Затем в коде метода теста `CodedUITestMethod1()` щелкните правой кнопкой мыши вызов метода assert `Me.UIMap.AssertMethod1()` и выберите **Перейти к определению**. Файл *UIMap.Designer.vb* откроется в редакторе кода, где вы сможете просмотреть код, добавленный для метода assert и элементов управления.

    > [!WARNING]
    > Не изменяйте файлы *UIMap.designer.cs* или *UIMap.Designer.vb* напрямую. В противном случае ваши изменения будут перезаписаны при создании теста.

    Метод assert выглядит следующим образом:

    ```csharp
    public void AssertMethod1()
    {
        #region Variable Declarations
        XamlEdit uITextBoxEdit = this.UIUWPAppWindow.UITextBoxEdit;
        #endregion

        // Verify that the 'Text' property of 'textBox' text box equals 'button'
        Assert.AreEqual(this.AssertMethod1ExpectedValues.UITextBoxEditText, uITextBoxEdit.Text, "Textbox value is unexpected.");
    }
    ```

    ```vb
    Public Sub AssertMethod1()
        Dim uITextBoxEdit As XamlEdit = Me.UIApp2Window.UITextBoxEdit

        'Verify that the 'Text' property of 'textBox' text box equals 'button'
        Assert.AreEqual(Me.AssertMethod1ExpectedValues.UITextBoxEditText, uITextBoxEdit.Text, "Textbox value is unexpected.")
    End Sub
    ```

1. Затем нам нужно получить **AutomationId** из тестируемого [приложения](#create-a-uwp-app-to-test) UWP. Откройте меню **Пуск** Windows, чтобы увидеть плитку приложения. Затем перетащите перекрестье ![Целевой значок](media/target-icon.png) из диалогового окна **Построитель кодированных тестов ИП** в плитку для приложения. Когда вокруг плитки появится голубая рамка, отпустите кнопку мыши.

   ![Инструмент "Перекрестие"](media/cross-hair-tool.png)

   Откроется диалоговое окно **Добавление утверждений**, в котором будет отображаться значение **AutomationId** для вашего приложения. Щелкните правой кнопкой мыши элемент **AutomationId** и выберите **Скопировать значение в буфер обмена**.

   ![AutomationID в диалоговом окне "Добавление утверждений"](../test/media/automation-id.png)

1. Добавьте код в метод теста, чтобы запустить приложение UWP. В **обозревателе решений** откройте файл *CodedUITest1.cs* или *CodedUITest1.vb*. Над вызовом `AssertMethod1` добавьте код для запуска приложения UWP:

   ```csharp
   XamlWindow.Launch("af5ecd75-f252-45a1-9e7e-c6f1d8f054ff_0q1pp7qrjexbp!App")
   ```

   ```vb
   XamlWindow myAppWindow = XamlWindow.Launch("af5ecd75-f252-45a1-9e7e-c6f1d8f054ff_0q1pp7qrjexbp!App");
   ```

   Замените код автоматизации в примере кода значением, скопированным в буфер обмена в предыдущем шаге.

   > [!IMPORTANT]
   > Усеките начало кода автоматизации, чтобы удалить такие символы, как **P~**. Если не удалить эти символы, тест создает исключение `Microsoft.VisualStudio.TestTools.UITest.Extension.PlaybackFailureException` при попытке запустить приложение.

1. Затем добавьте код в метод теста, чтобы нажать кнопку. В строку, следующую за `XamlWindow.Launch`, добавьте жест касания кнопки:

   ```csharp
   Gesture.Tap(this.UIMap.UIUWPAppWindow.UIButtonButton);
   ```

   ```vb
   Gesture.Tap(Me.UIMap.UIUWPAppWindow.UIButtonButton)
   ```

   После добавления кода полный метод теста `CodedUITestMethod1` должен выглядеть следующим образом:

   ```csharp
   [TestMethod]
   public void CodedUITestMethod1()
   {
       XamlWindow.Launch("af5ecd75-f252-45a1-9e7e-c6f1d8f054ff_0q1pp7qrjexbp!App");

       Gesture.Tap(this.UIMap.UIUWPAppWindow.UIButtonButton);

       // To generate code for this test, select "Generate Code for Coded UI Test" from the shortcut menu and select one of the menu items.
       this.UIMap.AssertMethod1();
   }
   ```

   ```vb
   <CodedUITest(CodedUITestType.WindowsStore)>
   Public Class CodedUITest1

       <TestMethod()>
       Public Sub CodedUITestMethod1()

           ' Launch the app.
           XamlWindow.Launch("af5ecd75-f252-45a1-9e7e-c6f1d8f054ff_0q1pp7qrjexbp!App")

           '// Tap the button.
           Gesture.Tap(Me.UIMap.UIUWPAppWindow.UIButtonButton)

           Me.UIMap.AssertMethod1()
       End Sub
   ```

1. Выполните сборку тестового проекта, а затем откройте **обозреватель тестов**, выбрав пункты **Тест** > **Windows** > **Обозреватель тестов**.

1. Выберите **Запустить все**, чтобы выполнить тест.

   Откроется приложение, кнопка будет нажата, а свойство **Text** текстового поля — заполнено. Метод assert проверяет свойство **Text** текстового поля.

   После завершения теста **обозреватель тестов** подтвердит, что тест был пройден.

   ![Пройденный тест отображается в обозревателе тестов](../test/media/test-explorer-coded-ui-test-passed.png)

## <a name="q--a"></a>Вопросы и ответы

### <a name="q-why-dont-i-see-the-option-to-record-my-coded-ui-test-in-the-generate-code-for-a-coded-ui-test-dialog"></a>В. Почему я не вижу параметр для записи закодированного теста пользовательского интерфейса в диалоговом окне "Создать код" или "Закодированный тест пользовательского интерфейса"?

**О**. Параметр записи не поддерживается для приложений универсальной платформы Windows.

### <a name="q-can-i-create-a-coded-ui-test-for-my-uwp-apps-based-on-winjs"></a>Вопрос. Можно ли создать закодированный тест пользовательского интерфейса для приложений универсальной платформы Windows, написанных на WinJS?

**Ответ**. Поддерживаются только приложения на XAML.

### <a name="q-why-cant-i-modify-the-code-in-the-uimapdesigner-file"></a>В. Почему не следует изменять файл UIMap.Designer?

**Ответ**. Любые изменения кода, внесенные в файл *UIMapDesigner.cs*, будут перезаписываться каждый раз при создании кода с помощью **построителя кодированных тестов ИП**. Если требуется изменить записанный метод, скопируйте его в файл *UIMap.cs* и переименуйте. Файл *UIMap.cs* можно использовать для переопределения методов и свойств в файле *UIMapDesigner.cs*. Удалите ссылку на исходный метод в файле *CodedUITest.cs* и замените ее именем переименованного метода.

## <a name="see-also"></a>См. также раздел

- [Использование автоматизации пользовательского интерфейса для тестирования кода](../test/use-ui-automation-to-test-your-code.md)
- [Назначение уникального свойства автоматизации элементам управления UWP](../test/set-a-unique-automation-property-for-windows-store-controls-for-testing.md)
