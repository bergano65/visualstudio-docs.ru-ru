---
title: Автоматизированные тесты пользовательского интерфейса
ms.date: 11/04/2016
ms.prod: visual-studio-dev15
ms.technology: vs-ide-test
ms.topic: conceptual
f1_keywords:
- vs.codedUITest
- vs.codedUITest.recorder
- vs.codedUITest.testbuilder
- vs.codedUITest.addAssertions
- vs.codedUITest.createdialog
helpviewer_keywords:
- automated tests, testing UI interface
- coded UI test
author: gewarren
ms.author: gewarren
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: f8831dd8af13d111db833fe46d685e9a6e3af767
ms.sourcegitcommit: 5b767247b3d819a99deb0dbce729a0562b9654ba
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/20/2018
ms.locfileid: "39177322"
---
# <a name="use-ui-automation-to-test-your-code"></a>Использование автоматизации пользовательского интерфейса для тестирования кода

Автоматизированные тесты пользовательского интерфейса приложений называются *закодированными тестами пользовательского интерфейса* в Visual Studio. Эти тесты обеспечивают функциональное тестирование элементов управления ИП. Они позволяют убедиться, что все приложение, в том числе интерфейс, работает правильно. Закодированные тесты ИП, в частности, полезны, если интерфейс содержит логику проверки или другую логику, например на веб-странице. Они также часто используются для автоматизации существующих ручных тестов.

Как показано на следующем рисунке, обычный процесс тестирования во время разработки может состоять из построения приложения и поочередной проверки элементов управления. Затем вы можете создать автоматический тест, чтобы не проверять приложение вручную. В зависимости от конкретной тестируемой функции можно написать код для функционального теста или интеграционного теста, который может содержать проверку на уровне ИП (или нет). Если вы хотите получить доступ к бизнес-логике, вы можете написать модульный тест. Однако в некоторых ситуациях может быть полезно включить тестирование различных элементов управления в приложение. Закодированный тест пользовательского интерфейса может проверять, влияет ли обработка кода на работу приложения.

![Тестирование во время разработки приложения](../test/media/cuit_overview.png)

Создать закодированный тест ИП легко. Просто выполните тест вручную, пока **построитель кодированных тестов ИП** работает в фоновом режиме. Вы также можете указать, какие значения должны быть в определенных полях. **Построитель кодированных тестов ИП** записывает ваши действия и создает на их основе код. После создания теста вы можете изменить последовательность действий в специальном редакторе.

Если у вас есть тестовый случай, записанный в Microsoft Test Manager, вы можете создать код на его основе. Дополнительные сведения см. в разделе [Запись и воспроизведение ручных тестов](/vsts/test/mtm/record-play-back-manual-tests).

Специализированные **построитель кодированных тестов ИП** и редактор упрощают создание и изменение закодированных тестов ИП, даже если вы больше разбираетесь в тестировании, а не программировании. Но если вы разработчик и хотите расширить возможности теста, вы легко сможете скопировать и адаптировать код, потому что он структурирован. Например, можно записать тест покупки какого-либо продукта на веб-сайте, а затем добавить в созданный код цикл для покупки множества продуктов.

**Требования**

- Visual Studio Enterprise
- Закодированный тест пользовательского интерфейса

Дополнительные сведения о платформах и конфигурациях, поддерживаемых закодированными тестами пользовательского интерфейса, см. в разделе [Поддерживаемые платформы](../test/supported-configurations-and-platforms-for-coded-ui-tests-and-action-recordings.md).

## <a name="install-the-coded-ui-test-component"></a>Установите компонент закодированного теста пользовательского интерфейса.

Для доступа к средствам и шаблонам закодированных тестов пользовательского интерфейса установите компонент **Закодированный тест пользовательского интерфейса** Visual Studio 2017.

1. Запустите **Visual Studio Installer**, выбрав **Сервис** > **Получить средства и компоненты**.

1. В приложении **Visual Studio Installer** перейдите на вкладку **Отдельные компоненты** и выполните прокрутку вниз до раздела **Отладка и тестирование**. Выберите компонент **Закодированный тест пользовательского интерфейса**.

   ![Закодированный тест пользовательского интерфейса](media/coded-ui-test-component.png)

1. Нажмите кнопку **Изменить**.

## <a name="create-a-coded-ui-test"></a>Создание закодированного теста пользовательского интерфейса

1. Создание проекта с закодированными тестом ИП

   Закодированные тесты ИП должны размещаться в проекте закодированного теста. Если вы не сделали этого ранее, создайте такой проект. Выберите **Файл** > **Создать** > **Проект**, чтобы открыть диалоговое окно **Создание проекта**. На панели категорий слева разверните элемент **Установленные** > **Visual Basic** *или* **Visual C#** > **Тест**. Выберите шаблон **Проект закодированных тестов пользовательского интерфейса** и нажмите кнопку **ОК**.

   ![Шаблон "Проект закодированных тестов пользовательского интерфейса" в диалоговом окне "Создание проекта"](media/coded-ui-test-project-template.png)

   > [!NOTE]
   > Если вы не видите шаблон **Проект закодированного теста пользовательского интерфейса**, необходимо [установить компонент закодированного теста пользовательского интерфейса](../test/use-ui-automation-to-test-your-code.md#install-the-coded-ui-test-component).

2. Добавьте файл закодированного теста ИП.

     Если вы только что создали проект, первый файл CUIT добавляется автоматически. Чтобы добавить другой файл теста, откройте контекстное меню для проекта закодированного теста пользовательского интерфейса в **обозревателе решений** и выберите команду **Добавить** > **Закодированный тест пользовательского интерфейса**.

     В диалоговом окне **Формирование кода для кодированного теста пользовательского интерфейса** выберите пункт **Записать действия, изменить карту ИП или добавить утверждения**.

     ![Диалоговое окно "Формирование кода для кодированного теста пользовательского интерфейса"](media/generate-code-for-coded-ui-test.png)

     Отображается окно "Построитель кодированных тестов ИП".

     ![Построитель кодированных тестов пользовательского интерфейса](../test/media/codedui_testbuilder.png)

3. Запись последовательности действий.

     **Чтобы начать запись**, щелкните значок **Запись**. Выполните действия, которые необходимо протестировать в приложении, в том числе запустите приложение, если это необходимо. Например, если вы тестируете веб-приложение, можно запустить браузер, перейти к веб-сайту и войти в приложение.

     **Чтобы приостановить запись**, например если вы работаете с входящей почтой, выберите **Приостановить**.

    > [!WARNING]
    > Все действия, выполненные на рабочем столе, будут записаны. Приостановите запись, если вы выполняете действия, которые могут привести к записи конфиденциальных данных.

     **Чтобы удалить действия**, записанные по ошибке, нажмите кнопку **Изменить шаги**.

     **Чтобы создать код**, который будет повторять ваши действия, щелкните значок **Создать код** и введите имя и описание метода закодированного теста пользовательского интерфейса.

4. Проверка значений в полях пользовательского интерфейса, например в текстовых полях.

     Щелкните **Добавить утверждения** в построителе закодированных тестов пользовательского интерфейса, а затем выберите элемент управления в запущенном приложении. В списке свойств выберите свойство, например **Текст** в текстовом поле. В контекстном меню щелкните **Добавить утверждение**. В диалоговом окне выберите оператор сравнения, значение сравнения и сообщение об ошибке.

     Закройте окно утверждения и щелкните **Создать код**.

     ![Целевой элемент закодированного теста пользовательского интерфейса](../test/media/codedui_1.png)

    > [!TIP]
    > Переключайтесь между записью действий и проверкой значений. Создайте код в конце каждой последовательности действий или проверок. При необходимости вы сможете вставить новые действия и проверки позже.

     Дополнительные сведения см. в разделе [Проверка свойств элементов управления](#validate-the-properties-of-ui-controls).

5. Просмотр созданного кода теста.

     Для просмотра созданного кода закройте окно построителя кодированных тестов ИП. В коде можно увидеть имена, которые вы присвоили каждому шагу. Код содержится в созданном файле CUIT:

    ```csharp
    [CodedUITest]
    public class CodedUITest1
    { ...
      [TestMethod]
      public void CodedUITestMethod1()
      {
          this.UIMap.AddTwoNumbers();
          this.UIMap.VerifyResultValue();
          // To generate more code for this test, select
          // "Generate Code" from the shortcut menu.
      }
    }
    ```

6. Добавление действий и утверждений.

   Наведите указатель на соответствующую точку в методе теста и затем в контекстном меню выберите команду **Сформировать код для закодированного теста пользовательского интерфейса**. В этой точке будет вставлен новый код.

7. Изменение действий и утверждений теста.

     Откройте файл UIMap.uitest. Он откроется в редакторе закодированных тестов ИП, где вы сможете изменить любую записанную последовательность действий, а также утверждения.

     ![Редактор закодированных тестов пользовательского интерфейса](../test/media/cuit_editor_edit.png)

     Дополнительные сведения см. в разделе [Изменение закодированных тестов пользовательского интерфейса с помощью редактора закодированных тестов пользовательского интерфейса](../test/editing-coded-ui-tests-using-the-coded-ui-test-editor.md).

8. Запустите тест.

   Откройте обозреватель тестов или контекстное меню в методе теста и выберите пункт **Выполнить тесты**. Дополнительные сведения о запуске тестов см. в подразделах [Выполнение модульных тестов с помощью обозревателя тестов](../test/run-unit-tests-with-test-explorer.md) и *Дополнительные параметры для запуска закодированных тестов пользовательского интерфейса* раздела [Дальнейшие действия](#what's-next?) в конце этой статьи.

Эта процедура более подробно описывается в следующих разделах.

Более подробный пример см. в разделе [Пошаговое руководство. Создание, изменение и обслуживание закодированного теста пользовательского интерфейса](../test/walkthrough-creating-editing-and-maintaining-a-coded-ui-test.md). В этом пошаговом руководстве создается простое приложение Windows Presentation Foundation (WPF), чтобы с его помощью продемонстрировать создание, редактирование и обслуживание закодированного теста ИП. В этом пошаговом руководстве приведены решения для корректировки тестов с проблемами, связанными со временем и рефакторингом элементов управления.

## <a name="start-and-stop-the-application-under-test"></a>Запуск и остановка тестируемого приложения

Если вы не хотите запускать и останавливать приложение, браузер или базу данных отдельно для каждого теста, выполните одно из следующих действий:

- Если вы не хотите записывать действия, чтобы запускать приложение во время тестирования, необходимо запустить приложение до нажатия значка **Запись**.

- В конце теста процесс, в котором тест выполняется, завершается. Если вы запустили приложение во время теста, оно обычно закрывается.  Если вы не хотите закрывать приложение, добавьте *RUNSETTINGS*-файл в решение и используйте параметр `KeepExecutorAliveAfterLegacyRun`. Дополнительные сведения см. в разделе [Настройка модульных тестов с помощью файла .runsettings](../test/configure-unit-tests-by-using-a-dot-runsettings-file.md).

- Добавьте метод инициализации теста, который определяется атрибутом `[TestInitialize]`, для запуска кода в начале каждого метода теста. Например, в методе TestInitialize можно запустить приложение.

- Добавьте метод очистки теста, который определяется атрибутом `[TestCleanup]`, для запуска кода в конце каждого метода теста. Например, метод для закрытия приложения можно вызвать в методе TestCleanup.

## <a name="validate-the-properties-of-ui-controls"></a>Проверка свойства элементов управления пользовательского интерфейса

С помощью **построителя закодированных тестов пользовательского интерфейса** можно добавить элемент управления пользовательского интерфейса в <xref:Microsoft.VisualStudio.TestTools.UITest.Common.UIMap.UIMap> для вашего теста или создать код метода проверки, который использует утверждение для элемента управления.

Чтобы создать утверждения для элементов управления, выберите средство **Добавить утверждения** в построителе закодированных тестов пользовательского интерфейса и перетащите его в тестируемое приложение. Когда вокруг элемента управления появится рамка, отпустите кнопку мыши. Код класса элемента управления будет создан в файле `UIMap.Designer.cs`.

![Целевой элемент закодированного теста пользовательского интерфейса](../test/media/codedui_1.png)

Свойства этого элемента управления появятся в диалоговом окне **Добавление утверждений**.

Еще один способ перейти к определенному элементу управления — выбрать стрелку **(<<)**, чтобы развернуть представление **карты элементов управления пользовательского интерфейса**. Чтобы найти родительский, дочерний элемент управления или элемент управления с определенным родительским элементом, щелкните в любой точке на карте и с помощью стрелок перемещайтесь по дереву.

![Свойства закодированного теста пользовательского интерфейса](../test/media/codedui_2.png)

> [!TIP]
> Если при выборе элемента управления в приложении вы не видите никаких свойств или не видите элемент управления на карте элементов управления пользовательского интерфейса, убедитесь, что в коде приложения элементу присвоен уникальный идентификатор. В качестве уникального идентификатора может использоваться атрибут HTML ID или WPF UId.

Затем откройте контекстное меню свойства элемента управления, который следует проверить, и наведите указатель на пункт **Добавить утверждение**. В диалоговом окне **Добавление утверждения** выберите **Средство сравнения** для утверждения, например <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert.AreEqual%2A>, и введите значение для утверждения в поле **Значение сравнения**.

![Утверждения закодированного теста пользовательского интерфейса](../test/media/codedui_3.png)

После добавления всех утверждений нажмите кнопку **ОК**.

Чтобы создать код для утверждений и добавить элемент управления на карту пользовательского интерфейса, щелкните значок **Создать код**. Введите имя закодированного метода теста ИП и описание метода, которое будет добавлено как комментарий. Нажмите кнопку **Добавить и создать**. Затем щелкните значок **Закрыть**, чтобы закрыть **построитель закодированных тестов пользовательского интерфейса**. После этого будет создан код, аналогичный следующему. Например, если вы ввели имя `AssertForAddTwoNumbers`, код будет выглядеть, как в этом примере:

- Добавляет вызов метода утверждения AssertForAddTwoNumbers в метод теста в файле закодированного теста ИП:

    ```csharp
    [TestMethod]
    public void CodedUITestMethod1()
    {
        this.UIMap.AddTwoNumbers();
        this.UIMap.AssertForAddTwoNumbers();
    }
    ```

     Вы можете изменить этот файл, чтобы поменять порядок шагов и утверждений или создать новые методы теста. Чтобы добавить другой код, наведите указатель на метод теста и в контекстном меню выберите команду **Сформировать код для закодированного теста пользовательского интерфейса**.

- Добавляет метод `AssertForAddTwoNumbers` на карту ИП (UIMap.uitest). Этот файл открывается в редакторе закодированных тестов ИП, где можно изменить утверждения.

     ![Редактирование утверждения с помощью редактора закодированных тестов пользовательского интерфейса](../test/media/cuit_editor_assert.png)

     Дополнительные сведения см. в разделе [Изменение закодированных тестов пользовательского интерфейса с помощью редактора закодированных тестов пользовательского интерфейса](../test/editing-coded-ui-tests-using-the-coded-ui-test-editor.md).

     Вы также можете просмотреть сформированный код метода утверждения в файле UIMap.Designer.cs. Однако изменять этот файл не следует. Если вы хотите создать адаптированную версию кода, скопируйте методы в другой файл, например UIMap.cs, переименуйте методы и измените их.

    ```csharp
    public void AssertForAddTwoNumbers()
    {
        ...
    }
    ```

### <a name="select-a-hidden-control-using-the-keyboard"></a>Выбор скрытого элемента управления с помощью клавиатуры

Если элемент управления, который вы хотите выбрать, теряет фокус и исчезает, когда вы выбираете средство добавления утверждений в построителе закодированных тестов ИП:

Иногда при добавлении элементов управления и проверке их свойств может потребоваться использовать клавиатуру. Например, при попытке записать закодированный тест ИП, который использует элемент управления контекстным меню, список пунктов меню в элементе управления потеряет фокус и исчезнет при попытке выбрать средство добавления утверждений в построителе закодированных тестов ИП. Это демонстрируется на следующем рисунке, где контекстное меню в Internet Explorer теряет фокус и исчезает при попытке выбрать его с помощью средства добавления утверждений.

![CodedUITest&#95;SelectControlKeyboard](../test/media/codeduitest_selectcontrolkeyboard.png)

Чтобы выбрать элемент управления клавиатурой, наведите на него указатель мыши. Затем нажмите и удерживайте клавиши **CTRL** и **I** одновременно. Отпустите клавиши. Элемент управления будет записан построителем закодированных тестов ИП.

> [!WARNING]
> Если вы используете Microsoft Lync, закройте это приложение перед запуском построителя закодированных тестов ИП. Microsoft Lync перехватывает сочетание клавиш **CTRL+I**.

#### <a name="manually-record-mouse-hovers"></a>Ручная запись наведений указателя мыши

Если вам не удается записать наведение указателя мыши на элемент управления:

В некоторых случаях для ручной записи наведения указателя мыши на определенный элемент управления, используемый в закодированном тесте пользовательского интерфейса, может потребоваться использовать клавиатуру. Например, при в приложении Windows Form или Windows Presentation Foundation (WPF) может использоваться настраиваемый код. Или для наведения указателя мыши на элемент управления может быть задано специальное поведение, например разворачивание узла. Чтобы протестировать подобные ситуации, следует вручную указать в построителе закодированных тестов ИП, что вы наводите указатель мыши на элемент управления, нажав соответствующие клавиши.

При выполнении закодированного теста ИП наведите указатель на элемент управления. Затем одновременно нажмите и удерживайте клавиши CTRL, SHIFT и R. Отпустите клавиши. События наведения указателя будет записано построителем закодированных тестов ИП.

![CodedUI&#95;Hover](../test/media/codedui_hover.png)

После создания метода теста в файл UIMap.Desinger.cs будет добавлен код, как в следующем примере:

```csharp
// Mouse hover '1' label at (87, 9)
Mouse.Hover(uIItem1Text, new Point(87, 9));
```

### <a name="configure-mouse-hover-keyboard-assignments"></a>Настройка сочетаний клавиш для записи наведения указателя мыши

Сочетание клавиш для записи событий наведения указателя мыши используется другим процессом:

При необходимости сочетание клавиш **CTRL**+**SHIFT**+**R** по умолчанию, используемое для записи событий наведения указателя мыши в закодированных тестах ИП, можно изменить.

> [!WARNING]
> В целом, изменять это сочетание клавиш следует только, если это действительно необходимо. Будьте осторожны при изменении назначенных сочетаний клавиш. Возможно, выбранное вами сочетание уже используется в Visual Studio или тестируемом приложении.

Чтобы изменить сочетание клавиш, отредактируйте следующий файл конфигурации:

*%ProgramFiles(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\CodedUITestBuilder.exe.config*

В файле конфигурации измените значения клавиш `HoverKeyModifier` и `HoverKey`, чтобы поменять сочетание клавиш:

```xml
<!-- Begin : Background Recorder Settings -->
<!-- HoverKey to use. -->
<add key="HoverKeyModifier" value="Control, Shift"/>
<add key="HoverKey" value="R"/>
```

### <a name="set-implicit-mouse-hovers-for-the-web-browser"></a>Настройка явных наведений указателя мыши для браузера

Если у вас возникают проблемы с записью наведения указателя мыши для веб-сайта:

На многих веб-сайтах при наведении указателя на определенный элемент управления он разворачивается для отображения дополнительных сведений. В целом, это похоже на меню в приложениях для настольных ПК. Такое поведение встречается часто, поэтому закодированные тесты пользовательского интерфейса поддерживают неявное наведение указателя для веб-сайтов. Например, если вы записываете наведение указателя в Internet Explorer, инициируется событие. Из-за этих событий могут быть записаны избыточные наведения указателя мыши. Поэтому неявные наведения записываются в файл конфигурации теста ИП с параметром `ContinueOnError`, имеющим значение `true`. Это позволяет продолжить воспроизведение при ошибке события наведения указателя.

Чтобы включить запись неявных наведений указателя в браузере, откройте файл конфигурации:

*%ProgramFiles(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\CodedUITestBuilder.exe.config*

Убедитесь, что в файле конфигурации для раздела `RecordImplicitiHovers` задано значение `true`, как показано в следующем примере:

```xml
<!--Use this to enable/disable recording of implicit hovers.-->
<add key="RecordImplicitHover" value="true"/>
```

## <a name="customize-the-coded-ui-test"></a>Настройка закодированного теста пользовательского интерфейса

После создания закодированного теста пользовательского интерфейса его можно изменить с помощью следующих средств в Visual Studio.

- **Построитель кодированных тестов ИП** используется для добавления элементов управления и проверок в тесты. См. подраздел [Добавление элементов управления и проверка их свойств](#validate-the-properties-of-ui-controls) в этом разделе.

- **Редактор закодированных тестов пользовательского интерфейса** позволяет легко изменять закодированные тесты пользовательского интерфейса. С помощью **редактора** вы можете найти, просмотреть и изменить методы теста. Вы также можете редактировать действия ИП и связанные элементы управления на карте элементов управления ИП. Дополнительные сведения см. в разделе [Изменение закодированных тестов пользовательского интерфейса с помощью редактора закодированных тестов пользовательского интерфейса](../test/editing-coded-ui-tests-using-the-coded-ui-test-editor.md).

- **Редактор кода:**

    - позволяет вручную добавить код элементов управления в тест, как описано в подразделе [Программирование действий и свойств элементов управления пользовательского интерфейса](#coded-ui-control-actions-and-properties) в этом разделе.

    - После создания закодированного теста ИП вы можете изменить его, чтобы его работа зависела от данных. Дополнительные сведения см. в разделе [Создание управляемого данными закодированного теста пользовательского интерфейса](../test/creating-a-data-driven-coded-ui-test.md).

    - При воспроизведении закодированного теста ИП вы можете подождать возникновения определенных событий, например открытия окна, исчезновения строки хода выполнения и т. д. Для этого добавьте соответствующий метод UITestControl.WaitForControlXXX(). Полный список доступных методов см. в разделе [Настройка закодированного теста пользовательского интерфейса таким образом, чтобы во время воспроизведения он дожидался определенных событий](../test/making-coded-ui-tests-wait-for-specific-events-during-playback.md). Пример закодированного теста пользовательского интерфейса, который ожидает включения элемента управления с помощью метода WaitForControlEnabled, см. в разделе [Пошаговое руководство. Создание, изменение и обслуживание закодированного теста пользовательского интерфейса](../test/walkthrough-creating-editing-and-maintaining-a-coded-ui-test.md).

    - Закодированные тесты ИП поддерживают некоторые элементы управления HTML5 в Internet Explorer 9 и Internet Explorer 10. Дополнительные сведения см. в разделе [Использование элементов управления HTML5 в закодированных тестах пользовательского интерфейса](../test/using-html5-controls-in-coded-ui-tests.md).

    - Руководство по кодированию тестов ИП:

       - [Составляющие закодированного теста пользовательского интерфейса](../test/anatomy-of-a-coded-ui-test.md)

       - [Рекомендации по выполнению закодированных тестов пользовательского интерфейса](../test/best-practices-for-coded-ui-tests.md)

       - [Тестирование крупного приложения с несколькими картами пользовательского интерфейса](../test/testing-a-large-application-with-multiple-ui-maps.md)

       - [Поддерживаемые конфигурации и платформы для закодированных тестов пользовательского интерфейса и записей действий](../test/supported-configurations-and-platforms-for-coded-ui-tests-and-action-recordings.md)

### <a name="the-generated-code"></a>Сформированный код

Если нажать кнопку **Создать код**, создается несколько фрагментов кода:

- Строка в методе теста.

    ```csharp
    [CodedUITest]
    public class CodedUITest1
    { ...
      [TestMethod]
      public void CodedUITestMethod1()
      {
          this.UIMap.AddTwoNumbers();
          // To generate more code for this test, select
          // "Generate Code" from the shortcut menu.      }
    }
    ```

     Вы можете щелкнуть метод правой кнопкой, чтобы добавить записанные действия и проверки. Вы также можете изменить его вручную, чтобы расширить или поменять код. Например, можно часть кода заключить в цикл.

     Кроме того, можно добавить новые методы теста и добавить в них код аналогичным способом. У каждого метода теста должен быть атрибут `[TestMethod]`.

- Метод в файле *UIMap.uitest*.

     Он содержит сведения о записанных действиях или проверенном значении. Этот код можно изменить в файле UIMap.uitest. Он открывается в специальном редакторе, где можно удалить или изменить записанные действия.

     Вы также можете просмотреть сформированный код метода в файле UIMap.Designer.cs. Этот метод выполняет действия, записанные во время запуска теста.

    ```csharp
    // File: UIMap.Designer.cs
    public partial class UIMap
    {
      /// <summary>
      /// Add two numbers
      /// </summary>
      public void AddTwoNumbers()
      { ...   }
    }
    ```

    > [!WARNING]
    > Не следует редактировать этот файл, так как он будет повторно сформирован при создании других тестов.

     Можно создать адаптированные версии этих методов, скопировав их в файл *UIMap.cs*. Например, можно создать параметризированную версию, которую можно вызывать из метода теста:

    ```csharp
    // File: UIMap.cs
    public partial class UIMap // Same partial class
    {
      /// <summary>
      /// Add two numbers - parameterized version
      /// </summary>
      public void AddTwoNumbers(int firstNumber, int secondNumber)
      { ...   // Code modified to use parameters.
      }
    }
    ```

- Объявления в файле *UIMap.uitest*.

    Эти объявления представляют элементы управления ИП приложения, используемые тестом. Созданный код их применяет для работы с элементами управления и доступа к их свойствам.

    Их также можно использовать при написании собственного кода. Например, метод теста позволяет выбрать гиперссылку в веб-приложении, ввести значение в текстовом поле или выполнить другие действия на основе значения в поле.

    Вы можете добавить несколько закодированных тестов ИП и несколько объектов карты ИП и файлов для тестирования более сложного приложения. Дополнительные сведения см. в разделе [Тестирование крупного приложения с несколькими картами пользовательского интерфейса](../test/testing-a-large-application-with-multiple-ui-maps.md).

Дополнительные сведения о созданном коде см. в разделе [Составляющие закодированного теста пользовательского интерфейса](../test/anatomy-of-a-coded-ui-test.md).

## <a name="coded-ui-control-actions-and-properties"></a>Действия и свойства элементов управления закодированного теста пользовательского интерфейса

При работе с элементами управления закодированные тесты ИП разделены на две части: действия и свойства.

- Первая часть состоит из действий, которые можно выполнить с элементами управления. Например, закодированные тесты ИП могут симулировать щелчок элемента управления или нажатие клавиш для изменения элемента управления.

- Вторая часть позволяет получать и задавать свойства элемента управления. Например, закодированные тесты ИП могут получать число элементов в `ListBox` или переводить элемент управления `CheckBox` в выбранное состояние.

**Доступ к действиям элемента управления теста пользовательского интерфейса**

Для выполнения действий с элементами управления теста ИП, таких как щелчок мыши или нажатие клавиши, используйте методы классов <xref:Microsoft.VisualStudio.TestTools.UITesting.Mouse> и <xref:Microsoft.VisualStudio.TestTools.UITesting.Keyboard>:

- Для выполнения действия, связанного с мышью, например щелчка, с элементом управления теста ИП используйте <xref:Microsoft.VisualStudio.TestTools.UITesting.Mouse.Click%2A>.

     `Mouse.Click(buttonCancel);`

- Для выполнения действия, связанного с клавиатурой, например ввод текста в элемент управления, используйте <xref:Microsoft.VisualStudio.TestTools.UITesting.Keyboard.SendKeys%2A>.

     `Keyboard.SendKeys(textBoxDestination, @"C:\Temp\Output.txt");`

**Доступ к свойствам элемента управления теста пользовательского интерфейса**

Чтобы получить или задать значения определенных свойств элемента управления, можно напрямую извлечь или установить свойства элемента управления или использовать методы <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.GetProperty%2A?displayProperty=fullName> и <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.SetProperty%2A?displayProperty=fullName> с именем нужного свойства.

<xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.GetProperty%2A> возвращает объект, который можно привести к соответствующему типу <xref:System.Type>. <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.SetProperty%2A> принимает объект в качестве значения свойства.

### <a name="to-get-or-set-properties-from-ui-test-controls-directly"></a>Получение и установка свойств из элементов управления теста ИП напрямую

С помощью элементов управления, являющихся производными от <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl>, таких как [HtmlList](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.uitesting.htmlcontrols.htmllist.aspx) или [WinComboBox](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.uitesting.wincontrols.wincombobox.aspx), можно получить или задать значения их свойств напрямую. В коде ниже приведено несколько примеров:

 ```csharp
 int i = myHtmlList.ItemCount;
 myWinCheckBox.Checked = true;
 ```

### <a name="to-get-properties-from-ui-test-controls"></a>Получение свойств из элементов управления ИП

- Для получения значения свойства элемента управления используйте метод <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.GetProperty%2A>.

- Чтобы указать свойство, которое необходимо получить, используйте соответствующую строку из класса `PropertyNames` в каждом элементе управления как параметр для <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.GetProperty%2A>.

- <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.GetProperty%2A> возвращает соответствующий тип данных, после чего это значение преобразуется в тип <xref:System.Object>. Возвращенное значение <xref:System.Object> необходимо преобразовать в соответствующий тип.

     Пример

     `int i = (int)GetProperty(myHtmlList.PropertyNames.ItemCount);`

### <a name="to-set-properties-for-ui-test-controls"></a>Установка свойств элементов управления ИП

- Для установки значения свойства элемента управления используйте метод <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.SetProperty%2A>.

- Чтобы указать свойство, которое необходимо установить, используйте соответствующую строку из класса `PropertyNames` как первый параметр для <xref:Microsoft.VisualStudio.TestTools.UITesting.UITestControl.SetProperty%2A>, а значение свойства — как второй параметр.

     Пример

     `SetProperty(myWinCheckBox.PropertyNames.Checked, true);`

## <a name="debug"></a>Отладка

Вы можете анализировать закодированные тесты ИП с помощью журналов. Журналы закодированных тестов ИП фильтруют и записывают важную информацию о запуске тестов. Формат журналов позволяет быстро находить и исправлять ошибки. Дополнительные сведения см. в разделе [Анализ закодированных тестов пользовательского интерфейса с помощью журналов закодированных тестов пользовательского интерфейса](../test/analyzing-coded-ui-tests-using-coded-ui-test-logs.md).

## <a name="whats-next"></a>Что дальше?

**Дополнительные параметры для выполнения закодированных тестов пользовательского интерфейса**. Вы можете выполнять закодированные тесты пользовательского интерфейса напрямую из Visual Studio, как было сказано ранее. Кроме того, автоматизированные тесты ИП можно запускать в Microsoft Test Manager или сборке Foundation. Если закодированные тесты ИП автоматизированы, они, в отличие от других автоматических тестов, должны взаимодействовать с рабочим столом при их выполнении.

- [Выполнение модульных тестов с помощью обозревателя тестов](../test/run-unit-tests-with-test-explorer.md)

- [Выполнение тестов в процессе сборки](/vsts/build-release/test/getting-started-with-continuous-testing)

- [Практическое руководство. Настройка агента тестирования для выполнения тестов, взаимодействующих с рабочим столом](http://msdn.microsoft.com/Library/3a94dd07-6d17-402c-ae8f-7947143755c9)

**Добавление поддержки пользовательских элементов управления**. Платформа закодированных тестов пользовательского интерфейса поддерживает не все возможные пользовательские интерфейсы, в частности она может не поддерживать тестируемый пользовательский интерфейс. Например, невозможно напрямую создать закодированный тест пользовательского интерфейса приложения для Microsoft Excel. Однако можно создать расширение среды обработки закодированных тестов пользовательского интерфейса, которое будет поддерживать пользовательский элемент управления.

- [Включение закодированных тестов пользовательского интерфейса для элементов управления](../test/enable-coded-ui-testing-of-your-controls.md)

- [Расширение закодированных тестов пользовательского интерфейса и записей действий](../test/extending-coded-ui-tests-and-action-recordings-to-support-microsoft-excel.md)

Закодированные тесты ИП часто используются для автоматизации ручных тестов. Дополнительные сведения о ручных тестах см. в разделе [Выполнение ручных тестов с помощью Microsoft Test Manager](/vsts/test/mtm/run-manual-tests-with-microsoft-test-manager). Дополнительные сведения об автоматизированных тестах см. в [описании средств тестирования в Visual Studio](../test/improve-code-quality.md).

## <a name="see-also"></a>См. также

- <xref:Microsoft.VisualStudio.TestTools.UITest.Common.UIMap.UIMap>
- <xref:Microsoft.VisualStudio.TestTools.UnitTesting.Assert>
- [Пошаговое руководство. Создание, изменение и поддержка закодированного теста пользовательского интерфейса](../test/walkthrough-creating-editing-and-maintaining-a-coded-ui-test.md)
- [Создание закодированного теста пользовательского интерфейса для тестирования приложения UWP](test-uwp-app-with-coded-ui-test.md)
- [Составляющие закодированного теста пользовательского интерфейса](../test/anatomy-of-a-coded-ui-test.md)
- [Рекомендации по выполнению закодированных тестов пользовательского интерфейса](../test/best-practices-for-coded-ui-tests.md)
- [Тестирование крупного приложения с несколькими картами пользовательского интерфейса](../test/testing-a-large-application-with-multiple-ui-maps.md)
