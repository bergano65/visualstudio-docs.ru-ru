---
title: Пошаговое руководство. Создание веб-части для SharePoint | Документация Майкрософт
description: Создайте веб-часть для SharePoint. Веб-части позволяют пользователям напрямую изменять содержимое, внешний вид и поведение страниц сайта SharePoint с помощью браузера.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- Web Parts [SharePoint development in Visual Studio], developing
- Web Parts [SharePoint development in Visual Studio], creating
- Web Parts [SharePoint development in Visual Studio], designing
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 0f2d14bfd069fcf5064c9d8643393e28e52570be
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99918634"
---
# <a name="walkthrough-create-a-web-part-for-sharepoint"></a>Пошаговое руководство: создание веб-части для SharePoint

Веб-части позволяют пользователям напрямую изменять содержимое, внешний вид и поведение страниц сайта SharePoint с помощью браузера. В этом пошаговом руководстве показано, как создать веб-часть с помощью шаблона элемента **веб-части** в Visual Studio 2010.

Веб-часть отображает сотрудников в сетке данных. Пользователь указывает расположение файла, содержащего данные о сотрудниках. Пользователь также может фильтровать сетку данных таким образом, чтобы сотрудники, являющиеся менеджерами, отображались только в списке.

В этом пошаговом руководстве описаны следующие задачи:

- Создание веб-части с помощью шаблона элемента **веб-части** Visual Studio.

- Создание свойства, которое может быть задано пользователем веб-части. Это свойство задает расположение файла данных сотрудника.

- Отрисовка содержимого в веб-части путем добавления элементов управления в коллекцию элементов управления веб-частей.

- Создание нового пункта меню, называемого *глаголом,* который отображается в меню глаголы отображаемой веб-части. Команды позволяют пользователю изменять данные, отображаемые в веб-части.

- Тестирование веб-части в SharePoint.

    > [!NOTE]
    > Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. Дополнительные сведения см. в разделе [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).

## <a name="prerequisites"></a>Предварительные требования

- Поддерживаемые редакции Microsoft Windows и SharePoint.

- Visual Studio 2017 или Azure DevOps Services.

## <a name="create-an-empty-sharepoint-project"></a>Создание пустого проекта SharePoint

Сначала создайте пустой проект SharePoint. Позже вы добавите веб-часть в проект с помощью шаблона элемента **веб-части** .

1. Начните с [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] использования команды **Запуск от имени администратора** .

2. На панели «мужчин» выберите **файл**  >  **создать**  >  **проект**.

3. В диалоговом окне **Новый проект** разверните узел **SharePoint** под языком, который необходимо использовать, а затем выберите узел **2010** .

4. В области **шаблоны** выберите **проект SharePoint 2010**, а затем нажмите кнопку **ОК** .

     Откроется **Мастер настройки SharePoint** . Этот мастер позволяет выбрать сайт, который будет использоваться для отладки проекта, и уровень доверия решения.

5. Выберите параметр **Развернуть как решение фермы** , а затем нажмите кнопку **Готово** , чтобы принять локальный сайт SharePoint по умолчанию.

## <a name="add-a-web-part-to-the-project"></a>Добавление веб-части в проект

Добавьте элемент **веб-части** в проект. Элемент **веб-части** добавляет файл кода веб-части. Позже в файл кода веб-части будет добавлен код для отображения содержимого веб-части.

1. В строке меню выберите **Проект** > **Добавить новый элемент**.

2. В диалоговом окне **Добавление нового элемента** в области **Установленные шаблоны** разверните узел **SharePoint** и выберите узел **2010** .

3. В списке шаблонов SharePoint выберите шаблон **веб-части** , а затем нажмите кнопку **Добавить** .

     Элемент **веб-части** отображается в **Обозреватель решений**.

## <a name="rendering-content-in-the-web-part"></a>Отрисовка содержимого в веб-части

Вы можете указать, какие элементы управления должны отображаться в веб-части, добавив их в коллекцию Controls класса веб-части.

1. В **Обозреватель решений** откройте *WebPart1. vb* (в Visual Basic) или *WebPart1.CS* (в C#).

     Файл кода веб-части откроется в редакторе кода.

2. Добавьте следующие директивы в начало файла кода веб-части.

     [!code-csharp[SP_WebPart#1](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#1)]
     [!code-vb[SP_WebPart#1](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#1)]

3. Добавьте в класс `WebPart1` приведенный далее код. Этот код объявляет следующие поля:

   - Сетка данных для просмотра сотрудников в веб-части.

   - Текст, отображаемый на элементе управления, который используется для фильтрации сетки данных.

   - Метка, которая отображает ошибку, если сетке данных не удается отобразить данные.

   - Строка, содержащая путь к файлу данных сотрудника.

     [!code-csharp[SP_WebPart#2](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#2)]
     [!code-vb[SP_WebPart#2](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#2)]

4. Добавьте в класс `WebPart1` приведенный далее код. Этот код добавляет пользовательское свойство с именем `DataFilePath` в веб-часть. Пользовательское свойство — это свойство, которое может быть задано пользователем в SharePoint. Это свойство получает и задает расположение XML-файла данных, который используется для заполнения сетки данных.

     [!code-csharp[SP_WebPart#3](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#3)]
     [!code-vb[SP_WebPart#3](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#3)]

5. Замените метод `CreateChildControls` приведенным ниже кодом. Этот код выполняет следующие задачи:

   - Добавляет сетку данных и метку, объявленные на предыдущем шаге.

   - Привязывает сетку данных к XML-файлу, содержащему данные о сотрудниках.

     [!code-csharp[SP_WebPart#4](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#4)]
     [!code-vb[SP_WebPart#4](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#4)]

6. Добавьте следующий метод в класс `WebPart1`. Этот код выполняет следующие задачи:

   - Создает команду, которая отображается в меню команд веб-части отображаемой веб-части.

   - Обрабатывает событие, возникающее при выборе пользователем команды в меню команд. Этот код фильтрует список сотрудников, отображаемых в сетке данных.

     [!code-csharp[SP_WebPart#5](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#5)]
     [!code-vb[SP_WebPart#5](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#5)]

## <a name="test-the-web-part"></a>Тестирование веб-части

При запуске проекта открывается сайт SharePoint. Веб-часть автоматически добавляется в галерею веб-частей в SharePoint. Веб-часть можно добавить на любую страницу веб-части.

1. Вставьте следующий XML-код в файл Блокнота. Этот XML-файл содержит образцы данных, которые будут отображаться в веб-части.

    ```xml
    <?xml version="1.0" encoding="utf-8" ?>
        <employees xmlns="http://schemas.microsoft.com/vsto/samples">
           <employee>
               <name>David Hamilton</name>
               <hireDate>2001-05-11</hireDate>
               <title>Sales Associate</title>
           </employee>
           <employee>
               <name>Karina Leal</name>
               <hireDate>1999-04-01</hireDate>
               <title>Manager</title>
           </employee>
           <employee>
               <name>Nancy Davolio</name>
               <hireDate>1992-05-01</hireDate>
               <title>Sales Associate</title>
           </employee>
           <employee>
               <name>Steven Buchanan</name>
               <hireDate>1955-03-04</hireDate>
               <title>Manager</title>
           </employee>
           <employee>
               <name>Suyama Michael</name>
               <hireDate>1963-07-02</hireDate>
               <title>Sales Associate</title>
           </employee>
        </employees>
    ```

2. В блокноте в строке меню выберите **файл**  >  **Сохранить как**.

3. В диалоговом окне **Сохранить как** в списке **Тип файла** выберите **все файлы**.

4. В поле **имя файла** введите **data.xml**.

5. Выберите любую папку с помощью кнопки **Обзор папок** , а затем нажмите кнопку **сохранить** .

6. В Visual Studio нажмите клавишу **F5** .

     Откроется сайт SharePoint.

7. В меню **действия сайта** выберите пункт **Дополнительные параметры**.

8. На странице **Создание** выберите тип **страницы веб-часть** , а затем нажмите кнопку **создать** .

9. На странице **Новая страница веб-части** назовите страницу **самплевебпартпаже. aspx**, а затем нажмите кнопку **создать** .

     Откроется страница веб-части.

10. Выберите любую зону на странице веб-части.

11. В верхней части страницы перейдите на вкладку **Вставка** и нажмите кнопку **веб-часть** .

12. В области **категории** выберите **пользовательскую** папку, веб-часть **WebPart1** , а затем нажмите кнопку **Добавить** .

     Веб-часть появится на странице.

## <a name="test-the-custom-property"></a>Тестирование пользовательского свойства

Чтобы заполнить сетку данных, отображаемую в веб-части, укажите путь к XML-файлу, содержащему данные о каждом сотруднике.

1. Щелкните стрелку, которая отображается в правой части веб-части, и выберите пункт **Изменить веб-часть** в появившемся меню.

     Панель, содержащая свойства веб-части, отображается в правой части страницы.

2. На панели разверните узел **Прочее** , введите путь к созданному ранее XML-файлу, нажмите кнопку **Применить** , а затем нажмите кнопку **ОК** .

     Убедитесь, что список сотрудников отображается в веб-части.

## <a name="test-the-web-part-verb"></a>Тестирование команды веб-части

Отображение и скрытие сотрудников, не являющихся руководителями, путем выбора элемента, отображаемого в меню команд веб-части.

1. Щелкните стрелку, которая отображается в правой части веб-части, и выберите пункт **Показывать менеджеры только** в появившемся меню.

     В веб-части отображаются только сотрудники, являющиеся руководителями.

2. Снова нажмите стрелку и выберите в появившемся меню пункт **Показывать все сотрудники** .

     Все сотрудники отображаются в веб-части.

## <a name="see-also"></a>См. также раздел

[Создание веб-частей для SharePoint](../sharepoint/creating-web-parts-for-sharepoint.md) 
 [Как создать веб-часть SharePoint](../sharepoint/how-to-create-a-sharepoint-web-part.md) 
 [Инструкции. Создание веб-части SharePoint с помощью конструктора](../sharepoint/how-to-create-a-sharepoint-web-part-by-using-a-designer.md) 
 [Пошаговое руководство. Создание веб-части для SharePoint с помощью конструктора](../sharepoint/walkthrough-creating-a-web-part-for-sharepoint-by-using-a-designer.md)
