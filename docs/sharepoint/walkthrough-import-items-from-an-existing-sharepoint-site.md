---
title: Пошаговое руководство. Импорт элементов с существующего сайта SharePoint | Документация Майкрософт
titleSuffix: ''
description: В этом пошаговом руководстве вы импортируете элементы из существующего сайта SharePoint в проект Visual Studio SharePoint.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, importing items
- importing items [SharePoint development in Visual Studio]
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 861b6ff20f9ceb73c279e54fa89ee513389b6b91
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99900952"
---
# <a name="walkthrough-import-items-from-an-existing-sharepoint-site"></a>Пошаговое руководство: Импорт элементов с существующего сайта SharePoint
  В этом пошаговом руководстве показано, как импортировать элементы из существующего сайта SharePoint в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] проект SharePoint.

 В этом пошаговом руководстве описаны следующие задачи.

- Настройка сайта SharePoint путем добавления пользовательского столбца сайта (также известного как *поле*).

- Экспорт сайта SharePoint в WSP-файл.

- Импорт WSP файла в SharePoint с [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] помощью проекта импорта WSP.

  [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]

## <a name="prerequisites"></a>Предварительные требования
 Для выполнения этого пошагового руководства требуются следующие компоненты:

- Поддерживаемые выпуски [!INCLUDE[TLA#tla_win](../sharepoint/includes/tlasharptla-win-md.md)] и SharePoint.

- приведенному.

## <a name="customize-a-sharepoint-site"></a>Настройка сайта SharePoint
 В этом примере создается и настраивается дочерний сайт SharePoint путем добавления нового столбца сайта и создания другого дочернего сайта для последующего использования. Позже будет экспортирован первый дочерний сайт в WSP-файл, а затем импортирован пользовательский столбец сайта во второй дочерний сайт с помощью проекта импорта WSP-файла.

### <a name="to-create-and-customize-a-sharepoint-site"></a>Создание и настройка сайта SharePoint

1. Откройте сайт SharePoint с помощью веб-браузера, например http://<em>System Name</em>/ситепажес/Хоме.аспкс.

2. Создайте дочерний сайт на основном сайте SharePoint, открыв меню **действия сайта** и выбрав пункт **создать сайт**.

3. В диалоговом окне **создать** сайта выберите тип **пустого сайта** .

4. В поле **название** введите **Проверка столбца сайта 1**; в поле **URL-адрес** введите **columntest1**; Оставьте для остальных параметров значения по умолчанию. а затем нажмите кнопку **создать** .

5. После создания сайта перейдите в браузере назад к основному сайту http://<em>System Name</em>/ситепажес/Хоме.аспкс.

6. Опять же, создайте пустой дочерний сайт на основном сайте SharePoint, открыв меню **действия сайта** , выбрав пункт **создать сайт**, а затем выбрав тип **пустого сайта** .

7. В поле **название** введите **Проверка столбца сайта 2**; в поле **URL-адрес** введите **columntest2**; Оставьте для остальных параметров значения по умолчанию. а затем нажмите кнопку **создать** .

8. Вернитесь на первый дочерний сайт, http://<em>SystemName</em>/columntest1/Default.aspx.

9. В меню **действия сайта** выберите пункт **Параметры сайта** , чтобы открыть страницу Параметры сайта.

10. В разделе **коллекции** выберите ссылку **столбцы сайта** .

11. В верхней части страницы **коллекции столбцов сайта** нажмите кнопку **создать** .

12. В поле **имя столбца** введите **Тестовый столбец**, сохраните другие значения по умолчанию, а затем нажмите кнопку **ОК** .

13. Столбец **Тестовый столбец** отображается под заголовком пользовательские столбцы в коллекции столбцов сайта.

## <a name="exporting-the-sharepoint-site"></a>Экспорт сайта SharePoint
 Затем получите файл установки SharePoint (. wsp), содержащий элементы и элементы SharePoint, которые необходимо импортировать в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] проект SharePoint. Если у вас еще нет WSP-файла, необходимо создать его на основе существующего сайта SharePoint. В этом примере выполняется экспорт сайта SharePoint по умолчанию в WSP-файл.

> [!IMPORTANT]
> Если при выполнении следующей процедуры возникает ошибка времени выполнения, необходимо выполнить процедуру в системе, которая имеет доступ к сайту SharePoint.

### <a name="to-export-an-existing-sharepoint-site"></a>Экспорт существующего сайта SharePoint

1. На сайте SharePoint выберите **Параметры сайта** на вкладке **действия сайта** , чтобы отобразить страницу Параметры сайта.

2. В разделе **действия сайта** страницы Параметры сайта выберите ссылку **сохранить сайт как шаблон** .

3. В поле **имя файла** введите **ексамплесите**, а в поле **имя шаблона** введите **Пример site**.

4. Для этого примера оставьте флажок **включить содержимое** снятым.

     Если выбрать этот флажок, [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] в wspный файл будут сохранены все списки и библиотеки документов, а также их содержимое. Хотя это и полезно в некоторых обстоятельствах, оно не является обязательным для этого примера.

5. После успешного завершения операции щелкните ссылку **Коллекция решений** , чтобы просмотреть WSP файл.

     Чтобы просмотреть страницу "Коллекция решений" позже, откройте меню " **действия сайта** ", выберите " **Параметры** сайта", щелкните ссылку **"перейти к параметрам сайта верхнего уровня** " в разделе " **Администрирование семейства веб-сайтов** ", а затем щелкните ссылку " **решения** " в разделе " **галереи** ".

6. В коллекции решений выберите ссылку **ексамплесите** .

7. В диалоговом окне **Загрузка файла** нажмите кнопку **сохранить** , чтобы сохранить файл в локальной системе по умолчанию в папке Downloads.

## <a name="import-the-wsp-file"></a>Импорт wspного файла
 Теперь, когда у вас есть *WSP* -файл, содержащий элемент, который необходимо повторно использовать (пользовательский столбец пользовательского сайта), импортируйте *WSP* -файл, чтобы получить к нему доступ.

### <a name="to-import-a-wsp-file"></a>Импорт WSP-файла

1. В в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] строке меню выберите **файл**  >  **создать**  >  **проект** , чтобы открыть диалоговое окно **Новый проект** . Если в интегрированной среде разработки настроено использование параметров Visual Basic разработки, в строке меню выберите **файл**  >  **создать проект**.

2. Разверните узел **SharePoint** под управлением **Visual C#** или **Visual Basic**, а затем выберите узел **2010** .

3. Выберите шаблон **Импорт пакета решения SharePoint 2010** в области **шаблоны** , оставьте имя проекта WspImportProject1, а затем нажмите кнопку **ОК** .

    Откроется **Мастер настройки SharePoint** .

4. На странице **Укажите сайт и уровень безопасности для отладки** введите [!INCLUDE[TLA2#tla_url](../sharepoint/includes/tla2sharptla-url-md.md)] для второго дочернего сайта SharePoint, созданного ранее. На этот дочерний сайт будет добавлен новый элемент настраиваемого поля http://<em>System Name</em>/columntest2.

5. В разделе **что такое уровень доверия для этого решения SharePoint?** оставьте выбранным вариант **Развернуть как изолированное решение**.

6. На странице **Указание нового источника проекта** перейдите к расположению в системе, где ранее был сохранен *WSP* -файл, а затем нажмите кнопку **Далее** .

   > [!NOTE]
   > При нажатии кнопки **Готово** на этой странице будут импортированы все доступные элементы в *WSP* -файле.

7. В поле **выберите элементы для импорта** снимите флажки в списке за исключением **тестового столбца**, а затем нажмите кнопку **Готово** .

    Поскольку список содержит много элементов, можно выбрать **сочетание клавиш CTRL** + **A** , чтобы выбрать все элементы в списке, нажать клавишу пробел, чтобы снять все флажки, а затем установить только флажок рядом с элементом **столбца теста** .

    После завершения операции импорта создается новый проект с именем **WspImportProject1** , содержащий папку с именем **Fields**. В этой папке находится **Тестовый столбец** пользовательского сайта и его файл определения *Elements.xml*.

## <a name="deploy-the-project"></a>Развертывание проекта
 Наконец, разверните **WspImportProject1** на втором дочернем сайте SharePoint, созданном ранее, чтобы просмотреть столбец настраиваемого сайта.

### <a name="to-deploy-the-project"></a>Развертывание проекта

1. В выберите [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] клавишу **F5** , чтобы развернуть и запустить проект импорта *WSP* .

2. На сайте SharePoint откройте меню **действия сайта** и выберите пункт **Параметры сайта** , чтобы отобразить страницу Параметры сайта.

3. В разделе **коллекции** выберите ссылку **столбцы сайта** .

4. Прокрутите вниз до раздела **Настраиваемые столбцы** .

     Обратите внимание, что в списке отображается пользовательский столбец сайта, импортированный из первого сайта SharePoint.

## <a name="see-also"></a>См. также раздел
- [Импорт элементов с существующего сайта SharePoint](../sharepoint/importing-items-from-an-existing-sharepoint-site.md)
- [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)
- [Создание многократно используемых элементов управления для веб-частей или страниц приложений](../sharepoint/creating-reusable-controls-for-web-parts-or-application-pages.md)
