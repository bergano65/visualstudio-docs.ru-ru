---
title: "Пошаговое руководство: Создание внешнего списка в SharePoint с помощью бизнес-данных | Документы Microsoft"
ms.custom: 
ms.date: 02/02/2017
ms.reviewer: 
ms.suite: 
ms.technology:
- office-development
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- Business Data Connectivity service [SharePoint development in Visual Studio], business data in a Web Part
- BDC [SharePoint development in Visual Studio], external list
- Business Data Connectivity service [SharePoint development in Visual Studio], business data in a SharePoint list
- BDC [SharePoint development in Visual Studio], business data in a SharePoint list
- BDC [SharePoint development in Visual Studio], business data in a Web Part
- BDC [SharePoint development in Visual Studio], entity backed list
- Business Data Connectivity service [SharePoint development in Visual Studio], entity backed list
- Business Data Connectivity service [SharePoint development in Visual Studio], external list
author: TerryGLee
ms.author: tglee
manager: ghogen
ms.workload:
- office
ms.openlocfilehash: 49c43e3add54b3ba3f584af6feda630a8d1ad526
ms.sourcegitcommit: 8cbe6b38b810529a6c364d0f1918e5c71dee2c68
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/28/2018
---
# <a name="walkthrough-creating-an-external-list-in-sharepoint-by-using-business-data"></a>Пошаговое руководство. Создание внешнего списка в SharePoint с помощью бизнес-данных

Служба бизнес-данным (BDC) позволяет отображать бизнес-данных из серверных приложений, веб-служб и баз данных в SharePoint.

В этом пошаговом руководстве показано, как создать модель для службы BDC, которая возвращает сведения о контактах в образце базы данных. Затем создается внешнего списка в SharePoint с помощью этой модели.

В данном пошаговом руководстве рассмотрены следующие задачи:

- Создание проекта.
- Добавление сущности в модель.
- Добавление метода поиска.
- Добавление конкретного метода поиска.
- Тестирование проекта.

## <a name="prerequisites"></a>Предварительные требования

Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.

- Поддерживаемые выпуски Windows и SharePoint. Дополнительные сведения см. в разделе [требования к разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).

- Доступ к базе данных AdventureWorks. Дополнительные сведения об установке базы данных AdventureWorks см. в разделе [образцов баз данных SQL Server](http://go.microsoft.com/fwlink/?LinkID=117483).

## <a name="creating-a-project-that-contains-a-bdc-model"></a>Создание проекта, содержащего модель подключения к бизнес-данным

1. В строке меню в Visual Studio выберите **файл**, **New**, **проекта**.

     Откроется диалоговое окно **Новый проект** .

2. В рамках одного **Visual C#** или **Visual Basic**, разверните **SharePoint** узел, а затем выберите **2010** элемента.

3. В **шаблоны** области, выберите **проект SharePoint 2010**, назовите проект **AdventureWorksTest**и нажмите кнопку **ОК** кнопки .

     **Мастер настройки SharePoint** отображается. В этом мастере можно указать сайт, который будет использоваться для отладки проекта и задать уровень доверия решения.

4. Выберите **развернуть как решение фермы** , чтобы задать уровень доверия.

5. Выберите **Готово** кнопку, чтобы принять локальный сайт SharePoint по умолчанию.

6. В **обозревателе решений**, выберите узел проекта SharePoint.

7. В строке меню выберите **проекта**, **Добавление нового элемента**.

     Откроется диалоговое окно **Добавление нового элемента**.

8. В **шаблоны** области, выберите **модель подключения к данным предприятия (только для решения фермы)**, назовите проект **AdventureWorksContacts**и нажмите кнопку **Добавить** кнопки.

## <a name="adding-data-access-classes-to-the-project"></a>Добавление классов доступа к данным в проект

1. В строке меню выберите **средства**, **подключение к базе данных**.

     **Добавить подключение** откроется диалоговое окно.

2. Добавьте подключение к базе данных SQL Server AdventureWorks.

     Дополнительные сведения см. в разделе [Добавить/изменить подключение (Microsoft SQL Server)](http://msdn.microsoft.com/fa400910-26c3-4df7-b9d1-115e688b4ea3).

3. В области **Обозреватель решений**выберите узел проекта.

4. В строке меню выберите **проекта**, **Добавление нового элемента**.

5. В **установленные шаблоны** области, выберите **данные** узла.

6. В **шаблоны** области, выберите **LINQ to SQL Classes**.

7. В **имя** укажите **AdventureWorks**, а затем выберите **добавить** кнопки.

     В проект будет добавлен файл .dbml, и откроется реляционный конструктор объектов.

8. В строке меню выберите **представление**, **обозревателя серверов**.

9. В **обозревателя серверов**, разверните узел, представляющий образца базы данных AdventureWorks и разверните **таблиц** узла.

10. Добавить **контакт (пользователь)** таблицы в конструктор O/R.

     Создается класс сущностей и появляется в области конструктора. Класс сущностей имеет свойства, которые сопоставляются со столбцами в таблице Контакт (пользователь).

## <a name="removing-the-default-entity-from-the-bdc-model"></a>Удаление сущности по умолчанию из модели BDC

**Модель подключения к бизнес-данным** проект добавляет сущность по умолчанию с именем Entity1 модели. Удалите эту сущность. Впоследствии будет добавить новую сущность. Начиная с пустой модели сокращает количество шагов, необходимых для выполнения данного пошагового руководства.

1. В **обозревателе решений**, разверните **BdcModel1** узел, а затем откройте файл BdcModel1.bdcm.

2. Файл модели Business Data Connectivity откроется в конструкторе BDC.

3. В конструкторе откройте контекстное меню для **Entity1**, а затем выберите **удалить**.

4. В **обозревателе решений**, откройте контекстное меню для Entity1.vb (в Visual Basic) или Entity1.cs (в C#) и нажмите кнопку **удалить**.

5. Откройте контекстное меню для Entity1Service.vb (в Visual Basic) или Entity1Service.cs (в C#), а затем выберите **удалить**.

## <a name="adding-an-entity-to-the-model"></a>Добавление сущности в модель

Добавление сущности в модель. Можно добавлять сущности из Visual Studio **элементов** в конструктор BDC.

1. В строке меню выберите **Вид**, **Панель элементов**.

2. На **BusinessDataConnectivity** вкладке **элементов**, добавьте **сущности** в конструктор BDC.

     В конструкторе откроется новая сущность. Visual Studio добавляет файл, который является именем EntityService.vb (в Visual Basic) или EntityService.cs (в C#) в проект.

3. В строке меню выберите **представление**, **свойства**, **окна**.

4. В **свойства** задайте **имя** значение свойства **контакт**.

5. В конструкторе откройте контекстное меню для сущности, выберите **добавить**, а затем выберите **идентификатор**.

     В сущности отобразится новый идентификатор.

6. В **свойства** окна, измените имя идентификатора, **ContactID**.

7. В **имя типа** выберите **System.Int32**.

## <a name="adding-a-specific-finder-method"></a>Добавление конкретного метода поиска

Чтобы включить отображение конкретных контактов в службе BDC, необходимо добавить конкретный метод поиска. Служба BDC вызывает конкретный метод поиска, когда пользователь выбирает элемент в списке и затем выбирает **элемента представления** кнопки на ленте.

Добавление сущности Contact конкретный метод поиска с помощью **Подробности метода BDC** окна. Для возвращения определенной сущности, добавьте код в метод.

1. В конструкторе BDC выберите **контакт** сущности.

2. В строке меню выберите **представление**, **другие окна**, **Подробности метода BDC**.

     Откроется окно Подробности метода BDC.

3. В **добавьте метод** выберите **создать конкретный метод поиска**.

     Visual Studio добавляет следующие элементы модели. Эти элементы появляются в **Подробности метода BDC** окна.

    - Метод с именем ReadItem.

    - Входной параметр для метода.

    - Возвращаемый параметр для метода.

    - Дескриптор типа для каждого параметра.

    - Экземпляр метода для метода.

4. В **Подробности метода BDC** окна, откройте список, отображаемый для **контакт** дескриптор типа, а затем выберите **изменить**.

     **Обозреватель BDC** открывает и обеспечивает иерархическое представление модели.

5. В **свойства** окна, откройте список рядом с **TypeName** свойства, выберите **текущий проект** , а затем выберите **контакт**свойство.

6. В **Обозреватель BDC**, откройте контекстное меню **контакт**, а затем выберите **добавить дескриптор типа**.

     Дескриптор типа с именем **TypeDescriptor1** отображается в **Обозреватель BDC**.

7. В **свойства** задайте **имя** значение свойства **ContactID**.

8. Откройте список рядом с **TypeName** свойства, а затем выберите **Int32**.

9. Откройте список рядом с **идентификатор** свойства, а затем выберите **ContactID**.

10. Повторите шаг 6, чтобы создать дескриптор типа для каждого из указанных ниже полей.

    |name|Имя типа|
    |----------|---------------|
    |FirstName|System.String|
    |LastName|System.String|
    |Номер телефона|System.String|
    |emailAddress|System.String|
    |EmailPromotion|System.Int32|
    |NameStyle|System.Boolean|
    |PasswordHash|System.String|
    |PasswordSalt|System.String|

11. В конструкторе BDC в **контакт** сущности, откройте **ReadItem** метод.

     В редакторе кода откроется файл кода службы контактов.

12. В `ContactService` класса, замените `ReadItem` метод следующим кодом. Этот код выполняет следующие задачи:

    - Извлекает запись из таблицы Contact базы данных AdventureWorks.

    - Возвращает сущности Contact службы BDC.

    > [!NOTE]
    > Замените значение `ServerName` поле с именем сервера.

     [!code-csharp[SP_BDC#3](../sharepoint/codesnippet/CSharp/SP_BDC/bdcmodel1/contactservice.cs#3)]
     [!code-vb[SP_BDC#3](../sharepoint/codesnippet/VisualBasic/sp_bdc/bdcmodel1/contactservice.vb#3)]

## <a name="adding-a-finder-method"></a>Добавление метода поиска

Чтобы включить отображение списка контактов в службе BDC, необходимо добавить метод поиска. Добавление метода Finder к сущности Contact с помощью **Подробности метода BDC** окна. Для возврата коллекции сущностей в службу BDC, добавьте код в метод.

1. В конструкторе BDC выберите **контакт** сущности.

2. В **Подробности метода BDC** сверните **ReadItem** узла.

3. В **добавьте метод** в разделе **ReadList** метод, выберите **создать метод поиска**.

     Visual Studio добавляет метод, возвращаемый параметр и дескриптор типа.

4. В конструкторе BDC в **контакт** сущности, откройте **ReadList** метод.

     В редакторе кода откроется файл кода службы контактов.

5. В `ContactService` класса, замените `ReadList` метод следующим кодом. Этот код выполняет следующие задачи:

    - Извлекает данные из таблицы Contacts базы данных AdventureWorks.

    - Возвращает список сущностей, обратитесь в службу BDC.

    > [!NOTE]
    > Замените значение `ServerName` поле с именем сервера.

     [!code-csharp[SP_BDC#2](../sharepoint/codesnippet/CSharp/SP_BDC/bdcmodel1/contactservice.cs#2)]
     [!code-vb[SP_BDC#2](../sharepoint/codesnippet/VisualBasic/sp_bdc/bdcmodel1/contactservice.vb#2)]

## <a name="testing-the-project"></a>Тестирование проекта

При запуске проекта открывается сайт SharePoint, и Visual Studio добавляет модель службы Business Data Connectivity. Создание внешнего списка в SharePoint, который ссылается на сущность контакта. В списке будут показаны данные по контактов в базе данных AdventureWorks.

> [!NOTE]
> Может потребоваться изменить параметры безопасности в SharePoint для отладки решения. Дополнительные сведения см. в разделе [проектирование модели подключения к бизнес-данным](../sharepoint/designing-a-business-data-connectivity-model.md).

1. Нажмите клавишу **F5**.

     Откроется сайт SharePoint.

2. На **действия сайта** меню, выберите **Дополнительно** команды.

3. На **создать** выберите **внешний список** шаблона и выберите **создать** кнопки.

4. Имя пользовательского списка **контактов**.

5. Нажмите кнопку обзора рядом **внешнего типа контента** поля.

6. В **внешнего содержимого диалогового окна Выбор типа** диалогового окна выберите **AdventureWorksContacts.BdcModel1.Contact** элемента, а затем выберите **создать** кнопки.

     SharePoint создает внешний список, содержащий контакты из базы данных AdventureWorks.

7. Чтобы протестировать конкретный метод поиска, выберите контакт в списке.

8. На ленте выберите **элементы** , а затем выберите **элемента представления** команды.

     В форме отобразятся подробности выбранного контакта.

## <a name="next-steps"></a>Следующие шаги

Дополнительные сведения о разработке моделей для службы BDC в SharePoint в следующих разделах:

- [Как: Добавление метода Creator](../sharepoint/how-to-add-a-creator-method.md).
- [Как: Добавление метода Updater](../sharepoint/how-to-add-an-updater-method.md).
- [Как: Добавление метода Deleter](../sharepoint/how-to-add-a-deleter-method.md).

## <a name="see-also"></a>См. также

[Проектирование модели подключения к бизнес-данным](../sharepoint/designing-a-business-data-connectivity-model.md)  
[Создание модели подключения к бизнес-данным](../sharepoint/creating-a-business-data-connectivity-model.md)  
[Общие сведения о средствах разработки моделей подключения к бизнес-данным](../sharepoint/bdc-model-design-tools-overview.md)  
[Интеграция бизнес-данных в SharePoint](../sharepoint/integrating-business-data-into-sharepoint.md)
