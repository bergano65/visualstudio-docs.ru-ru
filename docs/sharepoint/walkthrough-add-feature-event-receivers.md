---
title: Пошаговое руководство. Добавление приемников событий компонентов | Документация Майкрософт
description: В этом пошаговом руководстве добавлены приемники событий компонентов, которые являются методами, которые выполняются при установке, активации, деактивации или удалении компонента SharePoint.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, advanced packaging tools
- SharePoint development in Visual Studio, event receivers
- SharePoint development in Visual Studio, feature event receivers
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: c9d50de6630a813a9c8c7a075af6f921608fcd93
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99851534"
---
# <a name="walkthrough-add-feature-event-receivers"></a>Пошаговое руководство. Добавление приемников событий компонентов
Приемники событий компонентов — это методы, которые выполняются при возникновении одного из следующих событий, связанных с функциями, в SharePoint.

- Устанавливается компонент.

- Активируется компонент.

- Функция деактивируется.

- Удаляется компонент.

В этом пошаговом руководстве показано, как добавить приемник событий в компонент в проекте SharePoint. В нем демонстрируются следующие задачи:

- Создание пустого проекта с приемником событий компонента.

- Обработка метода **FeatureDeactivating** .

- Использование объектной модели проекта SharePoint для добавления объявления в список извещений.

  [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]

## <a name="prerequisites"></a>Предварительные требования
 Для выполнения этого пошагового руководства требуются следующие компоненты:

- Поддерживаемые редакции Microsoft Windows и SharePoint.

- приведенному.

## <a name="create-a-feature-event-receiver-project"></a>Создание проекта приемника событий компонента
 Сначала создайте проект, содержащий приемник событий компонента.

#### <a name="to-create-a-project-with-a-feature-event-receiver"></a>Создание проекта с приемником событий компонента

1. В строке меню выберите **файл**  >  **создать**  >  **проект** , чтобы открыть диалоговое окно **Новый проект** .

2. Разверните узел **SharePoint** под управлением **Visual C#** или **Visual Basic**, а затем выберите узел **2010** .

3. В области **шаблоны** выберите шаблон **проекта SharePoint 2010** .

     Этот тип проекта предназначен для приемников событий компонентов, поскольку для них не существует шаблона проекта.

4. В поле **имя** введите **феатуривттест**, а затем нажмите кнопку **ОК** , чтобы открыть **Мастер настройки SharePoint**.

5. На странице **Укажите сайт и уровень безопасности для отладки** введите URL-адрес сайта SharePoint Server, на который нужно добавить новый настраиваемый элемент поля, или используйте расположение по умолчанию (http:// \<*system name*> /).

6. В разделе **что такое уровень доверия для этого решения SharePoint?** выберите параметр **Развернуть как решение фермы** .

     Дополнительные сведения о изолированных решениях и решениях фермы см. в статье [рекомендации по изолированным решениям](../sharepoint/sandboxed-solution-considerations.md).

7. Нажмите кнопку **Готово** , а затем Обратите внимание, что в узле **компоненты** отображается функция с именем Feature1.

## <a name="add-an-event-receiver-to-the-feature"></a>Добавление приемника событий в компонент
 Затем добавьте в компонент приемник событий и добавьте код, который выполняется при деактивации компонента.

#### <a name="to-add-an-event-receiver-to-the-feature"></a>Добавление приемника событий в компонент

1. Откройте контекстное меню узла компоненты и выберите пункт **Добавить компонент** , чтобы создать компонент.

2. В узле **компоненты** откройте контекстное меню для **Feature1** и выберите **Добавить приемник событий** , чтобы добавить приемник событий в компонент.

     При этом в Feature1 добавляется файл кода. В этом случае он называется либо *Feature1.EventReceiver.CS* , либо *Feature1. евентрецеивер. vb* в зависимости от языка разработки проекта.

3. Если проект написан на [!INCLUDE[csprcs](../sharepoint/includes/csprcs-md.md)], добавьте следующий код в начало приемника событий, если он еще не находится там:

     [!code-csharp[SP_FeatureEvt#1](../sharepoint/codesnippet/CSharp/featureevttest2/features/feature1/feature1.eventreceiver.cs#1)]

4. Класс приемника событий содержит несколько закомментированных методов, действующих как события. Замените метод **FeatureDeactivating** следующим:

     [!code-vb[SP_FeatureEvt#2](../sharepoint/codesnippet/VisualBasic/featureevt2vb/features/feature1/feature1.eventreceiver.vb#2)]
     [!code-csharp[SP_FeatureEvt#2](../sharepoint/codesnippet/CSharp/featureevttest2/features/feature1/feature1.eventreceiver.cs#2)]

## <a name="test-the-feature-event-receiver"></a>Тестирование приемника событий компонента
 Затем отключите функцию, чтобы проверить, выводит ли метод **FeatureDeactivating** объявление в список объявлений SharePoint.

#### <a name="to-test-the-feature-event-receiver"></a>Тестирование приемника событий компонента

1. Задайте для свойства **Активная конфигурация развертывания** проекта значение **без активации**.

     Задание этого свойства предотвращает активацию компонента в SharePoint и позволяет отлаживать приемники событий компонентов. Дополнительные сведения см. в разделе [Отладка решений SharePoint](../sharepoint/debugging-sharepoint-solutions.md).

2. Нажмите клавишу **F5** , чтобы запустить проект и развернуть его в SharePoint.

3. В верхней части веб-страницы SharePoint откройте меню **действия сайта** и выберите пункт **Параметры сайта**.

4. В разделе **действия сайта** страницы **Параметры сайта** выберите ссылку **Управление компонентами сайта** .

5. На странице **компоненты** нажмите кнопку **активировать** рядом с компонентом **Feature1 феатуривттест** .

6. На странице **компоненты** нажмите кнопку **деактивировать** рядом с компонентом **Feature1 феатуривттест** , а затем щелкните ссылку **деактивировать это подтверждение функции** , чтобы отключить эту функцию.

7. Нажмите кнопку **Главная** .

     Обратите внимание, что объявление появляется в списке **извещений** после отключения компонента.

## <a name="see-also"></a>См. также раздел

- [Практическое руководство. Создание приемника событий](../sharepoint/how-to-create-an-event-receiver.md)
- [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)