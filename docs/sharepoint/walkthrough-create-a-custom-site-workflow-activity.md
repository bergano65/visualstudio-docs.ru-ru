---
title: 'Пошаговое руководство: Создание пользовательского рабочего процесса действия сайта | Документация Майкрософт'
ms.custom: ''
ms.date: 02/02/2017
ms.technology:
- office-development
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- custom workflow activities [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, custom workflow activities
- site workflows [SharePoint development in Visual Studio]
- workflow activities [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, site workflows
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: b366db32a4caadf0f454f893d8f98e2d288f2390
ms.sourcegitcommit: 55f7ce2d5d2e458e35c45787f1935b237ee5c9f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2018
ms.locfileid: "42627361"
---
# <a name="walkthrough-create-a-custom-site-workflow-activity"></a>Пошаговое руководство: Создание пользовательского рабочего процесса действия сайта
  В этом пошаговом руководстве демонстрируется создание настраиваемого действия для рабочих процессов на уровне сайта с помощью [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]. (Для всего сайта, а не только список на сайте применяются рабочие процессы уровня веб-сайта). Пользовательское действие создает резервную копию списка извещений и затем копирует содержимое списка извещений в него.  
  
 В этом пошаговом руководстве описаны следующие задачи.  
  
-   Создание рабочего процесса уровня веб-сайта.  
  
-   Создание пользовательского действия рабочего процесса.  
  
-   Создание и удаление списка SharePoint.  
  
-   Копирование элементов из одного списка в другой.  
  
-   Отображение списка на панели быстрого запуска.  
  
 [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]  
  
## <a name="prerequisites"></a>Предварительные требования  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые выпуски [!INCLUDE[TLA#tla_win](../sharepoint/includes/tlasharptla-win-md.md)] и SharePoint.
  
-   Visual Studio.  
  
## <a name="create-a-site-workflow-custom-activity-project"></a>Создание проекта настраиваемого действия рабочего процесса сайта
 Во-первых создайте проект и сохраним действия пользовательского рабочего процесса тестирования.  
  
#### <a name="to-create-a-site-workflow-custom-activity-project"></a>Создание проекта настраиваемого действия рабочего процесса сайта  
  
1.  В строке меню выберите **файл** > **New** > **проекта** для отображения **новый проект** диалоговое окно.  
  
2.  Разверните **SharePoint** расположенный в области **Visual C#** или **Visual Basic**, а затем выберите **2010** узла.  
  
3.  В **шаблоны** панели выберите **проект SharePoint 2010** шаблона.  
  
4.  В **имя** введите **AnnouncementBackup**, а затем выберите **ОК** кнопки.  
  
     **Мастер настройки SharePoint** отображается.  
  
5.  На **Укажите сайт и уровень безопасности для отладки** выберите **развернуть как решение фермы** переключатель, а затем выберите **Готово** кнопку, чтобы принять доверие уровень и сайт по умолчанию.  
  
     Этот шаг задается уровень доверия для решения фермы, единственным доступным параметром для проектов рабочих процессов.  
  
6.  В **обозревателе решений**, выберите узел проекта и затем в строке меню выберите **проекта** > **Добавление нового элемента**.  
  
7.  В группе **Visual C#** или **Visual Basic**, разверните **SharePoint** узел, а затем выберите **2010** узла.  
  
8.  В **шаблоны** панели выберите **последовательного рабочего процесса (только для решения фермы)** шаблона и нажмите кнопку **добавить** кнопки.  
  
     **Мастер настройки SharePoint** отображается.  
  
9. На **укажите имя рабочего процесса для отладки** странице, примите имя по умолчанию (AnnouncementBackup - Workflow1). Измените тип шаблона рабочего процесса на **рабочего процесса сайта**, а затем выберите **Далее** кнопки.  
  
10. Выберите **Готово** кнопку, чтобы Примите остальные значения по умолчанию.  
  
## <a name="add-a-custom-workflow-activity-class"></a>Добавьте класс настраиваемого рабочего процесса действия
 Добавьте класс в проект, содержащий код для пользовательского действия рабочего процесса.  
  
#### <a name="to-add-a-custom-workflow-activity-class"></a>Чтобы добавить класс настраиваемого рабочего процесса действия  
  
1.  В строке меню выберите **проекта** > **Добавление нового элемента** для отображения **Добавление нового элемента** диалоговое окно.  
  
2.  В **установленные шаблоны** представление в виде дерева, выберите **кода** узел и нажмите кнопку **класс** шаблон в списке шаблонов элементов проекта. Используйте имя по умолчанию Class1. Нажмите кнопку **Добавить** .  
  
3.  Замените весь код в Class1 следующим:  
  
     [!code-csharp[SP_AnnBackup#1](../sharepoint/codesnippet/CSharp/announcementbackup/class1.cs#1)]
     [!code-vb[SP_AnnBackup#1](../sharepoint/codesnippet/VisualBasic/announcementbackupvb/class1.vb#1)]  
  
4.  Сохраните проект и затем в строке меню выберите **построения** > **построить решение**.  
  
     Class1 отображается как настраиваемое действие в **элементов** на **компоненты AnnouncementBackup** вкладки.  
  
## <a name="add-the-custom-activity-to-the-site-workflow"></a>Добавить пользовательское действие рабочего процесса сайта
 Затем добавьте действие в рабочий процесс должен содержать пользовательский код.  
  
#### <a name="to-add-a-custom-activity-to-the-site-workflow"></a>Чтобы добавить пользовательское действие рабочего процесса сайта
  
1.  Откройте Workflow1 в конструкторе рабочих процессов в режиме конструктора.  
  
2.  Перетащите Class1 из **элементов** таким образом, чтобы оно помещалось под `onWorkflowActivated1` действия "или" открыть контекстное меню для Class1, выберите **копирования**, откройте контекстное меню для строки под `onWorkflowActivated1` действие, а затем выберите **вставить**.  
  
3.  Сохраните проект.  
  
## <a name="test-the-site-workflow-custom-activity"></a>Тестирование пользовательского действия рабочего процесса сайта
 Затем запустите проект и запуск рабочего процесса сайта. Пользовательское действие создает резервный список объявлений и копирует содержимое из текущего списка извещений в него. Код также проверяет, существует ли уже резервный список, перед их созданием. Если резервная копия уже существует, она удаляется. Код также добавляет ссылку на новый список на панели быстрого запуска на сайте SharePoint.  
  
#### <a name="to-test-the-site-workflow-custom-activity"></a>Для тестирования пользовательского действия рабочего процесса сайта  
  
1.  Выберите **F5** клавишу, чтобы запустить проект и его развертывания в SharePoint.  
  
2.  На панели быстрого запуска выберите **перечислены** ссылку, чтобы отобразить все списки, доступные на сайте SharePoint. Обратите внимание, что только один список объявлений с именем **объявления**.  
  
3.  В верхней части веб-страницы SharePoint, выберите **рабочие процессы сайта** ссылку.  
  
4.  В меню Пуск рабочего процесса новый раздел, выберите **AnnouncementBackup - Workflow1** ссылку. Это запускает рабочий процесс сайта и выполняет код этого пользовательского действия.  
  
5.  На панели быстрого запуска выберите **резервного копирования объявления** ссылку. Обратите внимание, что все объявления, которые содержатся в **объявления** списка были скопированы в этот список.  
  
## <a name="see-also"></a>См. также
 [Практическое: Создание приемника событий](../sharepoint/how-to-create-an-event-receiver.md)   
 [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)  
  
