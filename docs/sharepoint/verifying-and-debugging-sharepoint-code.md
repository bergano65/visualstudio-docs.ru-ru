---
title: Проверка и отладка кода SharePoint | Документация Майкрософт
description: Проверка и отладка кода SharePoint. Используйте IntelliTrace для проверки прошлых событий и текущего состояния в решении. Используйте модульное тестирование, чтобы обеспечить правильную работу методов.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- unit testing [SharePoint development in Visual Studio]
- IntelliTrace [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, IntelliTrace
- SharePoint development in Visual Studio, unit testing
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: d406afbc0a8506262f1bdc17310802b7f41a931a
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99892142"
---
# <a name="verify-and-debug-sharepoint-code"></a>Проверка и отладка кода SharePoint
С помощью IntelliTrace и модульного тестирования вы сможете гораздо легче отлаживать свои решения SharePoint и проверять, что каждый метод в них работает правильно. Эти функции для проектов SharePoint в Visual Studio можно использовать, выполнив те же процедуры, что и для других типов проектов.

## <a name="intellitrace"></a>IntelliTrace
С помощью IntelliTrace можно не только определять текущее состояние своего решения SharePoint, но также отслеживать прошедшие события и контекст, в котором эти события произошли. В своем решении SharePoint можно переходить назад и вперед к различным моментам во времени, в которых произошли события, и просматривать состояния и значения переменных в каждый момент времени. С помощью динамических переходов можно более быстро и легко отлаживать решения SharePoint без установки нескольких точек останова. Можно также сохранить сеанс отладки в файл журнала IntelliTrace (*. iTrace*), открыть его позже в Visual Studio Enterprise и выполнить отладку после сбоя. *ITrace* – файл содержит подробные сведения о том, когда и где возникли определенные ошибки SharePoint, чтобы можно было легко определить причину ошибок. Сведения в *iTrace* -файле представляют собой подмножество полного журнала ошибок, создаваемого унифицированной системой ведения журналов (ULS) в SharePoint. Эти сведения включают события, относящихся к SharePoint, например при открытии или закрытии профиля пользователя и при загрузке свойств в проекте SharePoint, их чтении или изменении. Можно настроить записываемые события IntelliTrace. Дополнительные сведения см. в разделе [Использование сохраненных данных IntelliTrace](../debugger/using-saved-intellitrace-data.md).

При возникновении ошибки в SharePoint, диалоговое окно ошибки указывает идентификатор "идентификатор корреляции" для конкретной ошибки. Идентификаторы корреляции также можно получить из событий, перечисленных в *iTrace* – файле. Чтобы отобразить список всех событий, произошедших с данным ИДЕНТИФИКАТОРом корреляции, можно ввести идентификатор в разделе **анализ** на странице сводки IntelliTrace. В этом разделе вы можете выбрать, следует ли показывать только имена произошедших событий или их имена вместе со сведениями о вызовах, к примеру: имя функции, точки выхода и точки входа, параметры и возвращаемые значения.

События Visual Studio можно получить в IntelliTrace, нажав клавишу **F5** . Для получения событий, относящихся к SharePoint, необходимо собирать данные IntelliTrace в решениях SharePoint с помощью Microsoft Monitoring Agent. Это средство собирает данные IntelliTrace и создает *iTrace* файлы для приложений, развернутых за пределами Visual Studio. Дополнительные сведения см. в статьях [функции IntelliTrace](../debugger/intellitrace-features.md) и [Использование автономного сборщика IntelliTrace](../debugger/using-the-intellitrace-stand-alone-collector.md).

## <a name="unit-test"></a>Модульный тест
Вы можете легко находить ошибки в коде, выполняя модульное тестирование, при котором вы пишете и запускаете код теста внутри методов теста. Эти методы содержат пустые переменные и оператор Assert, которые можно использовать для проверки логики и функциональности проекта на основе объектной модели SharePoint. Дополнительные сведения см. в статье [Модульное тестирование кода](../test/unit-test-your-code.md).

### <a name="support-for-microsoft-fakes-framework"></a>Поддержка инфраструктуры подмышлений Майкрософт
Проекты SharePoint поддерживают Microsoft Fakes, платформу изоляции, в которой можно создать тестовые заглушки и оболочки на основе делегатов (в приложениях на основе платформы .NET Framework). С помощью платформы Fakes вы можете создавать, поддерживать и встраивать заглушки в модульные тесты. Эти заглушки и оболочки изолируют модульные тесты от среды. Вы можете создавать заглушки для тестирования кода, который использует интерфейсы или незапечатанные классы с переопределяемыми методами. Можно создавать оболочки для перенаправления жестко заданных вызовов к запечатанным классам со статическими или непереопределяемыми методами альтернативной реализации оболочки. Вы также можете использовать делегаты с заглушками и оболочками для динамической настройки поведения отдельных членов заглушки. Дополнительные сведения см. в разделе изоляция тестируемого [кода с помощью Подмышлений Майкрософт](../test/isolating-code-under-test-with-microsoft-fakes.md).

## <a name="related-articles"></a>Связанные статьи

|Заголовок|Описание|
|-----------|-----------------|
|[IntelliTrace](../debugger/intellitrace.md)|Описаны более простые способы отладки решений Visual Studio с помощью IntelliTrace.|
|[Пошаговое руководство. Отладка приложения SharePoint с помощью IntelliTrace](../sharepoint/walkthrough-debugging-a-sharepoint-application-by-using-intellitrace.md)|Описывает использование IntelliTrace для поиска ошибок кода в проекте SharePoint.|
|[Модульное тестирование кода](../test/unit-test-your-code.md)|Описывает, как найти логические ошибки в коде с помощью модульных тестов.|

## <a name="see-also"></a>См. также раздел

- [Улучшение качества кода](../test/improve-code-quality.md)