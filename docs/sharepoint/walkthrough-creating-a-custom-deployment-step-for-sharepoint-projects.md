---
title: Создание настраиваемого шага развертывания для проектов SharePoint
description: В этом пошаговом руководстве описано, как создать настраиваемый шаг развертывания для обновления решений проектов SharePoint на сервере, на котором работает SharePoint.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: how-to
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint commands
- SharePoint development in Visual Studio, extending deployment
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 8d42726cddb0565af66e161b41c16c94cfe2cb2b
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99839140"
---
# <a name="walkthrough-create-a-custom-deployment-step-for-sharepoint-projects"></a>Пошаговое руководство. Создание настраиваемого шага развертывания для проектов SharePoint
  При развертывании проекта SharePoint Visual Studio выполняет ряд шагов по развертыванию в определенном порядке. Visual Studio включает множество встроенных шагов по развертыванию, но вы также можете создать собственный.

 В этом пошаговом руководстве вы создадите настраиваемый шаг развертывания для обновления решений на сервере, на котором работает SharePoint. Visual Studio включает встроенные этапы развертывания для многих задач, таких как отзыв или добавление решений, но не включает шаг развертывания для обновления решений. По умолчанию при развертывании решения SharePoint Visual Studio сначала отзывает решение (если оно уже развернуто), а затем повторно развертывает все решение. Дополнительные сведения о встроенных шагах развертывания см. в разделе [развертывание, публикация и обновление пакетов решений SharePoint](../sharepoint/deploying-publishing-and-upgrading-sharepoint-solution-packages.md).

 В этом пошаговом руководстве описаны следующие задачи.

- Создание расширения Visual Studio, которое выполняет две основные задачи:

  - Расширение определяет настраиваемый шаг развертывания для обновления решений SharePoint.

  - Расширение создает расширение проекта, которое определяет новую конфигурацию развертывания, которая представляет собой набор шагов развертывания, выполняемых для данного проекта. Новая конфигурация развертывания включает этап настраиваемого развертывания и несколько встроенных шагов развертывания.

- Создайте две настраиваемые команды SharePoint, которые вызывает сборка расширения. Команды SharePoint — это методы, которые могут вызываться сборками расширения для использования API-интерфейсов в серверной объектной модели для SharePoint. Дополнительные сведения см. в разделе [Вызов объектных моделей SharePoint](../sharepoint/calling-into-the-sharepoint-object-models.md).

- Создание пакета расширения Visual Studio (VSIX) для развертывания обеих сборок.

- Тестирование нового шага развертывания.

## <a name="prerequisites"></a>Предварительные требования
 Для выполнения этого пошагового руководства на компьютере разработчика потребуются следующие компоненты:

- Поддерживаемые выпуски Windows, SharePoint и Visual Studio.

- Пакет SDK для Visual Studio. В этом пошаговом руководстве используется шаблон **проекта VSIX** в пакете SDK для создания пакета VSIX для развертывания расширения. Дополнительные сведения см. [в разделе Расширение инструментов SharePoint в Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md).

  Знания следующих концепций полезны, но не требуются для выполнения этого пошагового руководства.

- Использование серверной объектной модели для SharePoint. Дополнительные сведения см. [в разделе Использование объектной модели Server-Side SharePoint Foundation](/previous-versions/office/developer/sharepoint-2010/ee538251(v=office.14)).

- Решения SharePoint. Дополнительные сведения см. в разделе [Общие сведения о решениях](/previous-versions/office/developer/sharepoint-2010/aa543214(v=office.14)).

- Обновление решений SharePoint. Дополнительные сведения см. [в разделе Обновление решения](/previous-versions/office/developer/sharepoint-2010/aa543659(v=office.14)).

## <a name="create-the-projects"></a>Создание проектов
 Для выполнения этого пошагового руководства необходимо создать три проекта:

- Проект VSIX для создания пакета VSIX для развертывания расширения.

- Проект библиотеки классов, реализующий расширение. Этот проект должен быть предназначен для платформа .NET Framework 4,5.

- Проект библиотеки классов, который определяет пользовательские команды SharePoint. Этот проект должен быть предназначен для платформа .NET Framework 3,5.

  Начните пошаговое руководство, создав проекты.

#### <a name="to-create-the-vsix-project"></a>Создание проекта VSIX

1. Запустите среду [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].

2. В строке меню выберите **Файл** > **Создать** > **Проект**.

3. В диалоговом окне **Новый проект** разверните узлы **Visual C#** или **Visual Basic** , а затем выберите узел **расширяемость** .

    > [!NOTE]
    > Узел **расширяемости** доступен только при установке пакета SDK для Visual Studio. Дополнительные сведения см. в разделе Предварительные требования ранее в этом разделе.

4. В верхней части диалогового окна выберите **платформа .NET Framework 4,5** в списке версий платформа .NET Framework.

5. Выберите шаблон **проекта VSIX** , присвойте проекту имя **упградедеплойментстеп**, а затем нажмите кнопку **ОК** .

     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Добавляет проект **упградедеплойментстеп** в **Обозреватель решений**.

#### <a name="to-create-the-extension-project"></a>Создание проекта расширения

1. В **Обозреватель решений** откройте контекстное меню узла решения упградедеплойментстеп, выберите **Добавить**, а затем выберите **Новый проект**.

2. В диалоговом окне **Новый проект** разверните узлы **Visual C#** или **Visual Basic** , а затем выберите узел **Windows** .

3. В верхней части диалогового окна выберите **платформа .NET Framework 4,5** в списке версий платформа .NET Framework.

4. Выберите шаблон проекта **Библиотека классов** , назовите проект **деплойментстепекстенсион**, а затем нажмите кнопку **ОК** .

     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Добавляет проект **деплойментстепекстенсион** в решение и открывает файл кода Class1 по умолчанию.

5. Удалите файл кода Class1 из проекта.

#### <a name="to-create-the-sharepoint-command-project"></a>Создание командного проекта SharePoint

1. В **Обозреватель решений** откройте контекстное меню узла решения упградедеплойментстеп, выберите **Добавить**, а затем выберите **Новый проект**.

2. В диалоговом окне **Новый проект** разверните узел **Visual C#** или **Visual Basic**, а затем выберите узел **Windows** .

3. В верхней части диалогового окна выберите **платформа .NET Framework 3,5** в списке версий платформа .NET Framework.

4. Выберите шаблон проекта **Библиотека классов** , назовите проект **шарепоинткоммандс**, а затем нажмите кнопку **ОК** .

     Visual Studio добавит проект **шарепоинткоммандс** в решение и откроет файл кода Class1 по умолчанию.

5. Удалите файл кода Class1 из проекта.

## <a name="configure-the-projects"></a>Настройка проектов
 Перед написанием кода для создания настраиваемого шага развертывания необходимо добавить файлы кода и ссылки на сборки, и необходимо настроить проекты.

#### <a name="to-configure-the-deploymentstepextension-project"></a>Настройка проекта Деплойментстепекстенсион

1. В проекте **деплойментстепекстенсион** добавьте два файла кода со следующими именами:

    - упградестеп

    - деплойментконфигуратионекстенсион

2. Откройте контекстное меню проекта Деплойментстепекстенсион и выберите команду **Добавить ссылку**.

3. На вкладке " **платформа** " установите флажок для сборки System. ComponentModel. композиция.

4. На вкладке **расширения** установите флажок для сборки Microsoft. VisualStudio. SharePoint, а затем нажмите кнопку **ОК** .

#### <a name="to-configure-the-sharepointcommands-project"></a>Настройка проекта Шарепоинткоммандс

1. В проекте **шарепоинткоммандс** добавьте файл кода с именем Commands.

2. В **Обозреватель решений** откройте контекстное меню в узле проекта **шарепоинткоммандс** и выберите команду **Добавить ссылку**.

3. На вкладке **расширения** установите флажки для следующих сборок, а затем нажмите кнопку **ОК** .

    - Microsoft. SharePoint

    - Microsoft. VisualStudio. SharePoint. Commands

## <a name="define-the-custom-deployment-step"></a>Определение настраиваемого шага развертывания
 Создайте класс, определяющий шаг развертывания обновления. Чтобы определить шаг развертывания, класс реализует <xref:Microsoft.VisualStudio.SharePoint.Deployment.IDeploymentStep> интерфейс. Реализуйте этот интерфейс всякий раз, когда необходимо определить пользовательский шаг развертывания.

#### <a name="to-define-the-custom-deployment-step"></a>Определение настраиваемого шага развертывания

1. В проекте **деплойментстепекстенсион** откройте файл кода упградестеп и вставьте в него следующий код.

    > [!NOTE]
    > После добавления этого кода в проекте будут обнаружены ошибки компиляции, но они исчезнут при добавлении кода в последующих шагах.

     [!code-csharp[SPExtensibility.ProjectExtension.UpgradeDeploymentStep#1](../sharepoint/codesnippet/CSharp/UpgradeDeploymentStep/deploymentstepextension/upgradestep.cs#1)]
     [!code-vb[SPExtensibility.ProjectExtension.UpgradeDeploymentStep#1](../sharepoint/codesnippet/VisualBasic/upgradedeploymentstep/deploymentstepextension/upgradestep.vb#1)]

## <a name="create-a-deployment-configuration-that-includes-the-custom-deployment-step"></a>Создание конфигурации развертывания, включающей этап настраиваемого развертывания
 Создайте расширение проекта для новой конфигурации развертывания, включающее несколько встроенных шагов развертывания и новый шаг развертывания обновления. Создавая это расширение, вы помогаете разработчикам SharePoint использовать шаг развертывания обновления в проектах SharePoint.

 Чтобы создать конфигурацию развертывания, класс реализует <xref:Microsoft.VisualStudio.SharePoint.ISharePointProjectExtension> интерфейс. Реализуйте этот интерфейс всякий раз, когда нужно создать расширение проекта SharePoint.

#### <a name="to-create-the-deployment-configuration"></a>Создание конфигурации развертывания

1. В проекте **деплойментстепекстенсион** откройте файл кода деплойментконфигуратионекстенсион и вставьте в него следующий код.

     [!code-csharp[SPExtensibility.ProjectExtension.UpgradeDeploymentStep#2](../sharepoint/codesnippet/CSharp/UpgradeDeploymentStep/deploymentstepextension/deploymentconfigurationextension.cs#2)]
     [!code-vb[SPExtensibility.ProjectExtension.UpgradeDeploymentStep#2](../sharepoint/codesnippet/VisualBasic/upgradedeploymentstep/deploymentstepextension/deploymentconfigurationextension.vb#2)]

## <a name="create-the-custom-sharepoint-commands"></a>Создание настраиваемых команд SharePoint
 Создайте две пользовательские команды, вызывающие серверную объектную модель для SharePoint. Одна команда определяет, было ли уже развернуто решение. другая команда обновляет решение.

#### <a name="to-define-the-sharepoint-commands"></a>Определение команд SharePoint

1. В проекте **шарепоинткоммандс** откройте файл кода Commands и вставьте в него следующий код.

     [!code-csharp[SPExtensibility.ProjectExtension.UpgradeDeploymentStep#4](../sharepoint/codesnippet/CSharp/UpgradeDeploymentStep/SharePointCommands/Commands.cs#4)]
     [!code-vb[SPExtensibility.ProjectExtension.UpgradeDeploymentStep#4](../sharepoint/codesnippet/VisualBasic/upgradedeploymentstep/sharepointcommands/commands.vb#4)]

## <a name="checkpoint"></a>Контрольная точка
 На этом этапе в этом пошаговом руководстве весь код для этапа настраиваемого развертывания и команды SharePoint теперь находятся в проектах. Создайте их, чтобы убедиться, что они компилируются без ошибок.

#### <a name="to-build-the-projects"></a>Построение проектов

1. В **Обозреватель решений** откройте контекстное меню проекта **деплойментстепекстенсион** и выберите пункт **Сборка**.

2. Откройте контекстное меню проекта **шарепоинткоммандс** и выберите пункт **Сборка**.

## <a name="create-a-vsix-package-to-deploy-the-extension"></a>Создание пакета VSIX для развертывания расширения
 Чтобы развернуть расширение, используйте проект VSIX в решении для создания пакета VSIX. Сначала настройте пакет VSIX, изменив файл Source. extension. vsixmanifest в проекте VSIX. Затем создайте пакет VSIX, создав решение.

#### <a name="to-configure-and-create-the-vsix-package"></a>Настройка и создание пакета VSIX

1. В **Обозреватель решений** в проекте **упградедеплойментстеп** откройте контекстное меню для файла **source. extension. vsixmanifest** и выберите **Открыть**.

     Visual Studio откроет файл в редакторе манифестов. Файл Source. extension. vsixmanifest является основанием для файла Extension. vsixmanifest, который требуются для всех пакетов VSIX. Дополнительные сведения об этом файле см. в разделе [Справочник по схеме расширения VSIX 1,0](/previous-versions/dd393700(v=vs.110)).

2. В поле **Название продукта** введите **шаг развертывания обновления для проектов SharePoint**.

3. В поле **Author (автор** ) введите **contoso**.

4. В поле **Описание** введите **пользовательский шаг развертывания обновления, который можно использовать в проектах SharePoint**.

5. На вкладке **ресурсы** редактора нажмите кнопку **создать** .

     Откроется диалоговое окно **Добавление нового ресурса** .

6. В списке **тип** выберите **Microsoft. VisualStudio. MefComponent**.

    > [!NOTE]
    > Это значение соответствует `MefComponent` элементу в файле Extension. vsixmanifest. Этот элемент задает имя сборки расширения в пакете VSIX. Дополнительные сведения см. в разделе [элемент MEFComponent (Схема VSX)](/previous-versions/visualstudio/visual-studio-2010/dd393736\(v\=vs.100\)).

7. В списке **источник** выберите **проект в текущем решении**.

8. В списке **проект** выберите **деплойментстепекстенсион**, а затем нажмите кнопку **ОК** .

9. В редакторе манифестов снова нажмите кнопку **создать** .

     Откроется диалоговое окно **Добавление нового ресурса** .

10. В списке **тип** введите **SharePoint. Commands. v4**.

    > [!NOTE]
    > Этот элемент указывает пользовательское расширение, которое необходимо включить в расширение Visual Studio. Дополнительные сведения см. в разделе [элемент Asset (Схема VSX)](/previous-versions/dd393737(v=vs.110)).

11. В списке **источник** выберите **проект в текущем решении**.

12. В списке **проект** выберите **шарепоинткоммандс**, а затем нажмите кнопку **ОК** .

13. В строке меню выберите **Сборка**  >  **сборка решения** и убедитесь, что решение компилируется без ошибок.

14. Убедитесь, что папка выходных данных сборки для проекта Упградедеплойментстеп теперь содержит файл Упградедеплойментстеп. VSIX.

     По умолчанию выходной папкой сборки является.. \bin\Debug в папке, содержащей файл проекта.

## <a name="prepare-to-test-the-upgrade-deployment-step"></a>Подготовка к тестированию шага развертывания обновления
 Чтобы протестировать шаг развертывания обновления, необходимо сначала развернуть пример решения на сайте SharePoint. Начните с отладки расширения в экспериментальном экземпляре Visual Studio. Затем создайте определение списка и экземпляр списка, который будет использоваться для проверки шага развертывания, а затем разверните их на сайте SharePoint. Затем измените определение списка и экземпляр списка и повторно разверните их, чтобы продемонстрировать, как процесс развертывания по умолчанию перезаписывает решения на сайте SharePoint.

 Далее в этом пошаговом руководстве вы измените определение списка и экземпляр списка, а затем обновите их на сайте SharePoint.

#### <a name="to-start-debugging-the-extension"></a>Запуск отладки расширения

1. Перезапустите Visual Studio с учетными данными администратора, а затем откройте решение Упградедеплойментстеп.

2. В проекте Деплойментстепекстенсион откройте файл кода Упградестеп, а затем добавьте точку останова в первую строку кода в `CanExecute` `Execute` методах и.

3. Запустите отладку, нажав клавишу **F5** , или в строке меню выберите **Отладка**  >  **начать отладку**.

4. Visual Studio устанавливает расширение на шаг развертывания%UserProfile%\AppData\Local\Microsoft\VisualStudio\11.0Exp\Extensions\Contoso\Upgrade для SharePoint Projects\1.0 и запускает экспериментальный экземпляр Visual Studio. Вы протестируете шаг развертывания обновления в этом экземпляре Visual Studio.

#### <a name="to-create-a-sharepoint-project-with-a-list-definition-and-a-list-instance"></a>Создание проекта SharePoint с определением списка и экземпляром списка

1. В экспериментальном экземпляре Visual Studio в строке меню выберите **файл**  >  **создать**  >  **проект**.

2. В диалоговом окне **Новый проект** разверните узел **Visual C#** или узел **Visual Basic** , разверните узел **SharePoint** , а затем выберите узел **2010** .

3. В верхней части диалогового окна убедитесь, что **платформа .NET Framework 3,5** отображается в списке версий платформа .NET Framework.

    Проекты для [!INCLUDE[wss_14_long](../sharepoint/includes/wss-14-long-md.md)] и [!INCLUDE[moss_14_long](../sharepoint/includes/moss-14-long-md.md)] нуждаются в этой версии платформа .NET Framework.

4. В списке шаблонов проектов выберите **проект SharePoint 2010**, назовите проект **емплойислистдефинитион**, а затем нажмите кнопку **ОК** .

5. В **мастере настройки SharePoint** введите URL-адрес сайта, который вы хотите использовать для отладки.

6. В разделе **Каков уровень доверия для этого решения SharePoint** выберите параметр **Развернуть как решение фермы** .

   > [!NOTE]
   > Шаг развертывания обновления не поддерживает изолированные решения.

7. Нажмите кнопку **Готово**.

    [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] создает проект Емплойислистдефинитион.

8. Откройте контекстное меню проекта Емплойислистдефинитион, выберите **Добавить**, а затем выберите **новый элемент**.

9. В диалоговом окне **Добавление нового элемента — емплойислистдефинитион** разверните узел **SharePoint** и выберите узел **2010** .

10. Выберите шаблон элемента **списка** , присвойте ему имя **List Employees**, а затем нажмите кнопку **добавить** .

     Откроется мастер настройки SharePoint

11. На странице **Выбор параметров списка** проверьте следующие параметры, а затем нажмите кнопку **Готово** :

    1. **Список Employees (сотрудники** ) отображается в поле отображаемое **имя для списка?** .

    2. Выбран параметр **создать настраиваемый список на основе:** переключатель.

    3. **Значение по умолчанию (пустое)** выбирается в списке **создать настраиваемый список на основе:** .

       [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] создает элемент списка Employees со столбцом Title и одним пустым экземпляром и открывает конструктор списка.

12. В конструкторе списков на вкладке **столбцы** выберите **тип новой или существующей строки имени столбца** , а затем добавьте следующие столбцы в список **Отображаемое имя столбца** :

    1. Имя

    2. Company

    3. Business Phone

    4. E-Mail

13. Сохраните все файлы, а затем закройте конструктор списков.

14. В **Обозреватель решений** разверните узел **список сотрудников** , а затем разверните дочерний узел **экземпляр списка Employees** .

15. В файле *Elements.xml* замените XML-файл по умолчанию в этом файле на следующий XML-код. Этот XML-код изменяет имя списка на **Employees** и добавляет сведения для сотрудника с именем Джим ханце.

    ```xml
    <?xml version="1.0" encoding="utf-8"?>
    <Elements xmlns="http://schemas.microsoft.com/sharepoint/">
      <ListInstance Title="Employees"
                    OnQuickLaunch="TRUE"
                    TemplateType="10000"
                    Url="Lists/Employees"
                    Description="Simple list to test upgrade deployment step">
        <Data>
          <Rows>
            <Row>
              <Field Name="Title">Hance</Field>
              <Field Name="FirstName">Jim</Field>
              <Field Name="Company">Contoso</Field>
              <Field Name="Business Phone">555-555-5555</Field>
              <Field Name="E-Mail">jim@contoso.com</Field>
            </Row>
          </Rows>
        </Data>
      </ListInstance>
    </Elements>
    ```

16. Сохраните и закройте файл *Elements.xml* .

17. Откройте контекстное меню проекта Емплойислистдефинитион и выберите пункт **Открыть** или **свойства**.

     Откроется конструктор свойств.

18. На вкладке **SharePoint** снимите флажок **Автоматическое извлечение после отладки** и сохраните свойства.

#### <a name="to-deploy-the-list-definition-and-list-instance"></a>Развертывание определения списка и экземпляра списка

1. В **Обозреватель решений** выберите узел проекта **емплойислистдефинитион** .

2. В окне **Свойства** убедитесь, что для свойства **Активная конфигурация развертывания** задано значение **по умолчанию**.

3. Нажмите клавишу **F5** или в строке меню выберите **Отладка**  >  **начать отладку**.

4. Убедитесь, что проект успешно построен, веб-браузер открывается на сайте SharePoint, что элемент **списки** на панели быстрого запуска содержит список новые **сотрудники** , а список **сотрудники** содержит запись для Джим ханце.

5. Закройте веб-браузер.

#### <a name="to-modify-the-list-definition-and-list-instance-and-redeploy-them"></a>Изменение определения списка и экземпляра списка и его повторное развертывание

1. В проекте Емплойислистдефинитион откройте файл *Elements.xml* , который является дочерним по отношению к элементу проекта **экземпляра списка сотрудников** .

2. Удалите `Data` элемент и его дочерние элементы, чтобы удалить из списка запись для Jim ханце.

     По завершении файл должен содержать следующий код XML.

    ```xml
    <?xml version="1.0" encoding="utf-8"?>
    <Elements xmlns="http://schemas.microsoft.com/sharepoint/">
      <ListInstance Title="Employees"
                    OnQuickLaunch="TRUE"
                    TemplateType="10000"
                    Url="Lists/Employees"
                    Description="Simple list to test upgrade deployment step">
      </ListInstance>
    </Elements>
    ```

3. Сохраните и закройте файл *Elements.xml* .

4. Откройте контекстное меню для элемента проекта **список сотрудников** , а затем выберите **Открыть** или **Свойства**.

5. В конструкторе списков перейдите на вкладку **представления** .

6. В списке **Выбранные столбцы** выберите **вложения**, а затем нажмите клавишу <, чтобы переместить этот столбец в список **Доступные столбцы** .

7. Повторите предыдущий шаг, чтобы переместить столбец **Рабочий телефон** из списка **Выбранные столбцы** в список **Доступные столбцы** .

     Это действие удаляет эти поля из представления по умолчанию списка **Employees** на сайте SharePoint.

8. Запустите отладку, нажав клавишу **F5** , или в строке меню выберите **Отладка**  >  **начать отладку**.

9. Убедитесь, что отображается диалоговое окно **конфликты развертывания** .

     Это диалоговое окно появляется, когда Visual Studio пытается развернуть решение (экземпляр списка) на сайте SharePoint, на котором это решение уже развернуто. Это диалоговое окно не отображается при выполнении шага развертывания обновления далее в этом пошаговом руководстве.

10. В диалоговом окне **конфликты развертывания** установите флажок **Разрешить автоматическую** настройку.

     Visual Studio удаляет экземпляр списка на сайте SharePoint, развертывает элемент списка в проекте, а затем открывает сайт SharePoint.

11. В разделе **списки** панели быстрого запуска выберите список **сотрудники** , а затем проверьте следующие сведения:

    - В этом представлении списка не отображаются столбцы **вложения** и **домашние телефоны** .

    - Список пуст. При использовании конфигурации развертывания **по умолчанию** для повторного развертывания решения список **Employees** был заменен новым пустым списком в проекте.

## <a name="test-the-deployment-step"></a>Тестирование шага развертывания
 Теперь вы готовы к тестированию шага развертывания обновления. Сначала добавьте элемент в экземпляр списка в SharePoint. Затем измените определение списка и экземпляр списка, обновите их на сайте SharePoint и убедитесь, что шаг развертывания обновления не перезаписывает новый элемент.

#### <a name="to-manually-add-an-item-to-the-list"></a>Добавление элемента в список вручную

1. На ленте на сайте SharePoint на вкладке **список средств** выберите вкладку **элементы** .

2. В **новой** группе выберите **новый элемент**.

     В качестве альтернативы можно выбрать ссылку **Добавить новый элемент** в самом списке элементов.

3. В окне **Employees — новый элемент** в поле **название** введите **Менеджер помещений**.

4. В поле **First Name (имя** ) введите **Энди**.

5. В поле **Company (компания** ) введите **contoso**.

6. Нажмите кнопку **сохранить** , убедитесь, что новый элемент появился в списке, а затем закройте веб-браузер.

     Далее в этом пошаговом руководстве этот элемент будет использоваться для проверки того, что шаг развертывания обновления не перезаписывает содержимое этого списка.

#### <a name="to-test-the-upgrade-deployment-step"></a>Тестирование шага развертывания обновления

1. В экспериментальном экземпляре Visual Studio в **Обозреватель решений** откройте контекстное меню для узла проекта **емплойислистдефинитион** и выберите пункт **Свойства**.

    Откроется редактор свойств/конструктор.

2. На вкладке **SharePoint** задайте для свойства **Активная конфигурация развертывания** значение **Обновить**.

    Эта настраиваемая конфигурация развертывания включает новый шаг развертывания обновления.

3. Откройте контекстное меню для элемента проекта **список сотрудников** , а затем выберите пункт **свойства** или **Открыть**.

    Откроется редактор свойств/конструктор.

4. На вкладке **представления** выберите столбец **Электронная почта** , а затем нажмите **<** клавишу, чтобы переместить этот столбец из списка **Выбранные столбцы** в список **Доступные столбцы** .

    Это действие удаляет эти поля из представления по умолчанию списка **Employees** на сайте SharePoint.

5. Запустите отладку, нажав клавишу **F5** , или в строке меню выберите **Отладка**  >  **начать отладку**.

6. Убедитесь, что код в другом экземпляре Visual Studio остановлен в точке останова, заданной ранее в `CanExecute` методе.

7. Снова нажмите клавишу **F5** или в строке меню выберите **Отладка**  >  **продолжить**.

8. Убедитесь, что код останавливается в точке останова, заданной ранее в `Execute` методе.

9. Нажмите клавишу **F5** или в строке меню выберите **Отладка**  >  **продолжить** в последний раз.

     Веб-браузер открывает сайт SharePoint.

10. В разделе **списки** в области Быстрый запуск выберите список **сотрудники** , а затем проверьте следующие сведения:

    - Элемент, добавленный вручную ранее (для Энди, руководителя помещений), по-прежнему находится в списке.

    - В этом представлении списка не отображаются столбцы **Рабочий телефон** и **адрес электронной почты** .

      Конфигурация развертывания **обновления** изменяет существующий экземпляр списка **сотрудников** на сайте SharePoint. Если вместо конфигурации **обновления** использовалась конфигурация развертывания **по умолчанию** , возникает конфликт развертывания. Visual Studio устранит конфликт, заменив список **сотрудников** , и элемент для Энди, который будет удален.

## <a name="clean-up-the-development-computer"></a>Очистка компьютера разработчика
 После завершения тестирования шага развертывания обновления удалите экземпляр списка и определение списка с сайта SharePoint и удалите расширение шага развертывания из Visual Studio.

#### <a name="to-remove-the-list-instance-from-the-sharepoint-site"></a>Удаление экземпляра списка с сайта SharePoint

1. Откройте список **Employees** на сайте SharePoint, если список еще не открыт.

2. На ленте на сайте SharePoint выберите вкладку **средства списка** и перейдите на вкладку **Список** .

3. В группе **Параметры** выберите элемент **Параметры списка** .

4. В разделе **разрешения и управление** выберите команду **удалить список** , нажмите кнопку **ОК** , чтобы подтвердить, что список нужно отправить в корзину, а затем закройте веб-браузер.

#### <a name="to-remove-the-list-definition-from-the-sharepoint-site"></a>Удаление определения списка с сайта SharePoint

1. В экспериментальном экземпляре Visual Studio в строке меню выберите **Сборка**  >  **отозвать**.

     Visual Studio отзывает определение списка с сайта SharePoint.

#### <a name="to-uninstall-the-extension"></a>Удаление расширения

1. В экспериментальном экземпляре Visual Studio в строке меню выберите **инструменты**  >  **расширения и обновления**.

     Появится диалоговое окно **Расширения и обновления**.

2. В списке расширений выберите **шаг обновить развертывание для проектов SharePoint**, а затем выберите команду **Удалить** .

3. В появившемся диалоговом окне выберите **Да** , чтобы подтвердить удаление расширения, и нажмите кнопку **Перезагрузить сейчас** , чтобы завершить удаленное обновление.

4. Закройте оба экземпляра Visual Studio (экспериментальный экземпляр и экземпляр Visual Studio, в котором открыто решение Упградедеплойментстеп).

## <a name="see-also"></a>См. также раздел
- [Расширение упаковки и развертывания SharePoint](../sharepoint/extending-sharepoint-packaging-and-deployment.md)