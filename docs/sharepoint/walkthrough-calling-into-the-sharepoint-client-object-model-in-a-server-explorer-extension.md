---
title: 'Пошаговое руководство: Вызов клиентской объектной модели SharePoint в расширении обозревателя серверов | Документация Майкрософт'
ms.custom: ''
ms.date: 02/02/2017
ms.technology:
- office-development
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, client object model
- SharePoint commands [SharePoint development in Visual Studio]
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: cc61bf41beb2d4bbef62a8a168fd6f7bcacd740a
ms.sourcegitcommit: d9e4ea95d0ea70827de281754067309a517205a1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/29/2018
ms.locfileid: "37119524"
---
# <a name="walkthrough-calling-into-the-sharepoint-client-object-model-in-a-server-explorer-extension"></a>Пошаговое руководство: Вызов клиентской объектной модели SharePoint в расширении обозревателя серверов
  В этом пошаговом руководстве показано, как вызывать клиентскую объектную модель SharePoint из расширения для **подключения SharePoint** узел в **обозревателя серверов**. Дополнительные сведения об использовании объектной модели клиента SharePoint см. в разделе [вызова объектной модели SharePoint](../sharepoint/calling-into-the-sharepoint-object-models.md).  
  
 В этом пошаговом руководстве описаны следующие задачи.  
  
-   Создание [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] расширение, которое расширяет **подключения SharePoint** узел **обозревателя серверов** одним из следующих способов:  
  
    -   Добавляет расширение **коллекции веб-частей** в узле каждого узла сайта SharePoint в **обозревателя серверов**. Этот новый узел содержит дочерние узлы, представляющие каждый веб-части в галерею веб-частей на сайте.  
  
    -   Расширение определяет новый тип узла, представляющий экземпляр веб-части. Этот новый тип узла является основой для дочерних узлов нового **коллекции веб-частей** узла. Новый тип узла для веб-часть отображает сведения в **свойства** окно веб-часть, которую представляет узел.  
  
-   Построение пакета Visual Studio Extension (VSIX) для развертывания расширения.  
  
-   Отладка и тестирование расширения.  
  
> [!NOTE]  
>  Расширение, которое создается в этом пошаговом руководстве напоминает расширение, создаваемые в [Пошаговое руководство: расширение обозревателя сервера для отображения веб-частей](../sharepoint/walkthrough-extending-server-explorer-to-display-web-parts.md). Для этого пошагового руководства используется объектная модель сервера SharePoint, но в этом пошаговом руководстве выполняются те же задачи с помощью клиентской объектной модели.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Необходимы следующие компоненты на компьютере разработчика для выполнения этого пошагового руководства.  
  
-   Поддерживаемые версии Windows, SharePoint и Visual Studio. Дополнительные сведения см. в разделе [требования по разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   Visual Studio SDK. В этом пошаговом руководстве использует **проект VSIX** шаблона в пакете SDK для создания пакета VSIX для развертывания расширения. Дополнительные сведения см. в разделе [расширения инструментов SharePoint в Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md).  
  
Знание следующие основные понятия будут полезны, но не требуется для выполнения данного пошагового руководства:  
  
-   Использование объектной модели клиента SharePoint. Дополнительные сведения см. в разделе [управляемая клиентская объектная модель](http://go.microsoft.com/fwlink/?LinkId=177797).  
  
-   Веб-частей в SharePoint. Дополнительные сведения см. в разделе [Общие сведения о частях Web](http://go.microsoft.com/fwlink/?LinkId=177803).  
  
## <a name="create-the-projects"></a>Создание проектов
 Для выполнения этого пошагового руководства, необходимо создать два проекта:  
  
-   Проект VSIX для создания пакета VSIX для развертывания **обозревателя серверов** расширения.  
  
-   Проект библиотеки классов, который реализует **обозревателя серверов** расширения.  
  
 Начало выполнения пошагового руководства по созданию проектов.  
  
#### <a name="to-create-the-vsix-project"></a>Создание проекта VSIX  
  
1.  Запустите [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
2.  В строке меню выберите **Файл** > **Создать** > **Проект**.  
  
3.  В **новый проект** диалоговое окно последовательно раскройте элементы **Visual C#** или **Visual Basic** узлов, а затем выберите **расширяемости**.  
  
    > [!NOTE]  
    >  **Расширяемости** узел доступен только в том случае, если установить пакет SDK для Visual Studio. Дополнительные сведения см. в разделе "Предварительные требования" ранее в этом разделе.  
  
4.  В верхней части диалоговое окно, выберите **.NET Framework 4.5** в списке версий .NET Framework.  
  
     Расширения инструментов SharePoint требуют возможности в этой версии платформы .NET Framework.  
  
5.  Выберите **проект VSIX** шаблона.  
  
6.  В **имя** введите **WebPartNode**, а затем выберите **ОК** кнопки.  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Добавляет **WebPartNode** проект **обозревателе решений**.  
  
#### <a name="to-create-the-extension-project"></a>Создание проекта расширения  
  
1.  В **обозревателе решений**, откройте контекстное меню узла решения, выберите **добавить**, а затем выберите **новый проект**.  
  
2.  В **новый проект** диалогового окна последовательно раскройте элементы **Visual C#** или **Visual Basic** узлов, а затем выберите **Windows**.  
  
3.  В верхней части диалоговое окно, выберите **.NET Framework 4.5** в списке версий .NET Framework.  
  
4.  В списке шаблонов проектов выберите **библиотеки классов**.  
  
5.  В **имя** введите **WebPartNodeExtension**, а затем выберите **ОК** кнопки.  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Добавляет **WebPartNodeExtension** проекта в решение и открывает файл кода по умолчанию Class1.  
  
6.  Удалите файл Class1 код из проекта.  
  
## <a name="configure-the-extension-project"></a>Настройка проекта расширения
 Перед написанием кода для создания расширения, необходимо добавить файлы кода и ссылки на сборки в проект, и необходимо обновить пространство имен по умолчанию.  
  
#### <a name="to-configure-the-project"></a>Настройка проекта  
  
1.  В **WebPartNodeExtension** , добавьте два файла кода, которые называются SiteNodeExtension и WebPartNodeTypeProvider.  
  
2.  Откройте контекстное меню для проекта WebPartNodeExtension, а затем выберите **добавить ссылку**.  
  
3.  В **диспетчер ссылок - WebPartNodeExtension** диалоговое окно, выберите **Framework** узел, а затем выберите флажки для System.ComponentModel.Composition и System.Windows.Forms сборки.  
  
4.  Выберите **расширения** узел, установите флажок для каждого из следующих сборок, а затем выберите **ОК** кнопки:  
  
    -   Microsoft.SharePoint.Client  
  
    -   Microsoft.SharePoint.Client.Runtime  
  
    -   Microsoft.VisualStudio.SharePoint  
  
5.  Откройте контекстное меню для **WebPartNodeExtension** проекта, а затем выберите **свойства**.  
  
     Открывается **Конструктор проектов**.  
  
6.  Перейдите на вкладку **Приложение**.  
  
7.  В **пространство имен по умолчанию** поле (C#) или **корневое пространство имен** поле (Visual Basic), введите **ServerExplorer.SharePointConnections.WebPartNode**.  
  
## <a name="create-icons-for-the-new-nodes"></a>Создание значков для новых узлов
 Создайте два значка для **обозревателя серверов** расширения: значок для нового **коллекции веб-частей** узел и еще один значок для каждого дочернего узла веб-часть, в разделе **коллекции веб-частей** узел. Далее в этом пошаговом руководстве вы будете писать код, который связывает эти значки с узлами.  
  
#### <a name="to-create-icons-for-the-nodes"></a>Создание значков для узлов  
  
1.  В **конструктор проектов** WebPartNodeExtension проекта, выберите **ресурсы** вкладки.  
  
2.  Выберите ссылку **этот проект содержит файл ресурсов по умолчанию. Щелкните здесь, чтобы создать ее.**  
  
     Visual Studio создает файл ресурсов и открывает его в конструкторе.  
  
3.  В верхней части конструктора, нажмите кнопку со стрелкой на **добавить ресурс** меню команды, а затем выберите **добавить новый значок**.  
  
4.  Введите **WebPartsNode** для значок "Создать" имя, а затем выберите **добавить** кнопки.  
  
     Значок "Создать" откроется в **редактор изображений**.  
  
5.  Измените версию значок 16 x 16, таким образом, чтобы он имеет вид, который можно легко распознать.  
  
6.  Откройте контекстное меню для значка версии 32 x 32, а затем выберите **удалить тип изображения**.  
  
7.  Повторите шаги с 3 по 7, чтобы добавить второй значок ресурсы проекта и назовите этот значок **WebPart**.  
  
8.  В **обозревателе решений**в **ресурсы** папку для **WebPartNodeExtension** проекта, выберите *WebPartsNode.ico*.  
  
9. В **свойства** открытое окно **действие при построении** , а затем выберите **внедренный ресурс**.  
  
10. Повторите последние два шага для *значка WebPart.ico*.  
  
## <a name="add-the-web-part-gallery-node-to-server-explorer"></a>Добавить узел коллекции веб-частей в обозревателе серверов
 Создайте класс, который добавляет новый **коллекции веб-частей** узел на каждый узел сайта SharePoint. Чтобы добавить новый узел, этот класс реализует <xref:Microsoft.VisualStudio.SharePoint.Explorer.IExplorerNodeTypeExtension> интерфейс. Реализуйте этот интерфейс, каждый раз, когда вы хотите расширить поведение существующего узла в **обозревателя серверов**, таких как добавление нового дочернего узла на узел.  
  
#### <a name="to-add-the-web-part-gallery-node-to-server-explorer"></a>Чтобы добавить узел коллекции веб-частей в обозревателе серверов
  
1.  Вставьте следующий код в **SiteNodeExtension** файл кода для **WebPartNodeExtension** проекта.  
  
    > [!NOTE]  
    >  После добавления этого кода, проект будет содержать некоторые ошибки компиляции. Эти ошибки исчезнут при добавлении кода в последующих шагах.  
  
     [!code-csharp[SPExtensibility.SPExplorer.WebPartNode#1](../sharepoint/codesnippet/CSharp/webpartnode/webpartnodeextension/sitenodeextension.cs#1)]
     [!code-vb[SPExtensibility.SPExplorer.WebPartNode#1](../sharepoint/codesnippet/VisualBasic/spextensibility.spexplorer.webpartnode.webpartnode/webpartnodeextension/sitenodeextension.vb#1)]  
  
## <a name="define-a-node-type-that-represents-a-web-part"></a>Определение типа узла, который представляет веб-части
 Создайте класс, определяющий новый тип узла, представляющий веб-часть. Visual Studio использует этот новый тип узла для отображения дочерних узлов в **коллекции веб-частей** узла. Каждый из этих дочерних узлов представляет один веб-часть на сайте SharePoint.  
  
 Чтобы определить новый тип узла, этот класс реализует <xref:Microsoft.VisualStudio.SharePoint.Explorer.IExplorerNodeTypeProvider> интерфейс. Реализуйте этот интерфейс, каждый раз, когда требуется определить новый тип узла в **обозревателя серверов**.  
  
#### <a name="to-define-the-web-part-node-type"></a>Чтобы определить тип узла часть web
  
1.  Вставьте следующий код в **WebPartNodeTypeProvider** файл кода для **WebPartNodeExtension** проекта.  
  
     [!code-csharp[SPExtensibility.SPExplorer.WebPartNode#2](../sharepoint/codesnippet/CSharp/webpartnode/webpartnodeextension/webpartnodetypeprovider.cs#2)]
     [!code-vb[SPExtensibility.SPExplorer.WebPartNode#2](../sharepoint/codesnippet/VisualBasic/spextensibility.spexplorer.webpartnode.webpartnode/webpartnodeextension/webpartnodetypeprovider.vb#2)]  
  
## <a name="checkpoint"></a>Контрольная точка  
 На этом этапе в этом пошаговом руководстве, весь код для **коллекции веб-частей** узла теперь находится в проекте. Построение **WebPartNodeExtension** проекта, чтобы убедиться в том, что оно компилируется без ошибок.  
  
#### <a name="to-build-the-project"></a>Построение проекта  
  
1.  В **обозревателе решений**, откройте контекстное меню для **WebPartNodeExtension** проекта, а затем выберите **построения**.  
  
## <a name="create-a-vsix-package-to-deploy-the-extension"></a>Создание пакета VSIX для развертывания расширения
 Чтобы развернуть расширение, используйте проекта VSIX в решении для создания пакета VSIX. Во-первых настройте пакет VSIX, изменив файл source.extension.vsixmanifest, включенный в проект. Затем создайте пакет VSIX, построения решения.  
  
#### <a name="to-configure-the-vsix-package"></a>Чтобы настроить пакет VSIX  
  
1.  В **обозревателе решений**в **WebPartNode** откройте проект **source.extension.vsixmanifest** файл в редакторе манифестов.  
  
     Файл source.extension.vsixmanifest является основой для файл extension.vsixmanifest, требующий всех пакетов VSIX. Дополнительные сведения об этом файле см. в разделе [Справочник по схеме 1.0 VSIX расширения](http://msdn.microsoft.com/en-us/76e410ec-b1fb-4652-ac98-4a4c52e09a2b).  
  
2.  В **название продукта** введите **узел коллекции веб-частей для обозревателя серверов**.  
  
3.  В **автор** введите **Contoso**.  
  
4.  В **описание** введите **добавляет пользовательский узел коллекции веб-частей узла подключений SharePoint в обозревателе сервера**.  
  
5.  На **активы** вкладка редактора выберите **New** кнопки.  
  
6.  В **добавить новый актив** отображаемое в диалоговом окне **тип** выберите **Microsoft.VisualStudio.MefComponent**.  
  
    > [!NOTE]  
    >  Это значение соответствует `MefComponent` элемент в файл extension.vsixmanifest. Этот элемент задает имя сборки расширения в пакете VSIX. Дополнительные сведения см. в разделе [MEFComponent элемент (Схема VSX)](http://msdn.microsoft.com/en-us/8a813141-8b73-44c9-b80b-ca85bbac9551).  
  
7.  В **источника** выберите **проект в текущем решении**.  
  
8.  В **проекта** выберите **WebPartNodeExtension**, а затем выберите **ОК** кнопки.  
  
9. В строке меню выберите **построения** > **построить решение**и убедитесь, что решение компилируется без ошибок.  
  
10. Убедитесь, что в выходную папку построения для проекта WebPartNode теперь содержит файл WebPartNode.vsix.  
  
     По умолчанию является выходной папке сборки... папку \bin\debug в папке, содержащей файл проекта.  
  
## <a name="test-the-extension"></a>Тестирование расширения
 Теперь вы готовы для тестирования нового **коллекции веб-частей** узел в **обозревателя серверов**. Начните отладку проекта расширения в экспериментальном экземпляре Visual Studio. Затем используйте новый **веб-частей** узел в экспериментальном экземпляре Visual Studio.  
  
#### <a name="to-start-debugging-the-extension"></a>Чтобы начать отладку расширения  
  
1.  Перезапустите Visual Studio от имени администратора, а затем откройте **WebPartNode** решения.  
  
2.  В проекте WebPartNodeExtension, откройте **SiteNodeExtension** файл кода, а затем добавьте точку останова в первой строки кода в `NodeChildrenRequested` и `CreateWebPartNodes` методы.  
  
3.  Выберите **F5** клавишу, чтобы начать отладку.  
  
     Visual Studio устанавливает расширение для %UserProfile%\AppData\Local\Microsoft\VisualStudio\11.0Exp\Extensions\Contoso\Web расширение узла коллекции частей для сервера Explorer\1.0 и запускает экспериментальный экземпляр Visual Studio. В этом экземпляре Visual Studio будет тестировать элемент проекта.  
  
#### <a name="to-test-the-extension"></a>Чтобы проверить расширение  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **представление** > **обозревателя серверов**.  
  
2.  Убедитесь, что сайт SharePoint, который вы хотите использовать для тестирования отображается в разделе **подключения SharePoint** узел в **обозревателя серверов**. Если его нет в списке, выполните следующие действия:  
  
    1.  Откройте контекстное меню для **подключения SharePoint**, а затем выберите **добавить подключение**.  
  
    2.  В **Добавление подключения SharePoint** диалоговом окне введите URL-адрес для сайта SharePoint, к которому вы хотите подключиться, а затем выберите **ОК** кнопки.  
  
         Чтобы указать сайт SharePoint на компьютере разработчика, введите **http://localhost**.  
  
3.  Разверните узел подключения (в котором отображаются URL-адрес сайта), а затем разверните дочерний узел узла (например, **сайт группы**).  
  
4.  Убедитесь, что выполнение кода в другом экземпляре Visual Studio будет приостановлено в точке останова, заданной ранее в `NodeChildrenRequested` метод, а затем выберите **F5** клавишу, чтобы продолжить отладку проекта.  
  
5.  В экспериментальном экземпляре Visual Studio, разверните **коллекции веб-частей** узла, который появится в узле сайта верхнего уровня.  
  
6.  Убедитесь, что выполнение кода в другом экземпляре Visual Studio будет приостановлено в точке останова, заданной ранее в `CreateWebPartNodes` метод, а затем выберите **F5** клавишу, чтобы продолжить отладку проекта.  
  
7.  В экспериментальном экземпляре Visual Studio, убедитесь, что все веб-части на подключенном сайте отображаются в разделе **коллекции веб-частей** узел в **обозревателя серверов**.  
  
8.  Откройте контекстное меню для веб-части и выберите **свойства**.  
  
9. В **свойства** окна, убедитесь, что отображаются сведения о веб-части.  
  
10. В **обозревателя серверов**, откройте контекстное меню для одного веб-части и выберите **отображение сообщения**.  
  
     В появившемся диалоговом окне выберите **ОК** кнопки.  
  
## <a name="uninstall-the-extension-from-visual-studio"></a>Удалите расширение из Visual Studio
 После завершения тестирования расширения, удалите его из Visual Studio.  
  
#### <a name="to-uninstall-the-extension"></a>Удаление расширения  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **средства** > **расширения и обновления**.  
  
     Появится диалоговое окно **Расширения и обновления**.  
  
2.  В списке расширений, выберите **узел коллекции веб-частей для обозревателя серверов**, а затем выберите **удаления** кнопку.  
  
3.  В появившемся диалоговом окне, выберите **Да** кнопки.  
  
4.  Выберите **Перезагрузить сейчас** кнопку, чтобы завершить удаление.  
  
     Элемент проекта также удаляются.  
  
5.  Закройте оба экземпляра Visual Studio (экспериментальный экземпляр и экземпляр Visual Studio, в котором открыто решение WebPartNode).  
  
## <a name="see-also"></a>См. также
 [Вызов объектных моделей SharePoint](../sharepoint/calling-into-the-sharepoint-object-models.md)   
 [Расширение узла подключений SharePoint в обозревателе серверов](../sharepoint/extending-the-sharepoint-connections-node-in-server-explorer.md)   
 [Пошаговое руководство: Расширение обозревателя сервера для отображения веб-частей](../sharepoint/walkthrough-extending-server-explorer-to-display-web-parts.md)   
 [Редактор изображений для значков](/cpp/windows/image-editor-for-icons)   
 [Создание значка или другого изображения &#40;редактор изображений для значков&#41;](/cpp/windows/creating-an-icon-or-other-image-image-editor-for-icons)  
  
