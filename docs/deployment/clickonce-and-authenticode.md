---
title: ClickOnce и Authenticode | Документация Майкрософт
description: Сведения о сертификатах, которые Authenticode использует для проверки подлинности приложений. Узнайте, как сертификаты проверяются и сохраняются.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
helpviewer_keywords:
- .pfx files
- ClickOnce deployment, Authenticode
- Authenticode, ClickOnce
- ClickOnce deployment, certificates
- ClickOnce deployment, security
ms.assetid: ab5b6712-f32a-4e33-842f-e88ab4818ccf
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: e6541e99b23579713e77cf2bf1dc62152f02b4ce
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99946102"
---
# <a name="clickonce-and-authenticode"></a>ClickOnce и технология Authenticode
*Authenticode* — это технология Майкрософт, которая использует шифрование по отраслевому стандарту для подписания кода приложения цифровыми сертификатами, которые удостоверяют подлинность издателя приложения. Используя Authenticode для развертывания приложения, [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] снижает риск заражения программой-трояном. Программа-троян — это вирус или другая вредоносная программа, которые злоумышленник представляет как легальную программу, исходящую из авторитетного и заслуживающего доверия источника. Подписание развертываний [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] с помощью цифрового сертификата — это необязательный шаг, позволяющий убедиться, что сборки и файлы не были изменены.

 В следующих разделах описываются различные типы цифровых сертификатов, используемых в Authenticode, способ проверки сертификатов с помощью центров сертификации (ЦС), роль меток времени в сертификатах и методы хранения сертификатов.

## <a name="authenticode-and-code-signing"></a>Authenticode и подписывание кода
 *Цифровой сертификат* — это файл, содержащий пару из открытого и закрытого криптографических ключей вместе с метаданными, описывающими издателя, которому был выдан сертификат, и агентство, выдавшее сертификат.

 Существуют различные типы сертификатов Authenticode. Каждый из них настроен для разных типов подписывания. Для приложений [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] требуется сертификат Authenticode, пригодный для подписания кода. Если попытаться войти приложение [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] с помощью другого типа сертификата, например цифрового сертификата электронной почты, он не будет работать. Дополнительные сведения см. [в разделе Введение в подписывание кода](/windows/desktop/seccrypto/cryptography-tools).

 Сертификат для подписывания кода можно получить одним из трех способов:

- приобрести у поставщика сертификатов;

- получить от группы, которая отвечает за создание цифровых сертификатов в вашей организации.

- Создайте собственный сертификат с помощью командлета PowerShell New-SelfSignedCertificate или с помощью *MakeCert.exe*, который входит в состав [!INCLUDE[winsdklong](../deployment/includes/winsdklong_md.md)] .

### <a name="how-using-certificate-authorities-helps-users"></a>Польза центров сертификации для пользователей
 Сертификат, созданный с помощью New-SelfSignedCertificate или *MakeCert.exe* служебная программа, обычно называется *автосертификатом* или *тестовым сертификатом*. Сертификат этого типа работает так же, как и *SNK*-файл в платформе .NET Framework. Он состоит только из пары открытого и закрытого криптографических ключей и не содержит проверяемых сведений об издателе. Автосертификаты можно использовать для развертывания приложений [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] с высоким уровнем доверия в интрасети. Однако когда эти приложения выполняются на клиентском компьютере, [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] идентифицирует их как поступающие от неизвестного издателя. По умолчанию приложения [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] , подписанные с помощью автосертификатов и развертываемые через Интернет, не могут использовать развертывание доверенных приложений.

 И наоборот, если вы получаете сертификат из такого центра сертификации, как поставщик сертификатов или отдел внутри вашей организации, этот сертификат обеспечивает повышенную безопасность для пользователей. Он не только идентифицирует издателя подписанного программного обеспечения, но и проверяет его удостоверение путем сверки с ЦС, подписавшим его. Если ЦС не является корневым, Authenticode также выстраивает обратную "цепочку" до корневого центра, чтобы убедиться, что ЦС авторизован для выдачи сертификатов. Для повышения безопасности следует по возможности использовать сертификат, выданный центром сертификации.

 Дополнительные сведения о создании самозаверяющих сертификатов см. в разделе [New-SelfSignedCertificate](/powershell/module/pkiclient/new-selfsignedcertificate) или [MakeCert](/windows/desktop/SecCrypto/makecert).

### <a name="timestamps"></a>Метки времени
 Сертификаты, используемые для подписи приложений [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] , имеют определенный срок действия, который обычно составляет двенадцать месяцев. Чтобы устранить необходимость в постоянном повторном подписывании приложений с использованием новых сертификатов, [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] поддерживает метку времени. Когда приложение подписано с меткой времени, его сертификат будет приниматься даже после истечения срока действия, при условии, что действительна метка времени. Это позволяет скачивать и запускать приложения [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] с просроченными сертификатами, но действительными метками времени. Кроме того, это позволяет установленным приложениям с просроченными сертификатами продолжать скачивать и устанавливать обновления.

 Чтобы включить метку времени на сервер приложений, должен быть доступен сервер меток времени. Сведения о выборе сервера меток времени см. в разделе [How to: Sign Application and Deployment Manifests](../ide/how-to-sign-application-and-deployment-manifests.md).

### <a name="update-expired-certificates"></a>Обновление сертификатов с истекшим сроком действия
 В более ранних версиях платформы .NET Framework обновление приложения, у которого истек срок действия сертификата, могло привести к прекращению работы этого приложения. Чтобы устранить эту проблему, воспользуйтесь одним из следующих способов:

- Обновите платформу .NET Framework до версии 2.0 с пакетом обновления 1 или более поздней в Windows XP или до версии 3.5 или более поздней в Windows Vista.

- Удалите приложение и переустановите новую версию с действительным сертификатом.

### <a name="store-certificates"></a>Хранение сертификатов

- Сертификаты можно хранить в виде *PFX* -файла в файловой системе или хранить их в контейнере ключей. Пользователь в домене Windows может иметь несколько контейнеров ключей. По умолчанию *MakeCert.exe* сохраняет сертификаты в личном контейнере ключей, если не указано, что сертификат должен храниться в виде *PFX*-файла. *Mage.exe* и *MageUI.exe* — инструменты [!INCLUDE[winsdkshort](../debugger/debug-interface-access/includes/winsdkshort_md.md)] для создания развертываний [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] — позволяют использовать сертификаты, хранящиеся в любом режиме.

## <a name="see-also"></a>См. также раздел
- [Развертывание и безопасность технологии ClickOnce](../deployment/clickonce-security-and-deployment.md)
- [Защита приложений ClickOnce](../deployment/securing-clickonce-applications.md)
- [Общие сведения о развертывании доверенных приложений](../deployment/trusted-application-deployment-overview.md)
- [Mage.exe (средство создания и редактирования манифеста)](/dotnet/framework/tools/mage-exe-manifest-generation-and-editing-tool)