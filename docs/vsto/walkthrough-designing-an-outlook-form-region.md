---
title: Пошаговое руководство. Разработка области формы Outlook
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- form regions [Office development in Visual Studio], creating
author: John-Hart
ms.author: johnhart
manager: jillfra
ms.workload:
- office
ms.openlocfilehash: 68ad2e66a4cecff01005f49aa6304a515a010170
ms.sourcegitcommit: 3201da3499051768ab59f492699a9049cbc5c3c6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2019
ms.locfileid: "58355582"
---
# <a name="walkthrough-design-an-outlook-form-region"></a>Пошаговое руководство. Разработка области формы Outlook
  Пользовательские области формы расширяют стандартные или настраиваемые формы Microsoft Office Outlook. В этом пошаговом руководстве показано, как проектировать пользовательскую область формы, которая отображается в виде новой страницы в окне инспектора элемента контактов. В этой области формы отображается карта каждого адреса, указанного для контакта, путем отправки информации об адресе на веб-сайт локального поиска Windows Live. Сведения об областях форм см. в разделе [областей форм Outlook создайте](../vsto/creating-outlook-form-regions.md).

 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]

 В данном пошаговом руководстве рассмотрены следующие задачи:

-   Создание нового проекта надстройки Outlook VSTO

-   Добавление области формы в проект надстройки VSTO

-   Разработка макета области формы

-   Настройка поведения области формы

-   Тестирование области формы Outlook

> [!NOTE]
>  Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. Дополнительные сведения см. в разделе [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).

## <a name="prerequisites"></a>Предварительные требования
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.

- [!INCLUDE[vsto_vsprereq](../vsto/includes/vsto-vsprereq-md.md)]

- [!INCLUDE[Outlook_14_short](../vsto/includes/outlook-14-short-md.md)] или более поздней версии.

  ![ссылка на видео](../vsto/media/playvideo.gif "ссылка на видео") видеоверсию этого раздела, см. в разделе [видео как: Разработка области формы Outlook](http://go.microsoft.com/fwlink/?LinkID=140824).

## <a name="create-a-new-outlook-vsto-add-in-project"></a>Создайте новый проект надстройки Outlook VSTO
 Сначала создайте базовый проект надстройки VSTO.

### <a name="to-create-a-new-outlook-vsto-add-in-project"></a>Порядок создания нового проекта надстройки Outlook VSTO

1.  В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], создайте проект надстройки Outlook VSTO с именем **MapItAddIn**.

2.  В диалоговом окне **Создание проекта** выберите **Создать каталог для решения**.

3.  Сохраните проект в любом каталоге.

     Дополнительные сведения см. в разделе [Как Создание проектов Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).

## <a name="add-a-form-region-to-the-outlook-vsto-add-in-project"></a>Добавление области формы в проект надстройки Outlook VSTO
 Решение надстройки Outlook VSTO может содержать один или несколько элементов области формы Outlook. Добавить элемент области формы в проект с помощью **новая область формы Outlook** мастера.

### <a name="to-add-a-form-region-to-the-outlook-vsto-add-in-project"></a>Порядок добавления области формы в проект надстройки Outlook VSTO

1.  В **обозревателе решений**выберите **MapItAddIn** проекта.

2.  В меню **Проект** выберите пункт **Добавить новый элемент**.

3.  В **Добавление нового элемента** диалоговом окне выберите **область формы Outlook**, назовите файл **MapIt**, а затем нажмите кнопку **добавить**.

     **Область формы NewOutlook** запускается мастер.

4.  На **выберите способ создания области формы** щелкните **создать новую область формы**, а затем нажмите кнопку **Далее**.

5.  На **выберите тип области формы, которые вы хотите создать** щелкните **отдельные**, а затем нажмите кнопку **Далее**.

     Объект *отдельные* область формы добавляет новую страницу в форме Outlook. Дополнительные сведения о типах областей форм см. в разделе [областей форм Outlook создайте](../vsto/creating-outlook-form-regions.md).

6.  На **введите текст описания и выберите параметры отображения** введите **Map It** в **имя** поле.

     Это имя отображается на ленте окна инспектора при открытии элемента контактов.

7.  Выберите **инспекторов, которые находятся в режиме разработки** и **инспекторы в режиме чтения**, а затем нажмите кнопку **Далее**.

8.  На **классы сообщений, которые будет отображаться эта область формы** странице снимите **почтовое сообщение**выберите **контакт**и нажмите кнопку **Готово**.

     Объект *файл MapIt.cs* или *MapIt.vb* файл добавляется в проект.

## <a name="design-the-layout-of-the-form-region"></a>Разработка макета области формы
 Визуальной разработки областей формы с помощью *конструктора областей формы*. Управляемые элементы управления можно перетаскивать на поверхность конструктора областей формы. Используйте конструктор и **свойства** окно настройки управления макетом и внешним видом.

### <a name="to-design-the-layout-of-the-form-region"></a>Порядок разработки макета области формы

1.  В **обозревателе решений**, разверните **MapItAddIn** проекта, а затем дважды щелкните *файл MapIt.cs* или *MapIt.vb* для открытия области формы Конструктор.

2.  Щелкните правой кнопкой мыши в конструкторе, а затем нажмите кнопку **свойства**.

3.  В **свойства** окне **размер** для **664, 469**.

     Это гарантирует, что область формы будет достаточно большой, чтобы отображать карту.

4.  В меню **Вид** выберите пункт **Панель элементов**.

5.  Из **стандартные элементы управления** вкладке **элементов**, добавьте **WebBrowser** в область формы.

     **WebBrowser** будет отображать карту каждого адреса, указанного для контакта.

## <a name="customize-the-behavior-of-the-form-region"></a>Настройка поведения области формы
 Для настройки поведения области формы во время выполнения добавьте код в обработчики событий области формы. Для этой области формы код проверяет свойства элемента Outlook и определяет, следует ли отображать область формы Map It. Если область формы отображается, код переходит на веб-сайт локального поиска Windows Live и загружает карту для каждого адреса, включенного в элемент контактов Outlook.

### <a name="to-customize-the-behavior-of-the-form-region"></a>Порядок настройки поведения области формы

1. В **обозревателе решений**, щелкните правой кнопкой мыши *файл MapIt.cs* или *MapIt.vb*, а затем нажмите кнопку **Просмотр кода**.

    *Файл MapIt.cs* или *MapIt.vb* откроется в редакторе кода.

2. Разверните **фабрика областей формы** области кода.

    Предоставляется класс фабрики областей формы с именем `MapItFactory`.

3. Добавьте следующий код в обработчик событий `MapItFactory_FormRegionInitializing`. Этот обработчик событий будет вызываться, когда пользователь открывает элемент контактов. Следующий код определяет, содержит ли элемент контактов адрес. Если элемент контактов не содержит адрес, этот код задает <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> свойство <xref:Microsoft.Office.Tools.Outlook.FormRegionInitializingEventArgs> класс **true** и области формы не отображается. В противном случае надстройка VSTO выдает событие <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing> и отображает область формы.

    [!code-csharp[Trin_Outlook_FR_Separate#1](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Separate_O12/MapIt.cs#1)]
    [!code-vb[Trin_Outlook_FR_Separate#1](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Separate_O12/MapIt.vb#1)]

4. Добавьте следующий код в обработчик событий <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing>. Этот код выполняет следующие задачи:

   - Сцепляет каждый адрес в элементе контактов и создает строку URL-адреса.

   - Вызывает метод <xref:System.Windows.Forms.WebBrowser.Navigate%2A> объекта <xref:System.Windows.Forms.WebBrowser> и передает строку URL-адреса в качестве параметра.

     Веб-сайт локального поиска отображается в области формы Map It и представляет каждый адрес в тестовой области.

     [!code-csharp[Trin_Outlook_FR_Separate#2](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Separate_O12/MapIt.cs#2)]
     [!code-vb[Trin_Outlook_FR_Separate#2](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Separate_O12/MapIt.vb#2)]

## <a name="test-the-outlook-form-region"></a>Тестирование области формы Outlook
 При запуске проекта в Visual Studio открывается Outlook. Для просмотра области формы Map It откройте элемент контактов. Область формы Map It отображается в виде страницы в форме каждого элемента контактов, содержащего адрес.

### <a name="to-test-the-map-it-form-region"></a>Порядок тестирования области формы Map It

1.  Нажмите клавишу **F5**, чтобы запустить проект.

     Открывается Outlook.

2.  В Outlook на **Главная** , затем щелкните **новые элементы**, а затем нажмите кнопку **контакт**.

3.  В форме контактов введите **Ann Beebe** контактного имени, а затем укажите три следующих адреса.

    |Тип адреса|Адрес|
    |------------------|-------------|
    |**Бизнеса**|**4567 Main St. Буффало, штат Нью-ЙОРК**|
    |**Корневая папка**|**1234 Северной St. Буффало, штат Нью-ЙОРК**|
    |**Другое**|**St. Main 3456, Сиэтл, Вашингтон**|

4.  Сохраните и закройте элемент контактов.

5.  Снова откройте **Ann Beebe** элемент контактов.

    В Outlook, это можно сделать **найти** группу с открытием адресной книги для контактов, либо введя Ann Beebe в **поиск пользователей**.

6.  В **Показать** группы ленты элемента щелкните **Map It** чтобы открыть область формы Map It.

     Появляется область формы Map It, где отображается веб-сайт локального поиска. **Бизнеса**, **Главная**, и **других** адреса отображаются в блокноте. Выберите в тестовой области адрес, который необходимо сопоставить.

## <a name="next-steps"></a>Следующие шаги
 Дополнительные сведения о настройке пользовательского интерфейса приложения Outlook см. в следующих разделах.

-   Дополнительные сведения о настройке ленты элемента Outlook, см. в разделе [настройке ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md).

## <a name="see-also"></a>См. также
- [Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)
- [Создание областей форм Outlook](../vsto/creating-outlook-form-regions.md)
- [Рекомендации для создания областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)
- [Пошаговое руководство: Импорт области формы, разработанной в Outlook](../vsto/walkthrough-importing-a-form-region-that-is-designed-in-outlook.md)
- [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)
- [Связывание области формы с классом сообщений Outlook](../vsto/associating-a-form-region-with-an-outlook-message-class.md)
- [Пользовательские действия в областях формы Outlook](../vsto/custom-actions-in-outlook-form-regions.md)
- [Практическое руководство. Запретить отображение области формы Outlook](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md)
