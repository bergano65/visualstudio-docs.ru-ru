---
title: Общие сведения об элементах управления Windows Forms в документах Office
description: Узнайте, как Windows Forms элементы управления — это объекты, с которыми пользователи могут взаимодействовать для ввода данных и управления ими.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- old data showing in error [Office development in Visual Studio]
- Windows Forms controls [Office development in Visual Studio], Word
- Windows Forms controls [Office development in Visual Studio], adding
- Windows Forms controls [Office development in Visual Studio], arranging
- data [Office development in Visual Studio], old data showing in error
- user controls [Office development in Visual Studio], Windows Forms
- Windows Forms controls [Office development in Visual Studio]
- Windows Forms controls [Office development in Visual Studio], removing
- application development [Office development in Visual Studio], Windows Forms controls
- controls [Office development in Visual Studio], Windows Forms controls
- Office [Office development in Visual Studio], Windows Forms controls
- Office documents [Office development in Visual Studio, controls
- documents [Office development in Visual Studio], Windows Forms controls
- document-level customizations [Office development in Visual Studio], Windows Forms controls
- Windows Forms controls [Office development in Visual Studio], about Windows Forms controls
- Office applications [Office development in Visual Studio], Windows Forms
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: b2d221cdc3e66205ef9bf3d816b6f226be69ff51
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99937177"
---
# <a name="windows-forms-controls-on-office-documents-overview"></a>Общие сведения об элементах управления Windows Forms в документах Office
  Элементы управления Windows Forms — это объекты, с которыми пользователи могут взаимодействовать для ввода данных и работы с ними. В проектах для Microsoft Office Excel или Microsoft Office Word на уровне документа можно добавлять элементы управления Windows Forms в документ или книгу в проекте во время проектирования или добавить их программными средствами в среде выполнения. Эти элементы управления можно программными средствами добавить в любой открытый документ или лист во время выполнения в надстройке VSTO для Excel или Word.

 Дополнительные сведения см. [в разделе руководство. добавление Windows Forms элементов управления в документы Office](../vsto/how-to-add-windows-forms-controls-to-office-documents.md).

 [!INCLUDE[appliesto_controls](../vsto/includes/appliesto-controls-md.md)]

## <a name="use-windows-forms-controls"></a>Использование элементов управления Windows Forms

Вы можете добавлять элементы управления Windows Forms в документы и в элементы настраиваемого пользовательского интерфейса, включая панели действий, настраиваемые области задач и Windows Forms. В целом элементы управления Windows Forms действуют в документах так же, как в других элементах пользовательского интерфейса, однако существуют некоторые различия. Дополнительные сведения см. [в разделе ограничения элементов управления Windows Forms в документах Office](../vsto/limitations-of-windows-forms-controls-on-office-documents.md).

Целесообразность добавления элементов управления Windows Forms в документ или в какой-либо другой элемент пользовательского интерфейса определяется несколькими факторами. При разработке пользовательского интерфейса решения рассмотрите возможность использования элементов управления Windows Forms, как описано в следующей таблице.

В документе.
- Если требуется отображать элементы управления 100 % времени.

- Если пользователи должны вводить данные непосредственно в документ: например, в документах на основе форм, в которых поверхность редактирования заблокирована.

- Если вы хотите, чтобы элементы управления отображались в одну линию с данными в документе. Например при добавлении кнопок к каждой строке объекта-списка требуется, чтобы они находились в одной строке с каждым элементом списка.

В области действий или в настраиваемой области задач.
- Если требуется предоставлять пользователю контекстную информацию.

- Если требуется, чтобы в документе отображались только результаты, но не элементы управления запроса и данные.

- Если необходимо обеспечить, чтобы элементы управления не печатались вместе с документом.

- Если необходимо обеспечить, чтобы элементы управления не влияли на представление документа.

В форме Windows.
- Если требуется управлять размерами элементов пользовательского интерфейса.

- Если требуется запретить пользователям скрытие или удаление элементов управления.

- Если требуется получить входные данные от пользователя и предотвратить выполнение любых операций в документе, пока не будут получены эти входные данные.

## <a name="add-windows-forms-controls-programmatically"></a>Программное добавление Windows Forms элементов управления
 В документы Word или листы Excel вы можете добавлять элементы управления Windows Forms в среде выполнения. [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] предоставляет вспомогательные методы для добавления наиболее распространенных элементов управления Windows Forms. Эти вспомогательные методы позволяют быстро добавлять элементы управления в документ Office и получать доступ к объединенным функциональным возможностям элементов управления Windows Forms и их функциям, связанным с Office.

 Дополнительные сведения см. [в разделе Добавление элементов управления в документы Office во время выполнения](../vsto/adding-controls-to-office-documents-at-run-time.md).

## <a name="use-windows-forms-controls-in-document-level-projects"></a>Использование элементов управления Windows Forms в проектах уровня документа
 Некоторые аспекты использования элементов управления Windows Forms в документах, относящиеся только к проектам уровня документа, позволяют создавать пользовательский интерфейс документа с помощью конструктора Visual Studio.

### <a name="create-custom-user-controls"></a>Создание настраиваемых пользовательских элементов управления
 Вы можете добавить в проект пользовательский элемент управления, а затем добавить его в **панель элементов**. Далее можно перетаскивать этот пользовательский элемент управления непосредственно в документ так же, как это делается с элементом управления Windows Forms. Существуют некоторые особенности, которые необходимо учитывать при создании пользовательских элементов управления.

- Не создавайте пользовательский элемент управления **sealed** . При перетаскивании элемента управления в документ Visual Studio создает класс-оболочку, производный от пользовательского элемента управления, для его расширения и поддержки его использования в документах. Если пользовательский элемент управления — **sealed**, Visual Studio не может создать класс-оболочку.

- Пользовательские элементы управления должны иметь атрибут <xref:System.Runtime.InteropServices.ComVisibleAttribute> , установленный в значение **true**. У пользовательских элементов управления, созданных в проекте Office, этот атрибут имеет значение **true** по умолчанию, но у пользовательских элементов управления, являющихся частью внешних проектов, этот атрибут может не иметь значение **true**.

- После добавления пользовательского элемента управления в документ не переименовывайте класс <xref:System.Windows.Forms.UserControl> и не удаляйте его из проекта. Если вам нужно изменить имя пользовательского элемента управления, то необходимо сначала удалить его из документа, а после изменения имени снова его добавить.

### <a name="arrange-controls-at-design-time"></a>Размещение элементов управления во время разработки
 При добавлении нескольких элементов управления в документы Word и Excel во время разработки вы можете быстро настроить выравнивание для всех выбранных элементов управления с помощью панелей инструментов **Microsoft Office Word** и **Microsoft Office Excel** в Visual Studio. Эти панели инструментов доступны только в том случае, если документ или лист открыт в конструкторе.

 Выбрав несколько элементов управления в конструкторе, вы можете упорядочить их с помощью следующих кнопок на этих панелях инструментов:

- **Выравнивание левых границ**

- **Выравнивание по центру**

- **Выравнивание правых границ**

- **Выравнивание верхних границ**

- **Выравнивание по середине**

- **Выравнивание нижних границ**

- **Сделать интервалы по горизонтали равными**

- **Сделать интервалы по вертикали равными**

> [!NOTE]
> В проектах Word эти кнопки включены только в том случае, если выбранные элементы управления не находятся в текстовой строке. По умолчанию элементы управления, добавляемые в документ во время разработки, находятся в текстовых строках.

### <a name="prevent-old-data-from-appearing-in-excel-workbooks-during-loading"></a>Предотвращение появления старых данных в книгах Excel во время загрузки
 Если вы добавляете элементы управления Windows Forms в документы или листы во время разработки, элементы управления остаются в документе, когда пользователь закрывает документ. Элементы управления, добавленные во время разработки, также называются *статическими элементами управления*.

 При открытии книги Excel, содержащей статические элементы управления, эта книга отображает растровое изображение элемента управления в элементе управления ActiveX, пока выполняется код настройки и загружается фактический элемент управления. Excel создает это растровое изображение и сохраняет его в книге при каждом сохранении книги. Это растровое изображение показывает элемент управления в том виде, в каком он был при последнем сохранении книги, включая все данные, которые в нем отображались. Дополнительные сведения об элементе управления ActiveX, содержащем элементы управления Windows Forms и точечные рисунки, см. в разделе [ограничения элементов управления Windows Forms в документах Office](../vsto/limitations-of-windows-forms-controls-on-office-documents.md).

 В определенных условиях код не загружается и отображается только растровое изображение, например когда пользователь открывает книгу в режиме конструктора. Кроме того, если пользователь открывает книгу на компьютере, на котором не установлена среда выполнения [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] , настройка для загрузки элементов управления не может быть запущена, и поэтому отображается только растровое изображение элемента управления. Всегда следует удалять личные сведения из элементов управления в книгах, прежде чем сохранить книгу и отправить ее другому пользователю, чтобы ваши личные сведения не были случайно раскрыты.

### <a name="match-control-size-to-cell-size-on-an-excel-worksheet"></a>Соответствие размера элемента управления размеру ячейки на листе Excel
 Вы можете задать автоматическое изменение размера элемента управления при изменении размера его родительской ячейки. Дополнительные сведения см. [в разделе Практические руководства. изменение размеров элементов управления в ячейках листа](../vsto/how-to-resize-controls-within-worksheet-cells.md).

### <a name="add-components-that-are-shared-by-all-worksheets"></a>Добавление компонентов, совместно используемых всеми листами
 Вы можете добавлять компоненты, которые будут совместно использоваться всеми листами, такие как <xref:System.Data.DataSet>, не в сами листы, а в конструктор книги. Такой компонент будет отображаться в области компонентов.

### <a name="formula-for-embedding-controls-on-an-excel-worksheet"></a>Формула для внедрения элементов управления на листе Excel
 При выборе элемента управления в Excel вы увидите **=EMBED("WinForms.Control.Host","")** в **строке формул**. Этот текст обязательный, его не следует удалять.

### <a name="layout-style-of-controls-on-a-word-document"></a>Стиль макета для элементов управления в документе Word
 При добавлении элемента управления в документ Word в проекте уровня документа с помощью конструктора Visual Studio этот элемент управления добавляется в тексте. Чтобы изменить стиль макета элемента управления, щелкните правой кнопкой мыши элемент управления и выберите пункт **Формат элемента управления**. Выберите стиль обтекания на странице **Макет** диалогового окна **Формат объекта** .

 При добавлении элемента управления в документ Word во время выполнения можно указать стиль макета нового элемента управления с помощью различных `Add` \<*control class*> перегрузок метода <xref:Microsoft.Office.Tools.Word.ControlCollection> класса:

- Чтобы добавить элемент управления в тексте, используйте перегрузку, которая принимает объект <xref:Microsoft.Office.Interop.Word.Range> , указывающий расположение элемента управления.

- Чтобы добавить элемент управления как перемещаемую форму, используйте перегрузку, которая принимает верхнюю и левую координаты элемента управления.

  Дополнительные сведения см. [в разделе Добавление элементов управления в документы Office во время выполнения](../vsto/adding-controls-to-office-documents-at-run-time.md).

  При открытии шаблона Word в конструкторе Visual Studio не являющиеся встроенными элементы управления шаблона могут не отображаться, поскольку Visual Studio открывает шаблон в **обычном** режиме. Чтобы увидеть эти элементы управления, измените режим представления на **режим разметки**.

### <a name="controls-outside-the-main-document-body"></a>Элементы управления за пределами основного текста документа
 Элементы управления Windows Forms не поддерживаются в верхнем и нижнем колонтитуле, а также внутри вложенного документа.

### <a name="add-components-at-design-time"></a>Добавить компоненты во время разработки
 Некоторые компоненты или элементы управления отображаются не в документе, а в области компонентов. Visual Studio предоставляет область компонентов для каждого окна документа. Область компонентов отображается на экране, только если в этом документе существуют компоненты.

## <a name="see-also"></a>См. также раздел
- [Элементы управления в документах Office](../vsto/controls-on-office-documents.md)
- [Добавление элементов управления в документы Office во время выполнения](../vsto/adding-controls-to-office-documents-at-run-time.md)
- [Общие сведения о ведущих элементах и элементах управления ведущего приложения](../vsto/host-items-and-host-controls-overview.md)
- [Обзор панели действий](../vsto/actions-pane-overview.md)
- [Элементы управления Windows Forms](/dotnet/framework/winforms/controls/index)
- [Ограничения элементов управления Windows Forms в документах Office](../vsto/limitations-of-windows-forms-controls-on-office-documents.md)
- [Добавление Windows Forms элементов управления в документы Office](../vsto/how-to-add-windows-forms-controls-to-office-documents.md)
- [Руководство. изменение размеров элементов управления в ячейках листа](../vsto/how-to-resize-controls-within-worksheet-cells.md)
- [Как скрыть элементы управления на листах при печати](../vsto/how-to-hide-controls-on-worksheets-when-printing.md)
- [Пошаговое руководство. изменение форматирования листа с помощью элементов управления CheckBox](../vsto/walkthrough-changing-worksheet-formatting-using-checkbox-controls.md)
- [Пошаговое руководство. изменение форматирования документа с помощью элементов управления CheckBox](../vsto/walkthrough-changing-document-formatting-using-checkbox-controls.md)
- [Пошаговое руководство. Отображение текста в текстовом поле листа с помощью кнопки](../vsto/walkthrough-displaying-text-in-a-text-box-in-a-worksheet-using-a-button.md)
- [Пошаговое руководство. Отображение текста в текстовом поле документа с помощью кнопки](../vsto/walkthrough-displaying-text-in-a-text-box-in-a-document-using-a-button.md)
- [Ограничения элементов управления Windows Forms в документах Office](../vsto/limitations-of-windows-forms-controls-on-office-documents.md)
- [Пошаговое руководство. Обновление диаграммы в документе с помощью переключателей](../vsto/walkthrough-updating-a-chart-in-a-document-using-radio-buttons.md)
- [Пошаговое руководство. Обновление диаграммы на листе с помощью переключателей](../vsto/walkthrough-updating-a-chart-in-a-worksheet-using-radio-buttons.md)
