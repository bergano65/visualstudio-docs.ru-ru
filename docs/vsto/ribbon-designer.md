---
title: Конструктор лент
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- Designer_Microsoft.VisualStudio.Tools.Office.Ribbon.Design.RibbonDesigner
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- custom Ribbon, about Ribbon Designer
- controls [Office development in Visual Studio], Ribbon
- Ribbon [Office development in Visual Studio], controls
- customizing the Ribbon, about Ribbon Designer
- Ribbon [Office development in Visual Studio], visual designer
- customizing the Ribbon
- custom Ribbon
- designers [Office development in Visual Studio], Ribbon
- Ribbon [Office development in Visual Studio], customizing
- Ribbon [Office development in Visual Studio], common tasks
- Ribbon Designer [Office development in Visual Studio]
- read-only properties
- Ribbon [Office development in Visual Studio], shortcut keys
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: 7179de49f80bee847077a7f247cc11dee855be80
ms.sourcegitcommit: 37fb7075b0a65d2add3b137a5230767aa3266c74
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/02/2019
ms.locfileid: "53928871"
---
# <a name="ribbon-designer"></a>Конструктор лент
  Конструктор лент — основа для визуальной разработки. Используйте конструктор лент для добавления пользовательских вкладок, групп и элементов управления на ленту приложения Microsoft Office.

 [!INCLUDE[appliesto_ribbon](../vsto/includes/appliesto-ribbon-md.md)]

 Чтобы открыть конструктор лент, добавьте **Лента (визуальный конструктор)** в проект. Затем можно использовать средства разработки для выполнения следующих задач:

-   [Разработка макета ленты](#DesigningRibbonLayout)

-   [Обработка событий и установка свойств элемента управления](#HandleEventsSetProperties)

-   [Добавление элементов управления в представление Backstage](#CustomizingMicrosoftOfficeButton)

> [!NOTE]
>  Существуют некоторые задачи, которые невозможно выполнить с помощью конструктора лент. Дополнительные сведения об этих задачах и как их выполнения см. в разделе [Обзор ленты](../vsto/ribbon-overview.md).

 ![ссылка на видео](../vsto/media/playvideo.gif "ссылка на видео") демонстрационные видеоматериалы см. в разделе [инструкции: Использование конструктора ленты для настройки ленты в Outlook? ](http://go.microsoft.com/fwlink/?LinkID=130312).

## <a name="add-a-ribbon-visual-designer-item-to-a-project"></a>Добавление в проект элемент Лента (визуальный конструктор)
 Чтобы использовать конструктор лент, добавьте новый **Лента (визуальный конструктор)** в проект. Дополнительные сведения см. в разделе [Как Приступая к настройке ленты](../vsto/how-to-get-started-customizing-the-ribbon.md).

 При добавлении нового **Лента (визуальный конструктор)** товар, Visual Studio автоматически добавляет следующие файлы в проект:

- Файл кода ленты. Этот файл имеет имя, указанное для **Лента (визуальный конструктор)** элемент **Добавление нового элемента** диалоговое окно. Добавьте код для обработки событий ленты в этот файл.

- Файл кода конструктора лент. Этот файл содержит созданный конструктором лент код и не следует изменять непосредственно.

- Файл ресурсов. Этот файл содержит значения свойств каждого элемента управления на ленте.

  Если у вас уже есть **Лента (визуальный конструктор)** элемента из другого проекта, можно повторно использовать его в текущем проекте с помощью **добавить существующий элемент** диалоговое окно.

##  <a name="DesigningRibbonLayout"></a> Разработка ленты
 Существует три способа открыть конструктор лент:

- В **обозревателе решений**, дважды щелкните файл кода ленты.

- В **обозревателе решений**, щелкните правой кнопкой мыши файл кода ленты и затем нажмите кнопку **конструктор представлений**.

- В **обозревателе решений**, выберите файл кода ленты и нажмите кнопку **конструктор** на **представление** меню.

  Конструктор лент содержит вкладку по умолчанию и группы. По умолчанию вкладки и группы можно удалить из конструктора лент. Чтобы удалить группу по умолчанию, щелкните правой кнопкой мыши **Group1**, а затем нажмите кнопку **удалить**. Чтобы удалить вкладку по умолчанию, щелкните правой кнопкой мыши пустой участок области конструктора и нажмите кнопку **удалить вкладку ленты**.

  Можно также добавить пользовательские вкладки, группы и элементы управления в конструктор ленты. Вы найдете эти элементы управления в **элементов**в **элементы управления ленты Office** группы. Существует три способа для добавления элементов управления из **элементы управления ленты Office** группу в конструктор ленты:

- Перетащите элемент управления в необходимое положение на конструкторе лент.

- Щелкните элемент управления и выберите необходимое место на конструкторе лент.

- Выберите в конструкторе лент необходимое место, а затем дважды щелкните элемент управления в **элементов**.

### <a name="ribbon-design-workflow"></a>Процесс разработки ленты
 Выполните следующие основные шаги, чтобы разработать макет ленты.

1. [Добавление настраиваемой вкладки на ленту](#AddTabToRibbon).

2. [Добавление групп на вкладку](#AddGroupsToTab).

3. [Добавление элементов управления в группы](#AddControlsToGroups).

   Элементы управления можно перетаскивать только в группы; элемент управления нельзя перетаскивать непосредственно на вкладку или на ленту. Группы можно перетаскивать только на вкладки; группу невозможно перетащить непосредственно на ленту.

   Упорядочите элементы управления, перетаскивая их в нужное положение. Можно задать свойства элемента управления с помощью **свойства** окна.

   Элементы управления нельзя перетаскивать с одной вкладки на другой, на ленте. Если вы хотите переместить элемент управления на другую вкладку, необходимо использовать **Вырезать** команду, чтобы удалить элемент управления с одной вкладки, а затем вставьте элемент управления на другую вкладку. Если элемент управления Вырезать и вставить его, обработчик событий перестает работать. Можно заново подключить обработчик событий **свойства** окна. Дополнительные сведения см. в разделе [окно "Свойства"](../ide/reference/properties-window.md).

###  <a name="AddTabToRibbon"></a> Добавление настраиваемых вкладок на ленту
 Существует три способа добавления настраиваемой вкладки на ленту:

- Добавьте вкладку с **элементов**.

- Щелкните конструктор лент правой кнопкой мыши, а затем нажмите кнопку **добавить вкладку ленты**.

- Откройте **редактор коллекции вкладок**, а затем нажмите кнопку **добавить**.

   Чтобы открыть **редактор коллекции вкладок**в **свойства** выберите **вкладки** свойство и затем нажмите кнопку с многоточием ![ASP.NET для мобильных устройств Эллипс конструктора](../sharepoint/media/mwellipsis.gif "эллипс конструктора ASP.NET Mobile").

  После добавления вкладки на нее можно добавить группы для размещения элементов управления.

#### <a name="remove-custom-tabs-from-the-ribbon"></a>Удаление пользовательских вкладок на ленте
 Существует три способа удалить пользовательскую вкладку на ленте:

-   Щелкните правой кнопкой мыши в конструкторе, а затем нажмите кнопку **удалить вкладку ленты**.

-   В **команды** области **свойства** окно, нажмите кнопку **удалить вкладку ленты**.

-   Откройте **редактор коллекции вкладок**, перейдите на вкладку и нажмите кнопку **удалить**.

#### <a name="change-the-position-of-a-tab-on-the-ribbon"></a>Изменение положения вкладки на ленте
 Можно изменить порядок пользовательских вкладок на ленте. Кроме того, пользовательские вкладки можно разместить до или после встроенной вкладки на ленте. Дополнительные сведения см. в разделе [Как Изменение положения вкладки на ленте](../vsto/how-to-change-the-position-of-a-tab-on-the-ribbon.md).

#### <a name="customize-built-in-tabs-on-the-ribbon"></a>Настройка встроенных вкладок на ленте
 Встроенная вкладка — это вкладка, которая уже имеется на ленте приложения Microsoft Office. Например **данных** вкладка — это встроенная вкладка Excel.

 На встроенную вкладку можно добавить группы и элементы управления. По умолчанию настраиваемая группа выводится последней группы на встроенной вкладке, хотя ее можно переместить его до или после любой встроенной группы на вкладке.

 Невозможно удалить встроенные группы.

 Дополнительные сведения о настройке встроенной вкладки см. в разделе [как: Настройка встроенной вкладки](../vsto/how-to-customize-a-built-in-tab.md).

###  <a name="AddGroupsToTab"></a> Добавление групп на вкладку
 Группы используются для логического упорядочения элементов управления на ленте. Добавьте группы на вкладки. Добавьте другие элементы управления в группу.

###  <a name="AddControlsToGroups"></a> Добавление элементов управления в группы
 Добавьте один или несколько элементов управления в группу. В следующей таблице описаны каждого элемента управления.

|Элемент управления|Описание|
|-------------|-----------------|
|**Box**|Контейнер, упорядочивающий элементы управления в группе. Любой элемент управления можно добавить в поле, за исключением разделителя, группы или вкладки. Поле может быть горизонтальную или вертикальную.|
|**Button**|Кнопка, запускающая действие. Кнопки можно добавить в группу, группу кнопок, стрелку раскрывающегося списка, коллекции, меню или разворачивающуюся кнопку.|
|**ButtonGroup**|Группа, содержит один или несколько кнопок, выключателей, меню, разворачивающихся кнопок и галереи. Группу можно добавить к группе или меню.|
|**CheckBox**|Бокс, который можно устанавливать или снимать, чтобы включить или отключить параметр.|
|**ComboBox**|Поле редактирования со вложенным списком. Пользователей можно ввести или выбрать значение из списка. В окне отображается текущее выделение. Используйте <xref:Microsoft.Office.Tools.Ribbon.RibbonComboBox.Items%2A> свойство для добавления и удаления элементов во время выполнения до или после загрузки ленты в приложение Office.|
|**Раскрывающийся список**|Список элементов, которые пользователь может выбрать. Пользователь не может ввести новый элемент в раскрывающемся списке.<br /><br /> Используйте <xref:Microsoft.Office.Tools.Ribbon.RibbonDropDown.Items%2A> свойство для добавления элементов в список. Вы можете добавлять и удалять элементы во время выполнения.<br /><br /> Используйте <xref:Microsoft.Office.Tools.Ribbon.RibbonDropDown.Buttons%2A> свойство, добавляемое в список кнопок. Тем не менее нельзя добавлять и удалять кнопки во время выполнения после загрузки ленты в приложение Office.|
|**Поле ввода "**|Поле, в котором пользователь может вводить текст.|
|**Коллекция**|Меню, предоставляющее, массив или сетку визуальных вариантов, из которых пользователи могут выбрать. Вы можете управлять макет визуальных элементов в меню. Используйте <xref:Microsoft.Office.Tools.Ribbon.RibbonGallery.ColumnCount%2A> и <xref:Microsoft.Office.Tools.Ribbon.RibbonGallery.RowCount%2A> свойства, чтобы указать число строк и столбцов, которые будут отображаться элементы и кнопки коллекции.|
|**Label**|Текст, который можно использовать для определения элементов управления на ленте.|
|**Menu**|Стрелку раскрывающегося списка, который может содержать любой из следующих элементов управления:<br /><br /> -Кнопка<br />-Флажок<br />-Коллекции<br />-Меню<br />-Разворачивающаяся кнопка<br />-Кнопка переключатель<br />-Разделитель<br /><br /> Чтобы добавить элемент управления меню в конструкторе лент, нажмите кнопку со стрелкой вниз в меню — откроется рабочая область конструирования меню. Затем можно перетащить элементы управления ленты из **элементов** в меню. Чтобы упорядочить элементы управления, перетащите их в нужное положение.<br /><br /> Добавлять элементы управления к <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu> после загрузки ленты в приложение Office, необходимо задать <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu.Dynamic%2A> свойства **true** до загрузки ленты. Сведения о том, как это сделать, см. в разделе [обзор объектной модели ленты](../vsto/ribbon-object-model-overview.md).|
|**Separator**|Тонкая полоса, используемая для разделения элементов в списке. При добавлении в группу полоса становится вертикальной. При добавлении в меню полоса становится горизонтальной.|
|**SplitButton**|Кнопка с вложенным меню. Разворачивающаяся кнопка может содержать следующие элементы управления:<br /><br /> -Кнопка<br />-Флажок<br />-Коллекции<br />-Меню<br />-Разворачивающаяся кнопка<br />-Кнопка переключатель<br />-Разделитель<br /><br /> Подобно меню Разворачивающаяся кнопка обладает собственной рабочей областью конструирования. Тем не менее в отличие от меню, изменять можно только элементы в разворачивающейся кнопке до загрузки ленты в приложение Office. Сведения о том, как обновить элементы в разворачивающейся кнопке см. в разделе [обзор объектной модели ленты](../vsto/ribbon-object-model-overview.md).|
|**Выключатель**|Кнопка, отображаемая нажатой или ненажатой.|

##  <a name="HandleEventsSetProperties"></a> Обработка событий и установка свойств
 Конструктор лент позволяет задавать свойства элемента управления во время разработки с помощью **свойства** окна. Кроме того лента предоставляет модель строго типизированный объект, можно использовать для получения и задания свойств элементов управления ленты во время выполнения.

 Можно дважды щелкнуть любой элемент управления в конструкторе, чтобы открыть обработчик событий для события по умолчанию элемента управления. Можно создать обработчики событий для всех остальных событий элемента управления с помощью **свойства** окна.

 События и свойства ленты находятся в <xref:Microsoft.Office.Tools.Ribbon> пространства имен. **Лента (визуальный конструктор)** автоматически добавляет в проект ссылку на эту сборку и вставляет соответствующий **с помощью** или **Imports** инструкции сверху файла кода ленты.

 Сведения об обработке событий ленты и установка свойств элементов управления ленты во время выполнения, см. в разделе [обзор объектной модели ленты](../vsto/ribbon-object-model-overview.md).

##  <a name="CustomizingMicrosoftOfficeButton"></a> Настройка представления Backstage
 Конструктор лент можно использовать для добавления элементов управления в меню, которое открывается при нажатии кнопки **файл** вкладки. Это меню вызывает представление Backstage.

 Невозможно разместить элементы управления до или после встроенных элементов управления с помощью конструктора лент. Встроенный элемент управления является элементом управления, который уже отображается в представлении Backstage. Если вы хотите разместить элементы управления до или после встроенных элементов управления, необходимо использовать XML ленты. Дополнительные сведения о **Лента (XML)**, см. в разделе [Ribbon XML](../vsto/ribbon-xml.md). Дополнительные сведения о настройке представления Backstage см. в разделе [введение в Office 2010 Backstage для разработчиков](http://go.microsoft.com/fwlink/?LinkId=182189) и [Настройка Office 2010 Backstage для разработчиков](http://go.microsoft.com/fwlink/?LinkId=182188).

 [!INCLUDE[appliesto_ribbon_2010](../vsto/includes/appliesto-ribbon-2010-md.md)]

 Сведения о том, как добавить элементы управления в представление Backstage см. в разделе [как: Добавление элементов управления в представление Backstage](../vsto/how-to-add-controls-to-the-backstage-view.md).

##  <a name="Accessibility"></a> Специальные возможности в конструкторе лент
 Можно использовать сочетания клавиш для перемещения элементов управления в конструкторе лент. Некоторые сочетания клавиш используются для всех элементов управления, а некоторые — только для элементов управления с меню.

 В следующей таблице показаны сочетания клавиш, которые применяются ко всем элементам управления.

|Действие|Сочетание клавиш|
|------------|-----------------------|
|Переместите элемент управления, прежде чем предыдущий элемент управления в списке.|**CTRL**+**вверх**<br /><br /> **CTRL**+**слева**|
|Переместите элемент управления после следующего элемента управления в списке.|**CTRL**+**вниз**<br /><br /> **CTRL**+**справа**|
|Перемещение выделения с одного элемента управления в другую в той же группе. Для раскрывающейся панели перемещение между родительским и элементы управления в раскрывающейся панели.|**Вверх**<br /><br /> **Вниз**|
|Итерация вперед по списку всех элементов управления.|**TAB**|
|Процесс несколько раз обратным по всем элементам управления.|**SHIFT**+**TAB**|
|Удалите выбранный элемент управления или набора элементов управления.|**Удалить**|
|Копировать выбранные элементы управления.|**CTRL**+**C**|
|Вырежьте выбранные элементы управления.|**CTRL**+**X**|
|Вставка элементов управления из буфера обмена.|**CTRL**+**V**|
|Выберите **элементов**.|**CTRL**+**Alt**+**X**|
|Выделение родительского компонента.|**ESC**|

 Сочетания клавиш, применяемые только к меню Microsoft Office, <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu>, и <xref:Microsoft.Office.Tools.Ribbon.RibbonSplitButton> показаны в следующей таблице.

|Действие|Сочетание клавиш|
|------------|-----------------------|
|Выберите родительский элемент управления, если она открыта, а элемент управления на раскрывающейся панели.|**Слева**|
|Закрытие раскрывающейся панели, если она открыта и выделен родительский элемент управления.|**Слева**|
|Открытие раскрывающейся панели.|**Справа**|
|Выберите первый элемент управления на раскрывающейся панели, если она открыта.|**Справа**|
|Закрытие раскрывающейся панели.|**ESC**|

## <a name="see-also"></a>См. также

- [Обзор ленты](../vsto/ribbon-overview.md)
- [Ribbon XML](../vsto/ribbon-xml.md)
- [Пошаговое руководство: Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)
- [Практическое руководство. Экспорт лент из конструктора лент в XML-ленты](../vsto/how-to-export-a-ribbon-from-the-ribbon-designer-to-ribbon-xml.md)
- [Практическое руководство. Приступая к настройке ленты](../vsto/how-to-get-started-customizing-the-ribbon.md)
- [Доступ к ленте во время выполнения](../vsto/accessing-the-ribbon-at-run-time.md)
