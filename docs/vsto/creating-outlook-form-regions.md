---
title: Создание областей формы Outlook
description: Сведения об использовании областей форм для настройки форм Microsoft Outlook для упрощения проектирования, разработки и отладки областей форм.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- MICROSOFT.OFFICE.TOOLS.OUTLOOK.FORMREGION
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- form regions [Office development in Visual Studio]
- form regions [Office development in Visual Studio], creating
- Outlook [Office development in Visual Studio], form regions
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: ba2c4412b344a37e1b1db74cdddea8c5b60b69d0
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99947897"
---
# <a name="create-outlook-form-regions"></a>Создание областей формы Outlook
  Для настройки форм Microsoft Office Outlook можно использовать области формы. Visual Studio предоставляет расширенные средства, которые упрощают процесс проектирования, разработки и отладки областей формы.

 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]

 В данном подразделе содержатся следующие сведения.

- [Преимущества использования областей форм](#Enhance)

- [Добавление области формы Outlook в проект](#Adding)

- [Использование конструктора областей формы](#UsingFormRegionDesigner)

- [Использование области формы, разработанной в Outlook](#UsingFormRegionDesignedOutlook)

- [Добавление пользовательского кода в область формы](#AddingCustomCode)

- [Сборка проекта](#Building)

- [Отладка области формы](#Debugging)

- [Развертывание области формы](#Deploying)

## <a name="advantages-of-using-form-regions"></a><a name="Enhance"></a> Преимущества использования областей форм
 Области формы значительно расширяют традиционные возможности разработки форм Outlook.

- Настройка страницы по умолчанию любой стандартной формы.

- Добавление до 12 дополнительных страниц в любую стандартную форму.

- Замена или расширение любой стандартной формы.

- Отображение настраиваемого пользовательского интерфейса в области чтения и в инспекторах.

  Дополнительные сведения см. в разделе [Настройка страниц форм и областей форм](/office/vba/outlook/Concepts/Forms/customizing-form-pages-and-form-regions).

## <a name="add-an-outlook-form-region-to-your-project"></a><a name="Adding"></a> Добавление области формы Outlook в проект
 Мастер **создания области формы Outlook** можно использовать для создания новой области формы или импорта области формы, разработанной в Outlook. Кроме того, если у вас есть область формы, которую вы использовали в другом проекте надстройки Outlook VSTO, то эту область формы можно использовать повторно.

### <a name="create-a-new-form-region-by-using-the-wizard"></a><a name="CreatingFormRegion"></a> Создание новой области формы с помощью мастера
 Чтобы создать область формы, добавьте элемент **области формы Outlook** в проект надстройки VSTO для Outlook. Запустится мастер **создания области формы Outlook** .

 Укажите в мастере, что необходимо сделать — создать новую область формы или импортировать область формы, спроектированную в Outlook. Дополнительные сведения о проектировании новой области формы см. [в разделе Использование конструктора областей формы](#UsingFormRegionDesigner). Дополнительные сведения об использовании области формы, разработанной в Outlook, см. [в разделе Импорт области формы, разработанной в Outlook](#UsingFormRegionDesignedOutlook).

 Укажите в мастере тип области формы, которую требуется создать. В следующей таблице указаны все типы областей формы.

|Тип области|Описание|
|-----------------|-----------------|
|Отдельные|Добавляет область формы как новую страницу в форме Outlook.|
|Смежные|Добавляет область формы в нижнюю часть страницы по умолчанию формы Outlook.|
|Замена|Добавляет область формы как новую страницу, которая заменяет страницу по умолчанию формы Outlook.|
|Заменить все|Заменяет всю форму Outlook на область формы.|

 В мастере также можно указать условия отображения и выбрать тип формы для расширения. Дополнительные сведения см. в разделе [инструкции. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).

 Значения, выбираемые в мастере, влияют на параметры, доступные на других страницах мастера. Например, если выбрать **смежную** или **отдельную** страницу на странице **Создание новой области формы Outlook** , поля **заголовок** и **Описание** будут недоступны в поле **введите текст описания и выберите страницу параметров экрана** . Это объясняется тем, что при отображении смежной или отдельной области формы Outlook не использует эти поля.

#### <a name="form-region-files"></a>Файлы области формы
 После завершения работы мастера **создания области формы Outlook** Visual Studio автоматически добавляет в проект следующие файлы:

- Файл кода области формы. Этот файл имеет имя, указанное для элемента **области формы Outlook** в диалоговом окне " **Добавление нового элемента** ". Добавьте код для обработки событий области формы в этот файл.

- Файл кода конструктора областей формы. Этот файл содержит код, созданный конструктором областей формы (его не следует изменять прямо в файле).

- Файл хранилища форм Outlook (*. OFS*).

    > [!NOTE]
    > Этот файл добавляется в проект только при импорте области формы, которая была спроектирована в Outlook.

#### <a name="form-region-factory-class"></a>Класс фабрики области формы
 Файл кода области формы содержит разделяемый класс, реализующий интерфейс <xref:Microsoft.Office.Tools.Outlook.IFormRegionFactory>. Это класс фабрики областей формы. Класс фабрики областей формы отвечает за создание новых экземпляров области формы.

 Этот класс можно найти, развернув Область **фабрики области формы** .

 Мастер **создания области формы Outlook** добавляет в этот класс атрибуты, указывающие внутреннее имя области формы и классы сообщений, отображающие область формы. Эти атрибуты можно изменять вручную после добавления файла в проект.

 Основная часть класса фабрики областей формы реализована в файле конструктора областей формы. Однако обработчик событий `FormRegionInitializing` предоставляется в файле кода области формы. Этот обработчик событий можно использовать, чтобы указать, должен ли Outlook отображать область формы. Дополнительные сведения см. в разделе [обработчики событий области формы](#HandlingFormRegionEvents).

### <a name="add-an-existing-form-region-to-your-project"></a><a name="AddingExistingFormRegion"></a> Добавление существующей области формы в проект
 Если у вас есть область формы Outlook, которую вы использовали в другом проекте Outlook, ее можно повторно использовать в текущем проекте надстройки Outlook VSTO с помощью диалогового окна **Добавление существующего элемента** .

 Существующая область формы должна иметь файл кода (*VB* или *CS*); нельзя добавлять файлы хранилища форм Outlook (*. OFS*) с помощью диалогового окна **Добавление существующего элемента** . Тем не менее новую область формы можно создать путем импорта файла хранилища форм Outlook. Дополнительные сведения см. в разделе [инструкции. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).

## <a name="use-the-form-region-designer"></a><a name="UsingFormRegionDesigner"></a> Использование конструктора областей формы
 Конструктор областей формы позволяет спроектировать макет и внешний вид области формы. Вы можете перетаскивать управляемые элементы управления на поверхность конструктора, дважды щелкая элементы управления для открытия обработчиков событий и задавать свойства в окне **Свойства** .

> [!NOTE]
> Свойства, влияющие на способ отображения области формы в Outlook, находятся под узлом **Манифест** в окне **свойства** .

 Конструктор области формы доступен только в том случае, если на странице **Выбор способа создания** области формы в мастере Создание области формы **Outlook** выбрать создать **новую область формы** .

 Чтобы открыть конструктор областей формы, можно использовать три способа.

- В **Обозреватель решений** дважды щелкните файл кода области формы.

- В **Обозреватель решений** щелкните правой кнопкой мыши файл кода области формы и выберите пункт **Конструктор представлений**.

- В **Обозреватель решений** выберите файл кода области формы, а затем в меню **вид** выберите **конструктор**.

  Конструктор областей формы поддерживает только управляемые элементы управления. Добавлять собственные элементы управления Outlook нельзя.

## <a name="import-a-form-region-designed-in-outlook"></a><a name="UsingFormRegionDesignedOutlook"></a> Импорт области формы, разработанной в Outlook
 В ходе проектирования в Outlook в область формы можно добавлять собственные элементы управления Outlook. Собственные элементы управления Outlook позволяют осуществлять привязку к данным Outlook во время разработки. Тем не менее для добавления управляемых элементов управления или изменения структуры области формы конструктор областей формы использовать нельзя.

 Вы можете импортировать области форм в проект надстройки Outlook VSTO с помощью мастера **создания области формы Outlook** . На странице **выберите способ создания области формы** выберите **импортировать файл хранилища форм Outlook (. OFS)**. Затем можно перейти к расположению файла хранилища формы Outlook (*. OFS*). (Outlook сохраняет области формы в виде *OFS* -файлов.)

 Мастер **создания области формы Outlook** копирует *OFS* – файл в каталог проекта и добавляет контрольные ссылки в файл конструктора областей формы. Затем события элементов управления можно обработать в файле кода области формы.

 Для обработки событий в проекте Visual Basic выберите событие в списке имен методов в верхней части редактора кода.

 Для обработки событий в проекте C# подпишитесь на события элементов управления в методе <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing>. Дополнительные сведения см. в статьях [как подписаться на события и отменять подписаться на них &#40;руководство по программированию на C&#35;&#41;](/dotnet/csharp/programming-guide/events/how-to-subscribe-to-and-unsubscribe-from-events).

 Свойства области формы можно изменить в методе `InitializeManifest` класса фабрики областей формы.

> [!NOTE]
> Для импорта области формы необходимо работать в проекте, ориентированном на ту же версию Outlook, которая установлена на компьютере разработчика. Например, если установлено приложение Outlook 2010, то импорт области формы будет работать только в проекте, созданном с помощью шаблона проекта **надстройки Outlook 2010** .

### <a name="update-an-imported-form-regions-design"></a>Обновление структуры импортированной области формы
 Элементы управления можно добавлять, удалять или изменять в области формы. Перед этим следует создать резервную копию любого кода, добавленного в файл кода области формы. Затем откройте файл *. OFS* в Outlook, измените область формы, а затем сохраните изменения. Используйте мастер **создания области формы Outlook** , чтобы импортировать измененный файл *. OFS* . Затем код можно вставить в файл кода новой области формы.

## <a name="add-custom-code-to-a-form-region"></a><a name="AddingCustomCode"></a> Добавление пользовательского кода в область формы
 Пространство имен <xref:Microsoft.Office.Tools.Outlook> предоставляет доступ к классам, которые представляют область формы, элемент Outlook, отображающий область формы, и другие полезные элементы. Элемент **области формы Outlook** автоматически добавляет ссылку на эту сборку в проект и вставляет соответствующий оператор **using** или **Imports** в начало файла кода области формы.

 Для выполнения большинства задач программирования для Outlook можно использовать классы, методы и свойства в пространстве имен `Microsoft.Office.Interop.Outlook`. Дополнительные сведения об объектной модели Outlook см. в разделе [Общие сведения о объектной](../vsto/outlook-object-model-overview.md)модели Outlook. Примеры типичных задач, в которых используется объектная модель Outlook, см. в разделе [решения Outlook](../vsto/outlook-solutions.md).

### <a name="handle-form-region-events"></a><a name="HandlingFormRegionEvents"></a> Обработчик событий области формы
 Элемент **области формы Outlook** автоматически добавляет следующие три обработчика событий в файл кода области формы.

|Событие|Описание|
|-----------|-----------------|
|FormRegionInitializing|Возникает перед инициализацией области формы. В этом обработчике событий можно проверять условия, чтобы указать, должен ли Outlook отображать область формы. Дополнительные сведения см. [в разделе инструкции. Запрет отображения области формы в Outlook](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md).|
|FormRegionShowing|Возникает после создания экземпляра области формы, но перед отображением области формы.|
|FormRegionClosed|Возникает перед закрытием области формы.|

## <a name="build-the-project"></a><a name="Building"></a> Построение проекта
 При сборке проекта надстройки Outlook VSTO, содержащего область формы, Visual Studio добавляет в реестр следующую информацию.

- Раздел для каждого класса сообщений, связанного с одной или несколькими областями формы.

- Запись для каждой области формы и соответствующее значение, представляющее имя надстройки Outlook VSTO.

  Outlook использует эту информацию для загрузки областей формы.

## <a name="debug-a-form-region"></a><a name="Debugging"></a> Отладка области формы
 Надстройку Outlook VSTO, содержащую область формы, можно отлаживать таким же образом, как и другие проекты [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]. При запуске отладчика [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Visual Studio автоматически запускает Outlook.

 Для просмотра области формы необходимо открыть соответствующий элемент Outlook. Например, если смежная область формы добавляется в конец почтового элемента, откройте почтовый элемент.

## <a name="deploy-a-form-region"></a><a name="Deploying"></a> Развертывание области формы
 Области формы автоматически развертываются вместе со связанной надстройкой Outlook VSTO. Таким образом, для развертывания области формы никакие специальные действия выполнять не нужно. Дополнительные сведения о развертывании надстроек VSTO см. в статье [развертывание решения Office](../vsto/deploying-an-office-solution.md).

## <a name="related-topics"></a>См. также

|Заголовок|Описание|
|-----------|-----------------|
|[Рекомендации по созданию областей форм Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)|Представлены сведения, которые могут помочь оптимизировать области формы и предотвратить потенциальные проблемы.|
|[Как добавить область формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)|Показано, как создать область формы для расширения стандартной или настраиваемой Microsoft Office формы Outlook с помощью мастера **создания области формы Outlook** .|
|[Связывание области формы с классом сообщений Outlook](../vsto/associating-a-form-region-with-an-outlook-message-class.md)|Объясняется, как указать элементы Microsoft Office Outlook, которые будут отображать область формы, путем связывания области формы с классом сообщений каждого элемента.|
|[Пошаговое руководство. Проектирование области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md)|Показано, как проектировать настраиваемую область формы, которая отображается в виде новой страницы в окне инспектора элемента контактов.|
|[Пошаговое руководство. импорт области формы, разработанной в Outlook](../vsto/walkthrough-importing-a-form-region-that-is-designed-in-outlook.md)|Демонстрируется разработка области формы в Microsoft Office Outlook, а затем импорт области формы в проект надстройки VSTO для Outlook с помощью мастера **создания области формы Outlook** .|
|[Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)|Описывается написание кода для отображения, скрытия или изменения элементов управления в области формы. Пользователям предоставляется возможность выполнить код из других областей проекта с помощью класса `Globals`.|
|[Как запретить Outlook отображать область формы](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md)|Показано, как запретить в Microsoft Office Outlook отображение области формы для конкретного элемента.|
|Показано, как получить доступ к элементу Outlook, в котором отображается область формы.|
|[Пользовательские действия в областях формы Outlook](../vsto/custom-actions-in-outlook-form-regions.md)|Описывает, как предоставить пользователям возможность реагировать на элемент Outlook.|
