---
title: Общие сведения о разработке решений Office (VSTO)
description: Узнайте, как разрабатывать настройки для знакомых Microsoft Office пользовательских интерфейсов и средств, таких как функции обработки текста в Word и функции анализа данных в Excel.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- primary interop assemblies, Office
- Office development in Visual Studio, about developing solutions
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 03da1c8052140bbe23ce4d99c12d72baef18898f
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99891960"
---
# <a name="office-solutions-development-overview-vsto"></a>Общие сведения о разработке решений Office (VSTO)
  Благодаря применению Microsoft Office в качестве внешнего интерфейса для решений, можно эффективно использовать привычные пользовательские интерфейсы и инструменты Microsoft Office, например, функции обработки текста в Word, функции анализа данных в Excel и функции управления электронной почтой в Outlook. В Visual Studio можно разрабатывать решения для настройки приложений Office и добавления конкретных функций, необходимых для бизнес-процессов. Например, можно включить Word в генератор контрактов, собирающий контракты на основе уже существующих частей, которые можно сделать редактируемыми или нередактируемыми. С помощью Excel можно создать лист автоматической разработки бюджета, настраиваемый для различных проектов. Пользователи также могут применять решения Office в автономном режиме, что делает сложные решения более удобными, чем решения, построенные на основе веб-архитектуры.

 В этой статье содержится обзор типов решений Office, которые можно создавать с помощью шаблонов набора средств Visual Studio для Office (VSTO), доступных в средствах разработки решений на базе Office в Visual Studio. Общие сведения о разработке с помощью Office см. в [центре разработчиков Office](https://developer.microsoft.com/office).

## <a name="choose-an-office-project-type"></a>Выбор типа проекта Office
 В[!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] имеются следующие типы шаблонов проектов для разработки приложений Office на основе VSTO.

- **Настройки на уровне документа** , связанные с конкретным документом.

- **VSTO Add-ins** связаны с самим приложением.

  Чтобы решить, какой из этих типов проектов наилучшим образом подходит для вашего решения, определите, должен ли ваш код выполняться только в том случае, если открыт конкретный документ, или код должен быть доступен всегда, когда работает приложение. Дополнительные сведения о шаблонах проектов см. в разделе [Общие сведения о шаблонах проектов Office](../vsto/office-project-templates-overview.md).

  Типы проектов, которые можно создавать, зависят от того, какие приложения Office установлены на компьютере разработчика. Дополнительные сведения см. в разделе [доступность функций по типам приложений Office и проектов](../vsto/features-available-by-office-application-and-project-type.md).

### <a name="document-level-customizations"></a>Настройки уровня документа.
 Настройки на уровне документа состоят из сборки, которая связана с одиночным документом, книгой или шаблоном в Microsoft Office Word или Microsoft Office Excel. Сборка загружается при открытии связанного документа. Возможности создаваемых настроек доступны только в том случае, если связанный документ открыт. Настройки не могут вносить изменения на уровне приложения, например, отображать новый пункт меню или вкладку на ленте, если открыт любой документ.

 [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] содержит инструменты для создания настроек на уровне документа. Документ, подлежащий настройке, размещается в виде рабочей области конструирования в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], что позволяет проектировать документ путем перетаскивания в него элементов управления. В проектах уровня документа доступны многие другие функции [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] , например, элементы управления Windows Forms, привязка данных перетаскиванием и встроенный отладчик.

 Дополнительные сведения о настройках см. в следующих статьях:

- [Приступая к программированию настроек уровня документа для Excel](../vsto/getting-started-programming-document-level-customizations-for-excel.md)

- [Приступая к программированию настроек уровня документа для Word](../vsto/getting-started-programming-document-level-customizations-for-word.md)

- [Архитектура настроек уровня документа](../vsto/architecture-of-document-level-customizations.md)

### <a name="vsto-add-ins"></a>Надстройки VSTO
 Надстройки VSTO состоят из сборки, которая связана с приложением Microsoft Office. Как правило, надстройка VSTO начинает работать при запуске связанного приложения, хотя пользователи также могут загружать надстройки VSTO после запуска приложения. Создаваемые функции в надстройках VSTO доступны самому приложению, независимо от того, какие документы открыты.

 [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] содержит средства, помогающие создавать надстройки VSTO. Проекты надстроек включают автоматически создаваемый класс, представляющий надстройку VSTO. Этот класс предоставляет свойства и события, которые можно использовать для доступа к объектной модели ведущего приложения и выполнения кода, когда надстройка VSTO загружена и завершила работу. В проектах надстроек VSTO доступны многие другие функции [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] , например Windows Forms и встроенный отладчик.

 Дополнительные сведения о надстройках VSTO см. в следующих статьях.

- [Приступая к программированию надстроек VSTO](../vsto/getting-started-programming-vsto-add-ins.md)

- [Architecture of VSTO Add-ins](../vsto/architecture-of-vsto-add-ins.md)

## <a name="automate-office-applications-by-using-primary-interop-assemblies"></a>Автоматизация приложений Office с помощью основных сборок взаимодействия
 Вы можете программным образом включить функции приложения Office в решение путем написания кода, который обращается к объектной модели приложения. Объектные модели — это схема расположения классов, которые предоставляют функциональные возможности с помощью различных свойств и методов. Объектные модели для приложений Office отличаются друг от друга.

 Чтобы воспользоваться объектной моделью приложения Office из решения, созданного с помощью средств разработки решений на базе Office в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], необходимо применить основную сборку взаимодействия (PIA) для приложения. Основная сборка взаимодействия позволяет управляемому коду вашего решения взаимодействовать с основанной на COM объектной моделью приложения Office.

 Для выполнения большинства задач разработки необходимо, чтобы основные сборки взаимодействия Office были установлены и зарегистрированы в глобальном кэше сборок на компьютере разработчика. Дополнительные сведения см. [в статье Настройка компьютера для разработки решений Office](../vsto/configuring-a-computer-to-develop-office-solutions.md). Для запуска решений VSTO для Office наличие основных сборок взаимодействия Office на компьютере конечного пользователя не требуется. Дополнительные сведения см. в статье [Разработка и создание решений Office](../vsto/designing-and-creating-office-solutions.md).

 Дополнительные сведения об использовании основных сборок взаимодействия в решениях VSTO для Office см. в следующих статьях:

- [Написание кода в решениях Office](../vsto/writing-code-in-office-solutions.md)

- [Основные сборки взаимодействия Office](../vsto/office-primary-interop-assemblies.md)

## <a name="run-microsoft-vsto-office-solutions-on-end-user-computers"></a>Запуск решений Microsoft VSTO для Office на компьютерах конечных пользователей
 При создании решения VSTO для Office следует учитывать, как требования к развертыванию могут повлиять на выбор метода развертывания.

### <a name="deployment-options"></a>Параметры развертывания
 Для развертывания решений, созданных с помощью средств разработки решений на базе Office в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]используйте ClickOnce или установщик Windows. Развертывание с помощью ClickOnce позволяет создавать самостоятельно обновляющиеся решения, которые могут устанавливаться и работать при минимальном участии пользователя. Файлы установщик Windows (*. msi*) можно легко распространять на компьютеры конечных пользователей или распространять с помощью Systems Management Server (SMS). Дополнительные сведения о развертывании решений VSTO для Office см. в статье [развертывание решения Office](../vsto/deploying-an-office-solution.md).

### <a name="install-prerequisites"></a>Установка необходимых компонентов
 Прежде, чем пользователи смогут запустить решение, которые вы создали с помощью средств разработки решений на базе Office в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], на их компьютерах должны быть установлены некоторые необходимые компоненты. При развертывании решения с помощью ClickOnce или путем создания файла установщика Windows эти необходимые компоненты можно установить вместе с решением. Дополнительные сведения см. в статьях [Предварительные требования для решения Office для развертывания](/previous-versions/bb608617(v=vs.110)) и [руководство. Установка необходимых компонентов на компьютерах конечных пользователей для запуска решений Office](/previous-versions/bb608608(v=vs.110)).

### <a name="security"></a>Безопасность
 Для обеспечения безопасности решений VSTO для Office [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] выполняет ряд проверок безопасности при установке и загрузке решения. Эти проверки включают в себя проверку уровня доверия расположения манифеста развертывания или сертификата, используемого для подписания манифеста развертывания. Дополнительные сведения см. в статье [Защита решений Office](../vsto/securing-office-solutions.md).

## <a name="see-also"></a>См. также раздел
- [Приступая к работе &#40;разработке решений Office в Visual Studio&#41;](../vsto/getting-started-office-development-in-visual-studio.md)
- [Архитектура настроек уровня документа](../vsto/architecture-of-document-level-customizations.md)
- [Architecture of VSTO Add-ins](../vsto/architecture-of-vsto-add-ins.md)
- [Приступая к программированию настроек уровня документа для Excel](../vsto/getting-started-programming-document-level-customizations-for-excel.md)
- [Приступая к программированию настроек уровня документа для Word](../vsto/getting-started-programming-document-level-customizations-for-word.md)
- [Приступая к программированию надстроек VSTO](../vsto/getting-started-programming-vsto-add-ins.md)
