---
title: Связывание области формы с классом сообщений Outlook
description: Узнайте, как можно указать, какие Microsoft Office элементы Outlook отображают область формы, связав область формы с классом сообщений каждого элемента.
ms.custom: SEO-VS-2020
ms.date: 02/02/2017
ms.topic: conceptual
f1_keywords:
- VSTO.NewFormRegionWizard.InvalidMessageClassName
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- FormRegionMessageClassAttribute
- form regions [Office development in Visual Studio], message classes
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: 0bbbd381ff84714b780bbb817ccfea64ac05e949
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99882548"
---
# <a name="associate-a-form-region-with-an-outlook-message-class"></a>Связывание области формы с классом сообщений Outlook
  Можно указать, какие Microsoft Office элементы Outlook отображают область формы, связав область формы с классом сообщений каждого элемента. Например, если необходимо добавить область формы в нижнюю часть почтового элемента, можно связать область формы с `IPM.Note` классом Message.

 Чтобы связать область формы с классом сообщений, укажите имя класса сообщения в мастере создания **области формы Outlook** или примените атрибут к классу фабрики области формы.

 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]

## <a name="understand-outlook-message-classes"></a>Общие сведения о классах сообщений Outlook
 Класс сообщений Outlook определяет тип элемента Outlook. В следующей таблице перечислены восемь стандартных типов элементов и их имена классов сообщений.

|Тип элемента Outlook|Имя класса сообщений|
|-----------------------|------------------------|
|аппоинтментитем|`IPM.Appointment`|
|ContactItem|`IPM.Contact`|
|дистлиститем|`IPM.DistList`|
|жаурналитем|`IPM.Activity`|
|MailItem|`IPM.Note`|
|PostItem|`IPM.Post` либо `IPM.Post.RSS`|
|TaskItem|`IPM.Task`|

 Можно также указать имена пользовательских классов сообщений. Пользовательские классы сообщений определяют пользовательские формы, определяемые в Outlook.

> [!NOTE]
> Для замещающих и заменяющих области формы можно указать новое имя пользовательского класса сообщений. Не нужно использовать имя класса сообщений существующей настраиваемой формы. Имя пользовательского класса сообщений должно быть уникальным. Одним из способов обеспечения уникальности имени является использование соглашения об именовании, аналогичного следующему: \<*StandardMessageClassName*> . \<*Company*> .\<*MessageClassName*> (например: `IPM.Note.Contoso.MyMessageClass` ).

## <a name="associate-a-form-region-with-an-outlook-message-class"></a>Связывание области формы с классом сообщений Outlook
 Существует два способа связать область формы с классом сообщений:

- Используйте мастер **создания области формы Outlook** .

- Примените атрибуты класса.

### <a name="use-the-new-outlook-form-region-wizard"></a>Использование мастера создания области формы Outlook
 На последней странице мастера **создания области формы Outlook** можно выбрать стандартные классы сообщений и ввести имена пользовательских классов сообщений, которые нужно связать с областью формы.

 Стандартные классы сообщений недоступны, если область формы предназначена для замены всей формы или страницы по умолчанию в форме. Можно указать имена стандартных классов сообщений только для форм, которые добавляют новую страницу в форму или добавляются в нижнюю часть формы. Дополнительные сведения см. в разделе [инструкции. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).

 Чтобы включить один или несколько пользовательских классов сообщений, введите их имена в поля **настраиваемых классов сообщений, которые будут отображаться в этой области формы** .

 Введенные имена должны соответствовать следующим рекомендациям.

- Используйте полное имя класса сообщений (например: "IPM. Примечание. contoso ").

- Используйте точки с запятой для разделения нескольких имен классов сообщений.

- Не включайте стандартные классы сообщений Outlook, такие как IPM. Обратите внимание на «или» IPM. Contact ". Включайте только пользовательские классы сообщений, например "IPM. Примечание. contoso ".

- Не указывайте сам базовый класс Message (например, "IPM").

- Не более 256 символов для каждого имени класса сообщений.

  Мастер **создания области формы Outlook** проверяет формат вводимых данных после нажатия кнопки **Готово**.

> [!NOTE]
> Мастер **создания области формы Outlook** не проверяет правильность или допустимости предоставленных имен классов сообщений.

 После завершения работы мастера мастер **создания области формы Outlook** применяет атрибуты к классу области формы, содержащему указанные имена классов сообщений. Эти атрибуты также можно применить вручную.

### <a name="apply-class-attributes"></a>Применить атрибуты класса
 Можно связать область формы с классом сообщений Outlook после завершения работы мастера **создания области формы Outlook** . Для этого примените атрибуты к классу фабрики области формы.

 В следующем примере показаны два <xref:Microsoft.Office.Tools.Outlook.FormRegionMessageClassAttribute> атрибута, которые были применены к классу фабрики области формы с именем `myFormRegion` . Первый атрибут связывает область формы со стандартным классом сообщений для формы почтового сообщения. Второй атрибут связывает область формы с пользовательским классом сообщений с именем `IPM.Task.Contoso` .

 [!code-vb[Trin_Outlook_FR_Attributes#1](../vsto/codesnippet/VisualBasic/Trin_Outlook_FR_Attributes/FormRegion1.vb#1)]
 [!code-csharp[Trin_Outlook_FR_Attributes#1](../vsto/codesnippet/CSharp/Trin_Outlook_FR_Attributes/FormRegion1.cs#1)]

 Атрибуты должны соответствовать следующим рекомендациям.

- Для пользовательских классов сообщений используйте полное имя класса сообщений (например, "IPM. Примечание. contoso ").

- Не указывайте сам базовый класс Message (например, "IPM").

- Не более 256 символов для каждого имени класса сообщений.

- Не включайте имена стандартных классов сообщений, если область формы заменяет всю форму или страницу по умолчанию в форме. Можно указать имена стандартных классов сообщений только для форм, которые добавляют новую страницу в форму или добавляются в нижнюю часть формы. Дополнительные сведения см. в разделе [инструкции. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).

  Visual Studio проверяет формат имен классов сообщений при сборке проекта.

> [!NOTE]
> Visual Studio не проверяет правильность или допустимости предоставленных имен классов сообщений.

## <a name="see-also"></a>См. также раздел
- [Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)
- [Создание областей формы Outlook](../vsto/creating-outlook-form-regions.md)
- [Пошаговое руководство. Проектирование области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md)
- [Рекомендации по созданию областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)
- [Общие сведения о имени формы и классе сообщений](/office/vba/outlook/Concepts/Forms/form-name-and-message-class-overview)
- [Совместная работа форм и элементов Outlook](/office/vba/outlook/Concepts/Forms/how-outlook-forms-and-items-work-together)
