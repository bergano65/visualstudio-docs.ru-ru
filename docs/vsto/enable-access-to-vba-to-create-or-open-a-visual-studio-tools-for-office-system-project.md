---
title: Доступ к VBA для создания и открытия проекта системы VSTO
titleSuffix: ''
description: Сведения о том, что необходимо явно разрешить доступ к системе проектов Office VBA, прежде чем можно будет создать или открыть проект Инструменты Visual Studio для системы Office.
ms.custom: seodec18, SEO-VS-2020
ms.date: 08/14/2019
ms.topic: conceptual
f1_keywords:
- vst.project.vbawrongversion
- VST.Project.VBASecurityGenericError
- VST.Project.VBASecurityPermissions
- VST.SelectDocWizard.MissingCOM
- VST.Project.VBASecurityNotSet
dev_langs:
- VB
- CSharp
author: John-Hart
ms.author: johnhart
manager: jmartens
ms.workload:
- office
ms.openlocfilehash: ef68ffccd7a048cd0591ee0bf1aa511fe0489c92
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99910518"
---
# <a name="enable-access-to-vba-to-create-or-open-a-visual-studio-tools-for-the-microsoft-office-system-project"></a>Предоставление доступа к VBA для создания или открытия Инструменты Visual Studio для проекта Microsoft Office системы

Необходимо явно разрешить доступ к системе проектов Visual Basic для приложений (VBA) в Microsoft Office, прежде чем можно будет создать или открыть Инструменты Visual Studio для Microsoft Office системного проекта.

 Microsoft Office проектам разработки требуется доступ к системе проектов Visual Basic для приложений (VBA) в Microsoft Office Word и Microsoft Office Excel, даже если в проектах не используется Visual Basic для приложений. Поддержка элементов управления времени разработки в проектах Visual Basic и C# зависит от системы проектов Visual Basic для приложений.

 Некоторые макровирусы Microsoft Office пытаются автоматизировать систему проектов Visual Basic для приложений как способ своего распространения. Разрешая доступ к системе проектов Visual Basic для приложений, вы отключаете средство защиты, которое позволяет предотвратить распространение макровирусов. Тем не менее, остаются стандартные средства обеспечения безопасности макросов: уровень безопасности макросов и список надежных издателей, поддерживаемый для приложений Office, помогут выявить выполнение макросов на компьютере.

> [!NOTE]
> Это касается только компьютера разработки. На компьютерах конечных пользователей этот параметр не требуется включать для запуска решений Office.

 Важно отметить, что отключение доступа к системе проектов Visual Basic для приложений само по себе не защитит вас от вирусов, оно просто помогает предотвратить распространение некоторых вирусов в другие документы в случае заражения компьютера макровирусом. Эта возможность отключена по умолчанию, что обеспечивает дополнительный уровень защиты компьютера. Однако ее включение не делает ваш компьютер более подверженным атакам, если вы выполняете рекомендации по обеспечению безопасности.

 Наиболее надежная защита от макровирусов для Office заключается в том, чтобы запускать Office на высоком или высоком уровне безопасности, доверять только макросам проверенных, известных источников и оставаться в курсе обновлений безопасности и сканеров вирусов.

 Вы можете включить или отключить параметр **Доверять доступ к Visual Basic проекту** вручную.

 При появлении ошибок VBA или COM можно восстановить установку Office.

[!include[Add-ins note](includes/addinsnote.md)]

## <a name="to-enable-or-disable-access-to-visual-basic-projects"></a>Включение и отключение доступа к Visual Basic проектам

1. Перейдите на вкладку **Файл** .

2. Щелкните **Параметры**.

3. Щелкните **центр управления безопасностью**, а затем — **Параметры центра управления безопасностью**.

4. В **центре управления безопасностью** щелкните **Параметры макросов**.

5. Установите или снимите флажок **Доверять доступ к объектной модели проекта VBA** , чтобы включить или отключить доступ к Visual Basic проектам.

6. Нажмите кнопку **OK**.

### <a name="to-enable-or-disable-access-to-visual-basic-projects-with-the-2007-microsoft-office-system"></a>Включение и отключение доступа к Visual Basic проектам с помощью системы Microsoft Office 2007

1. В меню **Сервис** в Word или Excel укажите пункт **макрос**, а затем выберите пункт **Безопасность**.

2. В диалоговом окне **Безопасность** перейдите на вкладку **Доверенные издатели** .

3. Выберите для включения или снимите флажок, чтобы отключить, **Доверять доступ к Visual Basic проекту**.

4. Нажмите кнопку **OK**.

## <a name="to-set-your-office-macro-security-level"></a>Настройка уровня безопасности макросов в Office

1. Перейдите на вкладку **Файл** .

2. Щелкните **Параметры**.

3. Щелкните **центр управления безопасностью**, а затем — **Параметры центра управления безопасностью**.

4. В **центре управления безопасностью** щелкните **Параметры макросов**.

5. В разделе **Параметры макросов** выберите нужный параметр.

6. Нажмите кнопку **OK**.

### <a name="to-set-your-office-macro-security-level-with-the-2007-microsoft-office-system"></a>Настройка уровня безопасности макросов Office с помощью системы 2007 Microsoft Office

1. В меню **Сервис** в Word или Excel укажите пункт **макрос**, а затем выберите пункт **Безопасность**.

2. На вкладке **уровень безопасности** выберите нужный параметр.

    На вкладке **уровень безопасности** содержатся сведения о каждом уровне. Дополнительные сведения см. в разделе "Уровни безопасности макросов" справки Microsoft Office.

### <a name="to-install-vba-with-the-2007-microsoft-office-system"></a>Установка VBA в выпуске 2007 системы Microsoft Office

1. На панели управления запустите элемент **Установка и удаление программ** или **программы и компоненты**.

2. Выберите Office в списке **установленные программы** .

3. Нажмите кнопку **Изменить**.

4. Выберите **Добавить или удалить компоненты**, а затем нажмите кнопку **продолжить**.

5. Выберите пункт **Расширенная настройка приложений**, а затем нажмите кнопку **Далее**.

6. Разверните узел **Общие компоненты Office** в списке **выберите параметры обновления для приложений и средств** .

7. Откройте раскрывающееся меню рядом с **Visual Basic для приложений**, а затем выберите **выполнить из мой компьютер**.

8. Нажмите кнопку **Continue**(Продолжить).

9. Нажмите кнопку **Закрыть**.

## <a name="to-repair-your-installation-of-office"></a>Восстановление установки Office

1. На панели управления запустите элемент **Установка и удаление программ** или **программы и компоненты**.

2. Выберите текущую версию Office в списке **установленные программы** .

3. Нажмите кнопку **Изменить**.

4. Выберите **переустановить или восстановить**, а затем нажмите кнопку **Далее**.

5. Выберите **Обнаружение и исправление ошибок в установке Office**, а затем нажмите кнопку **установить**.

## <a name="see-also"></a>См. также раздел
- [Безопасные решения Office](../vsto/securing-office-solutions.md)
