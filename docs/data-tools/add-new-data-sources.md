---
title: Добавление новых источников данных
description: Добавление новых источников данных в Visual Studio. Источник данных — это объект .NET, который подключается к хранилищу данных и делает данные доступными для приложения .NET.
ms.date: 11/21/2018
ms.topic: how-to
f1_keywords:
- vs.datasource.datasourcefieldspicker
helpviewer_keywords:
- data [Visual Studio], data sources
- data sources
ms.assetid: ed28c625-bb89-4037-bfde-cfa435d182a2
author: ghogen
ms.author: ghogen
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: 51d7d2bb7a7037d3fbcf307c620e9aca702ac370
ms.sourcegitcommit: 0893244403aae9187c9375ecf0e5c221c32c225b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/09/2020
ms.locfileid: "94382121"
---
# <a name="add-new-data-sources"></a>Добавление новых источников данных

:::moniker range="vs-2019"
> [!NOTE]
> Функции, описанные в этой статье, применимы к .NET Framework Windows Forms и разработке WPF. В Visual Studio 2019 (и предыдущих версиях) функции не поддерживаются для разработки .NET Core, как для WPF, так и для Windows Forms.
:::moniker-end

В контексте средств работы с данными .NET в Visual Studio термин *источник данных* относится к объектам .NET, которые подключаются к хранилищу данных и делают данные доступными для приложения .NET. Разработчики Visual Studio могут использовать выходные данные источника данных для создания стандартного кода, который привязывает данные к формам при перетаскивании объектов базы данных из окна **Источники данных** . Этот тип источника данных может быть следующим:

- Класс в модели Entity Framework, связанный с некоторым типом базы данных.

- Набор данных, связанный с некоторым типом базы данных.

- Класс, представляющий сетевую службу, такую как служба данных Windows Communication Foundation (WCF) или служба RESTFUL.

- Класс, представляющий службу SharePoint.

- Класс или коллекция в решении.

> [!NOTE]
> Если вы не используете функции привязки данных, наборы данных, Entity Framework, LINQ to SQL, WCF или SharePoint, понятие «Data Source» не применяется. Просто подключитесь непосредственно к базе данных с помощью объектов SQLCommand и напрямую взаимодействует с базой данных.

Создание и изменение источников данных осуществляется с помощью **мастера настройки источника данных** в Windows Forms или Windows Presentation Foundation приложении. Для Entity Framework сначала создайте классы сущностей, а затем запустите мастер, выбрав **проект**  >  **Добавить новый источник данных** (подробно см. Далее в этой статье).

![мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png)

## <a name="data-sources-window"></a>Источники данных - окно

После создания источник данных отображается в окне инструментов **Источники данных** .

> [!TIP]
> Чтобы открыть окно " **Источники данных** ", убедитесь, что проект открыт, а затем нажмите клавиши **SHIFT** + **ALT** + **D** или кнопку **Просмотр**  >  **других**  >  **источников данных** Windows.

Источник данных можно перетащить из окна **Источники данных** в область конструктора или на элемент управления формы. Это приводит к формированию стандартного кода, отображающего данные из хранилища данных.

На следующем рисунке показан набор данных, который был удален в форму Windows Forms. Если нажать **клавишу F5** в приложении, данные из базовой базы данных отобразятся в элементах управления формы.

![Операция перетаскивания источника данных](../data-tools/media/raddata-data-source-drag-operation.png)

## <a name="data-source-for-a-database-or-a-database-file"></a>Источник данных для базы данных или файла базы данных

Можно создать набор данных или модель Entity Framework для использования в качестве источника данных для базы данных или файла базы данных.

### <a name="dataset"></a>Dataset

Чтобы создать набор данных в качестве источника данных, запустите **Мастер настройки источника данных** , выбрав **проект**  >  **Добавить новый источник данных**. Выберите **базу** данных-источник и следуйте инструкциям на экране, чтобы указать новое или существующее подключение к базе данных или файл базы данных.

### <a name="entity-classes"></a>Классы сущностей

Чтобы создать модель Entity Framework в качестве источника данных, выполните следующие действия.

1. Запустите **мастер EDM** , чтобы создать классы сущностей. Выберите **проект**  >  **Добавить новый элемент**  >  **ADO.NET EDM**.

   ![Новый элемент проекта модели Entity Framework](../data-tools/media/raddata-new-entity-framework-model-project-item.png)

1. Выберите метод, по которому требуется создать модель.

   ![мастер модели данных с использованием сущностей](../data-tools/media/raddata-entity-data-model-wizard.png)

1. Добавьте модель в качестве источника данных. Созданные классы отображаются в **мастере настройки источника данных** при выборе категории **объекты** .

   ![Мастер настройки источников данных с классами сущностей](../data-tools/media/raddata-data-source-configuration-wizard-with-entity-classes.png)

## <a name="data-source-for-a-service"></a>Источник данных для службы

Чтобы создать источник данных из службы, запустите **Мастер настройки источника данных** и выберите тип источника данных **службы** . Это просто ярлык диалогового окна **Добавление ссылки на службу** , доступ к которому можно получить, щелкнув правой кнопкой мыши проект в **Обозреватель решений** и выбрав пункт **Добавить ссылку на службу**.

При создании источника данных из службы Visual Studio добавляет в проект ссылку на службу. Visual Studio также создает прокси-объекты, которые соответствуют объектам, возвращаемым службой. Например, служба, возвращающая набор данных, представлена в проекте как набор данных. Служба, которая возвращает конкретный тип, представлена в проекте как возвращаемый тип.

Источник данных можно создать из следующих типов служб:

- [Службы данных WCF](/dotnet/framework/data/wcf/wcf-data-services-overview)

- [Службы WCF](../data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio.md)

- Веб-службы

    > [!NOTE]
    > Элементы, отображаемые в окне **Источники данных** , зависят от данных, возвращаемых службой. Некоторые службы могут предоставлять недостаточный объем информации для того, чтобы **Мастер настройки источника данных** создал объекты с возможностью привязки. Например, если служба возвращает нетипизированный набор данных, в окне **Источники данных** не отображаются никакие элементы после завершения работы мастера. Это обусловлено тем, что нетипизированные наборы данных не предоставляют схему, и поэтому мастер не содержит достаточно сведений для создания источника.

## <a name="data-source-for-an-object"></a>Источник данных для объекта

Источник данных можно создать из любого объекта, предоставляющего одно или несколько открытых свойств, запустив **Мастер настройки источника данных** , а затем выбрав тип источника данных **объекта** . Все открытые свойства объекта отображаются в окне **Источники данных** . Если вы используете Entity Framework и создали модель, здесь можно найти классы сущностей, которые являются источниками данных для вашего приложения.

На странице **Выбор объектов данных** разверните узлы в представлении в виде дерева, чтобы выбрать объекты, к которым необходимо выполнить привязку. Представление в виде дерева содержит узлы проекта, а также сборки и другие проекты, на которые ссылается проект.

Если требуется выполнить привязку к объекту в сборке или проекте, который не отображается в древовидном представлении, нажмите кнопку **Добавить ссылку** и используйте **диалоговое окно Добавление ссылки** , чтобы добавить ссылку на сборку или проект. После добавления ссылки сборка или проект добавляются в представление в виде дерева.

> [!NOTE]
> Возможно, потребуется построить проект, содержащий объекты, прежде чем они появятся в представлении в виде дерева.

> [!NOTE]
> Для поддержки привязки данных при перетаскивании объекты, реализующие <xref:System.ComponentModel.ITypedList> интерфейс или, <xref:System.ComponentModel.IListSource> должны иметь конструктор по умолчанию. В противном случае Visual Studio не сможет создать экземпляр объекта источника данных и выведет сообщение об ошибке при перетаскивании элемента в область конструктора.

## <a name="data-source-for-a-sharepoint-list"></a>Источник данных для списка SharePoint

Источник данных можно создать из списка SharePoint, запустив **Мастер настройки источника данных** и выбрав тип источника данных **SharePoint** . SharePoint предоставляет данные через WCF Data Services, поэтому создание источника данных SharePoint аналогично созданию источника данных из службы. При выборе элемента **SharePoint** в **мастере настройки источника данных** открывается диалоговое окно **Добавление ссылки на службу** , в котором можно подключиться к службе данных SharePoint, указав сервер SharePoint. Для этого требуется пакет SDK для SharePoint.

## <a name="see-also"></a>См. также

- [Visual Studio Data Tools для .NET](../data-tools/visual-studio-data-tools-for-dotnet.md)
