---
title: Отладка приложения JavaScript или TypeScript
description: Visual Studio поддерживает отладку приложений JavaScript и TypeScript
ms.date: 11/01/2019
ms.topic: how-to
ms.devlang: javascript
author: mikejo5000
ms.author: mikejo
manager: jmartens
dev_langs:
- JavaScript
ms.workload:
- nodejs
ms.openlocfilehash: 79e72f5bc7d3a69d6e77bf32fb9b4f96934adb52
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99919337"
---
# <a name="debug-a-javascript-or-typescript-app-in-visual-studio"></a>Отладка приложения JavaScript или TypeScript в Visual Studio

Visual Studio позволяет выполнять отладку кода JavaScript и TypeScript. Вы можете задавать и использовать точки останова, подключать отладчик, проверять значения переменных, просматривать стек вызовов и применять другие функции отладки.

> [!TIP]
> Установите Visual Studio бесплатно со страницы [скачиваемых материалов Visual Studio](https://visualstudio.microsoft.com/downloads/), если еще не сделали этого. В зависимости от методов, используемых для разработки приложений, вам может потребоваться установить вместе с Visual Studio рабочую нагрузку **Разработка Node.js**.

## <a name="debug-server-side-script"></a>Отладка серверного скрипта

1. Открыв проект в Visual Studio, откройте файл JavaScript с серверным скриптом (например, *server.js*) и щелкните в области слева, чтобы задать точку останова:

    ![Снимок экрана: окно кода Visual Studio, в котором отображается код JavaScript. Красная точка в левом поле указывает, что точка останова установлена.](../javascript/media/tutorial-nodejs-react-set-breakpoint.png)

    Точки останова — это один из самых простых и важных компонентов надежной отладки. Точка останова указывает, где Visual Studio следует приостановить выполнение кода, чтобы вы могли проверить значения переменных или поведение памяти либо выполнение ветви кода.

1. Чтобы запустить приложение, нажмите клавишу **F5** (или выберите пункт меню **Отладка** > **Начать отладку**).

    Выполнение отладчика прервется в установленной точке останова (текущий оператор выделяется желтым цветом). Теперь вы можете изучить состояние приложения, наводя указатель мыши на переменные в текущей области и используя окна отладчика, такие как **Локальные** и **Контрольные значения**.

1. Чтобы продолжить выполнение приложения, нажмите клавишу **F5**.

1. Если вы хотите использовать Средства Chrome для разработчиков (средства F12), нажмите клавишу **F12**. С их помощью можно изучить модель DOM и взаимодействовать с приложением с помощью консоли JavaScript.

## <a name="debug-client-side-script"></a>Отладка клиентского скрипта

::: moniker range=">=vs-2019"
Visual Studio обеспечивает отладку на стороне клиента только для Chrome и Microsoft Edge (Chromium). В некоторых сценариях отладчик автоматически останавливается на точках останова в коде JavaScript и TypeScript, в том числе во внедренных в HTML-файлы скриптах. Сведения об отладке сценария на стороне клиента в приложениях ASP.NET см. в записи блога [Отладка JavaScript в Microsoft Edge](https://devblogs.microsoft.com/visualstudio/debug-javascript-in-microsoft-edge-from-visual-studio/) и этом [записи в Google Chrome](https://devblogs.microsoft.com/aspnet/client-side-debugging-of-asp-net-projects-in-google-chrome). См. сведения об отладке TypeScript в ASP.NET Core см. в руководстве по [созданию приложения ASP.NET Core с помощью TypeScript](tutorial-aspnet-with-typescript.md).
::: moniker-end
::: moniker range="vs-2017"
Visual Studio поддерживает отладку на стороне клиента только для браузеров Chrome и Internet Explorer. В некоторых сценариях отладчик автоматически останавливается на точках останова в коде JavaScript и TypeScript, в том числе во внедренных в HTML-файлы скриптах. Сведения об отладке сценария на стороне клиента в приложениях ASP.NET см. в записи блога [Client-side debugging of ASP.NET projects in Google Chrome](https://devblogs.microsoft.com/aspnet/client-side-debugging-of-asp-net-projects-in-google-chrome/) (Отладка проектов ASP.NET на стороне клиента в Google Chrome).
::: moniker-end

Для приложений, отличных от ASP.NET, выполните действия, описанные здесь.

### <a name="prepare-your-app-for-debugging"></a>Подготовка приложения к отладке

Если для кода применена минификация или он создан в транспайлере, например в TypeScript или Babel, для оптимизации возможностей отладки следует применить [сопоставления источника](#generate_source_maps). Подключить отладчик к запущенному клиентскому скрипту вы сможете даже без сопоставлений источника. Но в этом случае вы сможете задавать и использовать точки останова только в файле с минифицированным или созданным в транспайлере кодом, но не в исходном файле кода. Например, в приложении Vue.js минифицированный скрипт передается в формате строки в инструкцию `eval`, и другого способа пошагового выполнения этого кода в отладчике Visual Studio, кроме сопоставлений источника, нет. В сложных сценариях отладки вы можете использовать также средства для разработчиков в Chrome или средства F12 для Microsoft Edge.

Сведения о создании сопоставителей с исходным кодом см. в разделе [Создание сопоставлений источника для отладки](#generate_source_maps).

### <a name="prepare-the-browser-for-debugging"></a><a name="prepare_the_browser_for_debugging"></a> Подготовка браузера к отладке

::: moniker range=">=vs-2019"
Для этого сценария используйте Microsoft Edge (Chromium), в настоящее время называемый **Microsoft Edge Beta** в IDE, или Chrome.
::: moniker-end
::: moniker range="vs-2017"
Для этого сценария используйте Chrome.
::: moniker-end

1. Закройте все окна целевого браузера.

   Другие экземпляры браузера могут препятствовать его открытию при включенной отладке. (Работающие расширения браузера могут препятствовать полному режиму отладки, поэтому для обнаружения неожиданных экземпляров Chrome может понадобиться открыть диспетчер задач).

   ::: moniker range=">=vs-2019"
   Для Microsoft Edge (Chromium) также отключите все экземпляры Chrome. Это дает лучшие результаты, поскольку оба браузера используют базу кода Chromium.
   ::: moniker-end

2. Запустите браузер с включенной отладкой.

    ::: moniker range=">=vs-2019"
    Начиная с Visual Studio 2019 флаг `--remote-debugging-port=9222` можно задать при запуске браузера, выбрав **Просмотреть с помощью...**  > из панели инструментов **Отладка**, **Добавить**, а затем установив соответствующий флаг в поле **Аргументы**. Используйте другое понятное для браузера имя, например, **Microsoft Edge с отладкой** или **Chrome с отладкой**. Подробности см. в [заметках о выпуске](/visualstudio/releases/2019/release-notes-v16.2).

    ![Настройка браузера на открытие с включенной отладкой](../javascript/media/tutorial-nodejs-react-edge-with-debugging.png)

    Также можно открыть команду **Выполнить** кнопки **Пуск** в Windows (щелкнуть правой кнопкой мыши команду **Выполнить**) и ввести следующую команду:

    `msedge --remote-debugging-port=9222`

    или

    `chrome.exe --remote-debugging-port=9222`
    ::: moniker-end

    ::: moniker range="vs-2017"
    Щелкните правой кнопкой мыши кнопку **Пуск** Windows, выберите команду **Выполнить** и введите следующую команду **:**

    `chrome.exe --remote-debugging-port=9222`
    ::: moniker-end

    Ваш браузер будет запущен в режиме отладки.

    Приложение еще не запущено, поэтому вы видите пустую страницу браузера.

### <a name="attach-the-debugger-to-client-side-script"></a>Подключение отладчика к сценарию на стороне клиента

Чтобы подключить отладчик из Visual Studio и использовать точки останова в коде на стороне клиента, необходимо правильно настроить процесс в отладчике. Ниже описывается один из способов.

1. Перейдите в Visual Studio, а затем установите точку останова в исходном коде, который может быть файлом JavaScript, TypeScript или JSX. (Выберите для точки останова строку кода, в которой допустимы точки останова, например оператор return или объявление var).

    ![Снимок экрана: окно кода Visual Studio. Выбран оператор return. Красная точка в левом поле указывает, что точка останова установлена.](../javascript/media/tutorial-nodejs-react-set-breakpoint-client-code.png)

    Чтобы найти конкретный код в транспонированном файле, используйте **Ctrl**+**F** (**Изменить** > **Найти и заменить**  > **Быстрый поиск**).

    Для кода на стороне клиента, чтобы попасть в точку останова в файле TypeScript, *.vue* или JSX, как правило, необходимо использовать [сопоставитель с исходным кодом](#generate_source_maps). Сопоставитель с исходным кодом следует правильно настроить, чтобы он поддерживал отладку в Visual Studio.

2. Выберите ваш целевой браузер в качестве целевого объекта отладки в Visual Studio, нажмите клавиши **CTRL**+**F5** (**Отладка** > **Запуск без отладки**), чтобы запустить приложение в браузере.

    ::: moniker range=">=vs-2019"
    Если вы создали конфигурацию браузера с понятным именем, выберите ее в качестве цели отладки.
    ::: moniker-end

    Приложение откроется в новой вкладке браузера.

3. Выберите **Отладка** > **Присоединение к процессу**.

    > [!TIP]
    > Начиная с Visual Studio 2017, после первого присоединения к процессу с помощью этих инструкций, дальнейшее присоединение можно выполнять с помощью команды **Отладка** > **Повторно подключиться к процессу**.

4. В диалоговом окне **Присоединить к процессу** получите отфильтрованный список экземпляров браузера для присоединения.
    ::: moniker range=">=vs-2019"
    В Visual Studio 2019 выберите правильный отладчик для вашего целевого браузера, **JavaScript (Chrome)** или **JavaScript (Microsoft Edge — Chromium)** в поле **Присоединить к**, введите **chrome** или **edge** в поле фильтра, чтобы отфильтровать результаты поиска.
    ::: moniker-end
    ::: moniker range="vs-2017"
    В Visual Studio 2017 выберите в поле **Присоединить к** элемент **Код Webkit** и введите **chrome** в поле фильтра, чтобы отфильтровать результаты поиска.
    ::: moniker-end

5. Выберите процесс браузера с соответствующим портом узла (localhost в этом примере) и нажмите кнопку **Присоединить**.

    Порт (например 1337) также может отображаться в поле **Заголовок**, чтобы помочь выбрать правильный экземпляр браузера.

    ::: moniker range=">=vs-2019"
    В следующем примере показано, как это выглядит в браузере Microsoft Edge (Chromium).

    ![Присоединение к процессу](../javascript/media/tutorial-nodejs-react-attach-to-process-edge.png)
    ::: moniker-end
    ::: moniker range="vs-2017"
    ![Присоединение к процессу](../javascript/media/tutorial-nodejs-react-attach-to-process.png)

    Определить, что отладчик присоединился правильно, можно по открытию проводника DOM и консоли JavaScript в Visual Studio. Эти средства отладки аналогичны инструментам Chrome для разработчиков и средствам F12 для Microsoft Edge.
    ::: moniker-end

    > [!TIP]
    > Если отладчик не присоединяется и появляется сообщение "Не удалось запустить адаптер отладки" или "Не удалось присоединиться к процессу. Операция недопустима в текущем состоянии" — попробуйте закрыть все экземпляры целевого браузера в диспетчере задач перед попыткой запуска целевого браузера в режиме отладки. Возможно, в браузере выполняются расширения, которые препятствуют переходу в режим полной отладки.

6. Обновите страницу браузера, поскольку код с точкой останова возможно уже был выполнен. При необходимости выполните действия, приводящие к выполнению кода с точкой останова.

    Когда отладчик приостановит выполнение, вы можете изучить состояние приложения, наводя указатель мыши на переменные и используя окна отладчика. Вы также можете выполнять пошаговую отладку кода (клавиши **F5**, **F10** и **F11**). Дополнительные сведения об основных функциях отладки см. в разделе [Первое знакомство с отладчиком](../debugger/debugger-feature-tour.md).

    В зависимости от типа приложения, выполненных ранее шагов и других факторов, таких как состояние браузера, вы можете попасть в точку останова транскомпилированного файла *.js* либо исходного файла. В любом случае вы можете выполнять пошаговую отладку кода и просматривать переменные.

   * Если вам нужно декомпозировать код в исходном файле TypeScript, JSX или *.vue* и вы не можете это сделать, убедитесь, что ваша среда настроена правильно, как описано в разделе [Устранение неисправностей](#troubleshooting_source_maps).

   * Если вам нужно декомпозировать код в файле с компиляцией в код на языке программирования JavaScript (например, *app-bundle.js*), но сделать это не удается, удалите файл сопоставления источника *filename.js.map*.

### <a name="troubleshooting-breakpoints-and-source-maps"></a><a name="troubleshooting_source_maps"></a> Устранение неполадок точек останова и сопоставителей с исходным кодом

Если вам нужно декомпозировать код в исходном файле TypeScript или JSX, но сделать это не удается, используйте **Присоединить к процессу**, чтобы подключить отладчик, как описано в предыдущих этапах. Убедитесь, что ваша среда настроена правильно:

* Вы закрыли все экземпляры браузера, включая расширения Chrome (с помощью диспетчера задач) для запуска браузера в режиме отладки.
      
* Обязательно [запустите браузер в режиме отладки](#prepare_the_browser_for_debugging).

* Убедитесь, что файл сопоставителя с исходным кодом содержит правильный относительный путь к исходному файлу и не включает неподдерживаемые префиксы, такие как *webpack:///* , которые не позволяют отладчику Visual Studio найти исходный файл. Например, ссылку, подобную *webpack:///.app.tsx*, можно исправить на *./app.tsx*. Это можно сделать вручную в файле сопоставителя с исходным кодом (что удобно для тестирования) или с помощью пользовательской конфигурации сборки. Дополнительные сведения см. в разделе [Создание сопоставителя с исходным кодом для отладки](#generate_source_maps).

Либо, если вам нужно декомпозировать код в исходном файле (например *app.tsx*), но сделать это не удается, попробуйте использовать оператор `debugger;` в исходном файле или установите точки останова в инструментах для разработчиков в Chrome (или средства F12 для Microsoft Edge).

## <a name="generate-source-maps-for-debugging"></a><a name="generate_source_maps"></a> Создание сопоставлений источника для отладки

В Visual Studio можно использовать и создавать сопоставления источника для исходных файлов JavaScript. Такая возможность часто нужна, когда исходный код минифицирован или создан в транспайлере, например в TypeScript или Babel. Доступные варианты зависят от типа проекта.

* Проект TypeScript в Visual Studio по умолчанию автоматически создает сопоставления источника. Дополнительные сведения см. в разделе [Настройка сопоставлений источника с помощью файла tsconfig.json](#configure_source_maps).

* В проекте JavaScript сопоставления источника можно создать с помощью средства упаковки (например, webpack) и компилятора (например, TypeScript или Babel), которые вы можете добавить в проект. Вместе с компилятором TypeScript необходимо добавить еще и файл *tsconfig.json* и установить опцию компилятора `sourceMap`. Пример такой операции на основе базовой конфигурации webpack вы найдете в руководстве по [созданию приложения Node.js с использованием React](../javascript/tutorial-nodejs-with-react-and-jsx.md).

> [!NOTE]
> Если вы не знакомы с сопоставлениями источников, изучите [эту вводную статью](https://www.html5rocks.com/en/tutorials/developertools/sourcemaps/), прежде чем продолжать работу. 

Чтобы настроить дополнительные параметры для сопоставлений источника, используйте файл *tsconfig.json* или параметры проекта для проекта TypeScript, но не оба метода сразу.

Чтобы включить отладку с помощью Visual Studio, необходимо убедиться в правильности ссылок на исходный файл в созданном сопоставителе с исходным кодом (может потребоваться тестирование). Например, если вы используете webpack, ссылки в файле сопоставителя с исходным кодом включают префикс *webpack:///* , который не позволяет Visual Studio найти исходный файл TypeScript или JSX. В частности, при исправлении для отладки, ссылку на исходный файл (например, *app.tsx*) следует изменить с *webpack:///./app.tsx* на *./app.tsx*, что включает отладку (путь относительно вашего исходного файла). В следующем примере показано, как настроить сопоставители с исходным кодом в webpack, который является одним из наиболее распространенных средств увязки, чтобы они работали с Visual Studio.

(Только для webpack) Если точка останова устанавливается в TypeScript файла JSX (а не в виде файла JavaScript), необходимо обновить конфигурацию webpack. Например, в файл *webpack-config.js* может потребоваться заменить следующий код:

```javascript
  output: {
    filename: "./app-bundle.js", // This is an example of the filename in your project
  },
```

следующим кодом:

```javascript
  output: {
    filename: "./app-bundle.js", // Replace with the filename in your project
    devtoolModuleFilenameTemplate: '[resource-path]'  // Removes the webpack:/// prefix
  },
```

Это настройка только для разработки, позволяющая отладку кода на стороне клиента в Visual Studio.

В сложных сценариях средства браузера (**F12**) иногда лучше подходят для отладки, так как для них не нужно выполнять изменения в пользовательских префиксах.

### <a name="configure-source-maps-using-a-tsconfigjson-file"></a><a name="configure_source_maps"></a> Настройка сопоставлений источника с помощью файла tsconfig.json

Если вы добавите в проект файл *tsconfig.json*, Visual Studio будет считать корневой каталог проектом TypeScript. Чтобы добавить файл, щелкните проект правой кнопкой мыши в обозревателе решений и последовательно выберите **Добавить > Новый элемент > JSON-файл конфигурации TypeScript**. Это действие добавит в проект файл *tsconfig.json*, аналогичный представленному ниже.

```json
{
  "compilerOptions": {
    "noImplicitAny": false,
    "noEmitOnError": true,
    "removeComments": false,
    "sourceMap": true,
    "target": "es5"
  },
  "exclude": [
    "node_modules",
    "wwwroot"
  ]
}
```

#### <a name="compiler-options-for-tsconfigjson"></a>Параметры компилятора для tsconfig.json

* **inlineSourceMap**. Создает один общий файл с сопоставлениями источников, а не отдельный файл сопоставления для каждого исходного файла.
* **inlineSources**. Помещает исходный код в тот же файл вместе с сопоставлениями источников. Для этого режима также нужно настроить *inlineSourceMap* или *sourceMap*.
* **mapRoot**. Указывает расположение, из которого отладчику следует брать файлы сопоставления источника ( *.map*), вместо расположения по умолчанию. Используйте этот флаг, если во время выполнения файлы *.map* и файлы *.js* должны размещаться в разных каталогах. Указанное здесь расположение внедряется в сопоставление источника, чтобы указать для отладчика расположение файлов *.map*.
* **sourceMap**. Создает соответствующий файл *.map*.
* **sourceRoot**. Указывает расположение, из которого отладчику следует брать файлы TypeScript, вместо расположения по умолчанию. Используйте этот флаг, если в ходе время выполнения и разработки исходные файлы должны размещаться в разных каталогах. Указанное здесь расположение внедряется в сопоставление источника, чтобы указать для отладчика расположение исходных файлов.

Дополнительные сведения о параметрах компилятора вы найдете на странице с [параметрами компилятора](https://www.typescriptlang.org/docs/handbook/compiler-options.html) в справочнике по TypeScript.

### <a name="configure-source-maps-using-project-settings-typescript-project"></a>Настройка сопоставителей с исходным кодом с помощью параметров проекта (TypeScript project)

Также вы можете настроить параметры сопоставления источника в свойствах проекта, щелкнув проект правой кнопкой мыши и выбрав **Проект > Свойства > Сборка TypeScript > Отладка**.

Здесь доступны следующие параметры проекта.

* **Создать сопоставления источника** (эквивалентно **sourceMap** в *tsconfig.json*). Создает соответствующий файл *.map*.
* **Укажите корневой каталог сопоставлений источника** (эквивалентно **mapRoot** в *tsconfig.json*). Указывает расположение, из которого отладчику следует брать файлы сопоставления, вместо автоматически созданного расположения. Используйте этот флаг, если во время выполнения файлы *.map* и файлы .js должны размещаться в разных каталогах. Указанное здесь расположение внедряется в сопоставление источника, чтобы указать для отладчика расположение файлов сопоставления.
* **Укажите корневой каталог файлов TypeScript** (эквивалентно **sourceRoot** в *tsconfig.json*). Указывает расположение, из которого отладчику следует брать файлы TypeScript, вместо расположения по умолчанию. Используйте этот флаг, если в ходе выполнения и разработки исходные файлы должны размещаться в разных каталогах. Указанное здесь расположение внедряется в сопоставление источника, чтобы указать для отладчика расположение исходных файлов.

## <a name="debug-javascript-in-dynamic-files-using-razor-aspnet"></a>Отладка JavaScript в динамических файлах с помощью Razor (ASP.NET)

::: moniker range=">=vs-2019"
Начиная с Visual Studio 2019, Visual Studio обеспечивает отладку только для Chrome и Microsoft Edge (Chromium).
::: moniker-end
::: moniker range="vs-2017"
Visual Studio поддерживает отладку только для браузеров Chrome и Internet Explorer.
::: moniker-end

Однако, вы не сможете автоматически использовать точки останова в файлах, созданных с синтаксисом Razor (cshtml, vbhtml). Для отладки файлов такого типа вы можете применить два следующих подхода.

* **Поместите инструкцию `debugger;` в той строке, где нужно прервать выполнение**. Эта инструкция прерывает выполнение динамического скрипта и начинает отладку сразу же при его создании.
* **Загрузите страницу и откройте динамический документ в Visual Studio**. Чтобы воспользоваться этим методом, нужно открыть динамический файл в процессе отладки, задать в нем точку останова и обновить страницу. В зависимости от выбранного браузера (Chrome или Internet Explorer) вы сможете найти этот файл с помощью следующих действий.

   Для Chrome откройте пункты меню **Обозреватель решений > Документы скриптов > [Имя_нужной_страницы]** .

    > [!NOTE]
    > Если вы используете Chrome, может появиться сообщение: **Источник недоступен между тегами \<script>** . Это нормально, просто продолжайте отладку.

   ::: moniker range=">=vs-2019"
   Для Microsoft Edge (Chromium) используйте ту же процедуру, что и для Chrome.
   ::: moniker-end

   ::: moniker range="vs-2017"
   Для Internet Explorer откройте пункты меню **Обозреватель решений > Документы скриптов > Windows Internet Explorer > [Имя_нужной_страницы]** .
   ::: moniker-end

Дополнительные сведения см. в руководстве по [отладке проектов ASP.NET в браузере Google Chrome на стороне клиента](https://devblogs.microsoft.com/aspnet/client-side-debugging-of-asp-net-projects-in-google-chrome/).
