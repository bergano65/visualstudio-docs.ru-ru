---
title: Практическое руководство. Подписание манифестов приложения и развертывания
description: Узнайте о требованиях к подписанию для публикации манифестов приложения ClickOnce и развертывания. Подписание является необязательным для приложений на основе EXE.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.technology: vs-ide-deployment
ms.topic: conceptual
helpviewer_keywords:
- manifests [Visual Studio]
- code signing [Visual Studio], Authenticode
- deployment manifests [Visual Studio]
- signing manifests [Visual Studio]
- application manifests [Visual Studio]
- ClickOnce deployment [Visual Studio], signing assemblies
- key files [Visual Studio]
- assemblies [Visual Studio], signing
ms.assetid: 64173505-8bfb-41cf-a0de-b9075173f3a2
author: ghogen
ms.author: ghogen
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 5568961cc8b527ecd724ab9a1d26ab4a641696b6
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99869288"
---
# <a name="how-to-sign-application-and-deployment-manifests"></a>Практическое руководство. Подписание манифестов приложения и развертывания

Если вы хотите опубликовать приложение с помощью развертывания ClickOnce, манифесты приложения и развертывания должны быть подписаны парой из открытого и закрытого ключей с использованием технологии Authenticode. Манифесты можно подписать с помощью сертификата из хранилища сертификатов Windows или файла ключа.

Дополнительные сведения о развертывании ClickOnce см. в статье [Развертывание и безопасность технологии ClickOnce](../deployment/clickonce-security-and-deployment.md).

Подписывание манифестов ClickOnce для приложений на базе *EXE* является необязательным. Дополнительные сведения см. в разделе "Создание неподписанных манифестов" этого документа.

Сведения о создании файлов ключей см. в статье [Практическое руководство. Создание пары открытого и закрытого ключей](/dotnet/framework/app-domains/how-to-create-a-public-private-key-pair).

> [!NOTE]
> Visual Studio поддерживает только файлы ключей для обмена личной информацией (*PFX*). Тем не менее, можно выбрать другие типы сертификатов из хранилища сертификатов текущего пользователя Windows, щелкнув **Выбрать из хранилища** на странице **Подписывание** свойств проекта.

## <a name="sign-using-a-certificate"></a>Вход с использованием сертификата

1. Перейдите в окно свойств проекта (в **обозревателе решений** щелкните узел проекта правой кнопкой мыши и выберите пункт **Свойства**). На вкладке **Подписывание** установите флажок **Подписать манифесты ClickOnce**.

2. Нажмите кнопку **Выбрать из хранилища**.

     Появляется диалоговое окно **Выбор сертификата** с содержимым хранилища сертификатов Windows.

    > [!TIP]
    > Если щелкнуть элемент **Щелкните здесь, чтобы просмотреть свойства сертификата**, открывается диалоговое окно **Сведения о сертификате**. Это диалоговое окно содержит подробные сведения о сертификате и дополнительные параметры. Щелкните **Сертификаты** для просмотра дополнительных справочных сведений.

3. Выберите сертификат, который хотите использовать для подписи манифестов.

4. Кроме того, можно указать адрес сервера меток времени в текстовом поле **URL-адрес сервера меток времени**. Этот сервер предоставляет метку времени, указывающую, когда был подписан манифест.

## <a name="sign-using-an-existing-key-file"></a>Вход с использованием существующего файла ключа

1. На странице **Подписывание** установите флажок **Подписать манифесты ClickOnce**.

2. Нажмите кнопку **Выбрать из файла**.

     Открывается диалоговое окно **Выбор файла**.

3. В диалоговом окне **Выбор файла** найдите требуемый файл ключа (*PFX*) и нажмите кнопку **Открыть**.

    > [!NOTE]
    > Этот параметр поддерживает только файлы с расширением *PFX*. При наличии файла ключа или сертификата в другом формате сохраните его в хранилище сертификатов Windows и выберите сертификат, описанный в предыдущей процедуре. Назначение выбранного сертификата должно включать в себя подписывание кода.

     Отображается диалоговое окно **Ввод пароля для открытия файла**. (Если *PFX*-файл уже находится в хранилище сертификатов Windows или не защищен паролем, вы не получите запрос на ввод пароля.)

4. Введите пароль для доступа к файлу ключа и нажмите клавишу **ВВОД**.

> [!NOTE]
> *PFX*-файл не может содержать сведения о цепочке сертификатов. Если содержит, произойдет следующая ошибка импорта: **Не удается найти сертификат и закрытый ключ для расшифровки**. Чтобы удалить сведения о цепочке сертификатов, можно использовать *Certmgr.msc* и [отключить параметр](/previous-versions/aa730868(v=vs.80))**Включить все сертификаты** при экспорте файла PFX.

## <a name="sign-using-a-test-certificate"></a>Вход с использованием тестового сертификата

1. На странице **Подписывание** установите флажок **Подписать манифесты ClickOnce**.

2. Чтобы создать сертификат для тестирования, нажмите кнопку **Создание тестового сертификата**.

3. В диалоговом окне **Создание тестового сертификата** введите пароль для защиты тестового сертификата.

## <a name="generate-unsigned-manifests"></a>Создание неподписанных манифестов

Подписывание манифестов ClickOnce для приложений на базе *EXE* является необязательным. Следующие процедуры демонстрируют создание неподписанных манифестов ClickOnce.

> [!IMPORTANT]
> Неподписанные манифесты позволяют упростить разработку и тестирование приложения. Однако неподписанные манифесты представляют большую угрозу безопасности в рабочей среде. Используйте неподписанные манифесты, только если приложение ClickOnce выполняется на компьютерах в интрасети, которая полностью изолирована от Интернета или других источников вредоносного кода.

По умолчанию ClickOnce автоматически создает подписанные манифесты, если только один или несколько файлов специально не исключаются из создаваемого хэша. Другими словами, публикация приложения дает подписанные манифесты, если все файлы включены в хэш, даже если флажок **Подписать манифесты ClickOnce** снят.

### <a name="to-generate-unsigned-manifests-and-include-all-files-in-the-generated-hash"></a>Создание неподписанных манифестов и включение всех файлов в создаваемый хэш

1. Для создания неподписанных манифестов, которые включают все файлы в хэш, нужно сначала опубликовать приложение вместе с подписанными манифестами. Таким образом, сначала подпишите манифесты ClickOnce, выполнив одну из предыдущих процедур, а затем опубликуйте приложение.

2. На странице **Подписывание** снимите флажок **Подписать манифесты ClickOnce**.

3. Выполните сброс версии публикации, чтобы доступной была только одна версия приложения. По умолчанию Visual Studio автоматически увеличивает номер редакции для версии публикации при каждой публикации приложения. Дополнительные сведения см. в статье [Практическое руководство. Установка версии публикации приложения ClickOnce](../deployment/how-to-set-the-clickonce-publish-version.md).

4. Опубликуйте приложение.

### <a name="to-generate-unsigned-manifests-and-exclude-one-or-more-files-from-the-generated-hash"></a>Создание неподписанных манифестов и исключение одного или нескольких файлов из создаваемого хэша

1. На странице **Подписывание** снимите флажок **Подписать манифесты ClickOnce**.

2. Откройте диалоговое окно **Файлы приложения** и присвойте параметру **Хэш** значение **Исключить** для файлов, которые требуется исключить из создаваемого хэша.

    > [!NOTE]
    > Исключение файла из хэша настраивает ClickOnce на отключение автоматической подписи манифестов, поэтому вам не нужно сначала публиковать приложение с подписанными манифестами, как описано в предыдущей процедуре.

3. Опубликуйте приложение.

## <a name="see-also"></a>См. также

- [Сборки со строгими именами](/dotnet/framework/app-domains/strong-named-assemblies)
- [Практическое руководство. Создание пары открытого и закрытого ключей](/dotnet/framework/app-domains/how-to-create-a-public-private-key-pair)
- [Страница "Подписывание" в конструкторе проектов](../ide/reference/signing-page-project-designer.md)
- [Развертывание и безопасность технологии ClickOnce](../deployment/clickonce-security-and-deployment.md)
