---
title: Шаг 6. Добавление таймера
description: Узнайте, как добавить в игру "Подбери пару" элемент управления <xref:System.Windows.Forms.Timer>.
ms.custom: SEO-VS-2020
ms.date: 03/31/2020
ms.topic: tutorial
ms.prod: visual-studio-windows
ms.technology: vs-ide-general
dev_langs:
- CSharp
- VB
ms.assetid: 09e7930b-cab6-4a22-9a6f-72e23f489585
author: ornellaalt
ms.author: ornella
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 77daa47cdd6336849903202233392d3eecc33c1a
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2021
ms.locfileid: "99868898"
---
# <a name="step-6-add-a-timer"></a>Шаг 6. Добавление таймера
Затем добавьте в игру "Подбери пару" элемент управления <xref:System.Windows.Forms.Timer>. Таймер ожидает заданное число миллисекунд, а затем вызывает событие, называемое *тактом*. Это бывает удобно для запуска действия или повтора действия с определенной периодичностью. В этом случае таймер нужен для того, чтобы игроки могли выбрать два значка, а если они не совпадают, скрыть их через небольшой отрезок времени.

## <a name="to-add-a-timer"></a>Добавление таймера

1. На панели элементов в **конструкторе Windows Forms** выберите **Таймер** (в категории **Компоненты**), а затем нажмите клавишу **ВВОД** или дважды щелкните таймер, чтобы добавить его в форму. Значок с именем таймера **Timer1** должен появиться в пространстве под формой, как показано на следующем рисунке.

     ![Таймер](../ide/media/express_timer.png)<br/>
***Таймер***

    > [!NOTE]
    > Если панель элементов пуста, проверьте, что перед ее открытием был выбран конструктор форм, а не код формы.

2. Щелкните значок **Timer1**, чтобы выбрать таймер. В окне **Свойства** переключитесь с просмотра событий на просмотр свойств. Затем задайте для свойства **Interval** значение **750**, но оставьте для свойства **Enabled** значение **False**. Свойство **Interval** задает время ожидания между *тактами* таймера или время активации события <xref:System.Windows.Forms.Timer.Tick>. Значение 750 соответствует трем четвертям секунды (750 миллисекунд), по истечении которых происходит событие Tick. Метод <xref:System.Windows.Forms.Timer.Start> для запуска таймера будет вызван только после того, как игрок выберет вторую метку.

3. Выберите значок элемента управления "Таймер" в **конструкторе Windows Forms**, а затем нажмите клавишу **ВВОД** или дважды щелкните таймер, чтобы добавить пустой обработчик событий Tick. Замените код следующим кодом или вручную введите следующий код в обработчик событий.

     [!code-csharp[VbExpressTutorial4Step6#7](../ide/codesnippet/CSharp/step-6-add-a-timer_1.cs)]
     [!code-vb[VbExpressTutorial4Step6#7](../ide/codesnippet/VisualBasic/step-6-add-a-timer_1.vb)]

      > [!IMPORTANT]
      > Используйте элемент управления языка программирования в правом верхнем углу этой страницы, чтобы просмотреть фрагмент кода на C# или Visual Basic.<br><br>![Элемент управления языка программирования для Docs.Microsoft.com](../ide/media/docs-programming-language-control.png)

     Обработчик события Tick выполняет три действия. Сначала он останавливает таймер, вызывая метод <xref:System.Windows.Forms.Timer.Stop>. Затем он использует две ссылочные переменные, `firstClicked` и `secondClicked`, чтобы снова сделать невидимыми значки двух меток, которые выбрал игрок. Наконец, он сбрасывает значения ссылочных переменных `firstClicked` и `secondClicked` на `null` в C# и `Nothing` в Visual Basic. Это важный шаг, поскольку таким образом программа сбрасывает себя. Теперь она не отслеживает какие-либо элементы управления <xref:System.Windows.Forms.Label> и снова готова к выбору метки игроком.

    > [!NOTE]
    > У объекта Timer есть метод `Start()`, который запускает таймер, и метод `Stop()`, который останавливает его. Если в окне **Свойства** свойству таймера **Enabled** задать значение **True**, он начнет отсчет сразу же, как только запустится программа. Но если в этом свойстве оставить значение **False**, отсчет не начнется, пока не будет вызван метод `Start()`. Как правило, таймер запускает событие Tick снова и снова, используя свойство **Interval**, чтобы определить, сколько миллисекунд ждать между тактами. Обратите внимание на вызов метода таймера `Stop()` внутри события Tick. Таймер переходит в *режим однократного действия*, означающий, что при вызове метода `Start()` он ожидает в течение заданного интервала, запускает одно событие Tick, а затем останавливается.

4. Чтобы увидеть работу нового таймера, перейдите к редактору кода и добавьте следующий код в начало и конец метода обработчика событий `label_Click()`. (Вы добавляете два оператора `if` в начало метода и три оператора в конец. Остальная часть метода остается неизменной.)

     [!code-csharp[VbExpressTutorial4Step6#8](../ide/codesnippet/CSharp/step-6-add-a-timer_2.cs)]
     [!code-vb[VbExpressTutorial4Step6#8](../ide/codesnippet/VisualBasic/step-6-add-a-timer_2.vb)]

     Код в начале метода проверяет, запущен ли таймер, обращаясь к значению свойству **Enabled**. Таким образом, если игрок выбирает первый и второй элемент управления Label и таймер запускается, выбор третьего элемента управления Label ни к чему не приведет. Он также не позволяет проигрывателю быстро щелкнуть третий раз, прежде чем в игре можно будет щелкнуть первый раз. 

     Код в конце метода задает ссылочную переменную `secondClicked` таким образом, чтобы она отслеживала второй элемент управления Label, который щелкнул игрок, и задает этой метке черный цвет значка, чтобы сделать ее видимой. Затем таймер запускается в однократном режиме, то есть ожидает 750 миллисекунд и после этого вызывает одно событие Tick. Обработчик событий Tick таймера скрывает два значка и сбрасывает значения ссылочных переменных `firstClicked` и `secondClicked`; в результате форма будет снова готова к выбору игроком пары значков.

5. Сохраните и выполните программу. Выберите значок, и он станет видимым.

6. Выберите другой значок. Он появляется на короткое время, а затем оба значка исчезают. Повторите это несколько раз. В форме отслеживаются первый и второй значки, которые вы выбрали, и используется таймер, задающий время задержки до исчезновения значков.

## <a name="to-continue-or-review"></a>Продолжить или повторить пройденный материал

- Следующий раздел руководства: **[Шаг 7. Отмена исчезновения пар значков](../ide/step-7-keep-pairs-visible.md)** .

- Предыдущий раздел руководства: [Шаг 5. Добавление ссылок на элементы управления Label](../ide/step-5-add-label-references.md).
