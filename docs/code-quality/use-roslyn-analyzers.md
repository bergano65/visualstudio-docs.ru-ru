---
title: Важность правила анализатора и подавления
ms.date: 03/26/2019
ms.topic: conceptual
helpviewer_keywords:
- code analysis, managed code
- analyzers
- Roslyn analyzers
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- dotnet
ms.openlocfilehash: 56637ee7826b944d739e170faf22ae354abd8adc
ms.sourcegitcommit: 1fc6ee928733e61a1f42782f832ead9f7946d00c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2019
ms.locfileid: "60080817"
---
# <a name="use-roslyn-analyzers"></a>Использование анализаторов Roslyn

Правила анализатора .NET compiler Platform («Roslyn»), или *диагностики*, анализ кода C# или Visual Basic при вводе. Каждый диагностическое событие имеет состояние серьезности и подавления по умолчанию, которое может быть перезаписан для вашего проекта. В этой статье рассматриваются важность правила параметр, с помощью наборов правил и подавление нарушений.

## <a name="analyzers-in-solution-explorer"></a>Анализаторы в обозревателе решений

Можно сделать, большая часть настройки анализатора диагностики из **обозревателе решений**. Если вы [установить анализаторы](../code-quality/install-roslyn-analyzers.md) как пакет NuGet, **анализаторы** узел отображается в узле **ссылки** или **зависимости** узел в  **Обозреватель решений**. Если развернуть **анализаторы**и затем разверните одну из сборок анализатора, вы увидите все средства диагностики в сборке.

![Анализаторы узел в обозревателе решений](media/analyzers-expanded-in-solution-explorer.png)

Можно просмотреть свойства диагностики, в том числе его описание, уровень серьезности по умолчанию, в **свойства** окна. Чтобы просмотреть свойства, щелкните правой кнопкой мыши правило и выберите **свойства**, или выберите правило и нажмите клавишу **Alt**+**ввод**.

![Свойства диагностики в окно "Свойства"](media/analyzer-diagnostic-properties.png)

Чтобы просмотреть электронную документацию по для диагностики, щелкните правой кнопкой мыши на диагностику и выберите **Просмотр справки**.

Значки возле каждого средства диагностики в **обозревателе решений** соответствует значку, вы увидите в набор при открытии в редакторе правил:

- Указывает, «i» в кружке [серьезность](#rule-severity) из **Info**
- «!» в треугольника указывает [серьезность](#rule-severity) из **предупреждение**
- «x» в круг означает [серьезность](#rule-severity) из **ошибки**
- Указывает, «i» в круге на фоне светлый [серьезность](#rule-severity) из **Hidden**
- стрелку вниз в кружке указывает, что диагностики отключено

![Диагностика значки в обозревателе решений](media/diagnostics-icons-solution-explorer.png)

## <a name="rule-sets"></a>Наборы правил

Объект [набор правил](../code-quality/using-rule-sets-to-group-code-analysis-rules.md) — XML-файл, который хранит состояние серьезности и подавлением для отдельного диагностики.

> [!NOTE]
> Наборы правил можно включить правила анализа статического кода (двоичный) и анализаторов Roslyn.

Чтобы изменить активный набор правил в редакторе набора правил, щелкните правой кнопкой мыши **ссылки** > **анализаторы** узел в **обозревателе решений** и выберите **Открыть активный набор правил**. Если это при первом изменении набор правил, Visual Studio создается копия правила по умолчанию задать файл, присваивает ему  *\<имя_проекта > .ruleset*и добавляет его в проект. Этот набор также настраиваемых правил становится активный набор правил для проекта.

Чтобы изменить активный набор правил для проекта, перейдите к **анализа кода** вкладки свойств проекта. Выберите набор в списке правил **выполнить этот набор правил**. Чтобы открыть набор правил, выберите **откройте**.

> [!NOTE]
> Проекты .NET core и .NET Standard не поддерживают команды меню для наборов правил в **обозревателе решений**, например **открыть активный набор правил**. Чтобы указать нестандартный набор правил для проекта .NET Core или .NET Standard, вручную [добавить **CodeAnalysisRuleSet** свойство в файл проекта](using-rule-sets-to-group-code-analysis-rules.md#specify-a-rule-set-for-a-project). Можно настроить правила в набор правил в Visual Studio пользовательский Интерфейс редактора набора правил.

## <a name="rule-severity"></a>Важность правил

Можно настроить уровень серьезности правил анализатора или *диагностики*, если вы [установить анализаторы](../code-quality/install-roslyn-analyzers.md) как пакет NuGet. В следующей таблице показаны параметры серьезности для диагностики:

|Серьезность|Поведение во время сборки|Поведение редактора|
|-|-|-|
|Error|Нарушения отображаются как *ошибки* в **список ошибок** командной строки в выходные данные сборки и привести к сбою сборки.|Код, вызвавший ошибку, подчеркнута с красной волнистой и помеченный атрибутом небольшой красный квадрат в полосе прокрутки.|
|Предупреждение|Нарушения отображаются как *предупреждения* в **список ошибок** и командной строки в выходные данные сборки, но не приводят к сбою сборки.|Код, вызвавший ошибку, подчеркнута с зеленой волнистой и помеченный атрибутом небольшой зеленой рамкой на полосе прокрутки.|
|Info|Нарушения отображаются как *сообщений* в **список ошибок**и совсем не в выходных данных построения из командной строки.|Код, вызвавший ошибку, подчеркнута серым, волнистой и помеченный атрибутом небольшое серое поле в полосе прокрутки.|
|Hidden|Невидимые для пользователя.|Невидимые для пользователя. Диагностические тем не менее передаются в подсистему диагностики интегрированной среды разработки.|
|Нет|Полностью подавить.|Полностью подавить.|

Кроме того, вы можете «сбросить» важность правила при установке для него **по умолчанию**. Каждый диагностическое событие имеет уровень серьезности по умолчанию, который можно увидеть в **свойства** окна.

На следующем рисунке показаны три различных диагностических нарушений в редакторе кода с тремя разными уровнями серьезности. Обратите внимание, что цвет волнистой, а также небольшое поле в полосе прокрутки в правой части.

![Ошибки, предупреждения и сведения о нарушение в редакторе кода](media/diagnostics-severity-colors.png)

На следующем рисунке показан же трех нарушений, как они указаны в **список ошибок**:

![Ошибки, предупреждения и сведения о нарушение в списке ошибок](media/diagnostics-severities-in-error-list.png)

Можно изменить уровень серьезности правила **обозревателе решений**, или в  *\<имя_проекта > .ruleset* файл, который добавляется в решение после изменения серьезность правила в  **Обозреватель решений**.

![Файл набора правил в обозревателе решений](media/ruleset-in-solution-explorer.png)

### <a name="set-rule-severity-from-solution-explorer"></a>Серьезность набора правил из обозревателя решений

1. В **обозревателе решений**, разверните **ссылки** > **анализаторы** (**зависимости**  >  **Анализаторы** для проектов .NET Core).

1. Разверните сборку, которая содержит правило, которое нужно задать уровень серьезности для.

1. Щелкните правой кнопкой мыши правило и выберите **установить серьезность набора правил**. В выпадающем меню выберите один из параметров уровень серьезности.

   Серьезность правила сохраняется в файле набора правил active.

### <a name="set-rule-severity-in-the-rule-set-file"></a>Серьезность набора правил в файл набора правил

1. Откройте [набор правил](analyzer-rule-sets.md) файл, дважды щелкнув его в **обозревателе решений**, выбрав **открыть активный набор правил** в меню щелкните правой кнопкой мыши **анализаторы** узла, либо выбрав **откройте** на **анализа кода** страницу свойств для проекта.

1. Перейдите к правилу, развернув его соответствующая сборка.

1. В **действие** столбец, выберите значение для открытия раскрывающегося списка и выберите нужный уровень серьезности в списке.

   ![Откройте в редакторе файл набора правил](media/ruleset-file-in-editor.png)

## <a name="suppress-violations"></a>Подавлять нарушений

Существует несколько способов для подавления нарушения правил:

- Из **анализ** меню

   Выберите **анализ** > **выполнить анализ кода и подавить активные проблемы** в строке меню, чтобы отключить все текущие нарушения. Иногда это называется «задание базовых показателей».

- Из **обозревателе решений**

   Можно отключить в **обозревателе решений**, равным важность правила **None**.

- Из **редактор набора правил**

   Можно отключить в редакторе набора правил, снимите флажок рядом с его именем или задать **действие** для **None**.

- Из **редактор кода**

   Можно отключить в редакторе кода, поместите курсор в строку кода с нарушением и нажмите клавишу **Ctrl**+**.** Чтобы открыть **Быстрые действия** меню. Выберите **подавлять CAXXXX** > **в источнике или в файле блокируемых предупреждений**.

   ![Отключение диагностики из меню быстрых действий](media/suppress-diagnostic-from-editor.png)

- Из **список ошибок**

   Вы можете отключить диагностику один или несколько из **список ошибок** , выбрав те, которые вы хотите отключить, и щелкните правой кнопкой мыши и выбрав **подавлять** > **Source/In в Файл подавления**.

   - Если Вы запрещаете **в исходном**, **Просмотр изменений** откроется диалоговое окно, отображается предварительный просмотр C# [#pragma warning](/dotnet/csharp/language-reference/preprocessor-directives/preprocessor-pragma-warning) или Visual Basic [#Disable Предупреждение](/dotnet/visual-basic/language-reference/directives/directives) директива, которая добавляется к исходному коду.

      ![Предварительная версия добавления #pragma warning в файле кода](media/pragma-warning-preview.png)

   - При выборе **в файле блокируемых предупреждений**, **Просмотр изменений** откроется диалоговое окно, отображается предварительный просмотр <xref:System.Diagnostics.CodeAnalysis.SuppressMessageAttribute> атрибут, который добавляется файл глобального подавления.

      ![Предварительный просмотр файла подавления при добавлении атрибута SuppressMessage](media/preview-changes-in-suppression-file.png)

   В **Просмотр изменений** диалоговом окне выберите **применить**.

   > [!NOTE]
   > Если вы не видите **подавлять** пункт меню в **обозревателе решений**, нарушение, весьма вероятно, появятся из сборки и не оперативный анализ. **Список ошибок** отображает диагностики или правило нарушений, как динамический анализ кода и сборки. Поскольку диагностика сборки может быть устаревшим, например, если вы закончили редактировать код, чтобы устранить нарушение, но не восстановлена, невозможно закрыть эти диагностические из **список ошибок**. Диагностику из динамического анализа или IntelliSense, всегда актуальны, с помощью актуальных источников и могут исключаться из **список ошибок**. Чтобы исключить *построения* переключения диагностики из вашего выбора **список ошибок** Фильтр источника из **сборка и IntelliSense** для **Intellisense только**. Выберите диагностики, который вы хотите отключить и выполнить действия, описанные ранее.
   >
   > ![Фильтр источника списка ошибок в Visual Studio](media/error-list-filter.png)

## <a name="command-line-usage"></a>Использование командной строки

При построении проекта в командной строке, нарушения правил отображаются в выходных данных сборки, при соблюдении следующих условий:

- Анализаторы устанавливаются в виде пакета Nuget, а не как расширение VSIX.

- Одно или несколько правил нарушены в коде проекта.

- [Серьезность](#rule-severity) нарушила правила может принимать значение **предупреждение**, в этом случае нарушений не приводят к сбою, сборки или **ошибка**, в этом случае нарушений привести к сбою сборки.

Уровень детализации выходных данных сборки не влияет на отображаются нарушения правил. Даже с **quiet** уровень детализации, нарушения правил отображаются в выходных данных построения.

> [!TIP]
> Если вы привыкли выполнения статического анализа кода из командной строки, с помощью *FxCopCmd.exe* или с помощью msbuild с **RunCodeAnalysis** флаг, вот как это сделать с помощью анализаторов Roslyn.

Чтобы увидеть нарушения анализатора в командной строке при сборке проекта с помощью msbuild, выполните следующую команду:

```cmd
msbuild myproject.csproj /target:rebuild /verbosity:minimal
```

На следующем рисунке показано построение из командной строки выходные файлы построения проекта, содержащего нарушений правил анализа:

![Выходные данные MSBuild с нарушением правила](media/command-line-build-analyzers.png)

## <a name="dependent-projects"></a>Зависимые проекты

В проекте .NET Core при добавлении ссылки в проект, имеющий анализаторов NuGet, эти анализаторы автоматически добавляются в зависимом проекте слишком. Чтобы отключить это поведение, например, если зависимый проект модульного теста пометить пакет NuGet в качестве частной в *.csproj* или *.vbproj* файл проекта, на который указывает ссылка, задав **PrivateAssets** атрибут:

```xml
<PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="2.9.0" PrivateAssets="all" />
```

## <a name="see-also"></a>См. также

- [Обзор анализаторов Roslyn в Visual Studio](../code-quality/roslyn-analyzers-overview.md)
- [Отправка ошибки анализатора Roslyn](https://github.com/dotnet/roslyn-analyzers/issues)
- [Использование наборов правил](../code-quality/using-rule-sets-to-group-code-analysis-rules.md)
- [Отключение предупреждений анализа кода](../code-quality/in-source-suppression-overview.md)