---
title: "Рефакторинг кода в Visual Studio для Mac | Документы Майкрософт"
description: "Переупорядочение кода в Visual Studio для Mac упрощается благодаря анализу источника."
author: asb3993
ms.author: amburns
ms.date: 04/14/2017
ms.topic: article
ms.assetid: C7782BF3-016F-4B41-8A81-85FC540A1A8F
ms.openlocfilehash: ba92cd9a0e9ca28d132116f65fd41758bce1a1f0
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="refactoring"></a>Рефакторинг

Рефакторинг кода позволяет переупорядочить, реструктуризовать и уточнить существующий код без изменения его поведения.

Он повышает работоспособность базы кода, делая ее более удобной, понятной и легкой в обслуживании как для вас или другого разработчика, так и для пользователя, обращающегося к такому коду.

Интеграция Visual Studio для Mac с Roslyn, платформой компилятора .NET с открытым исходным кодом корпорации Майкрософт, расширяет спектр операций рефакторинга, а также обеспечивает полную поддержку последней версии C#.

## <a name="renaming"></a>Переименование 

Команду рефакторинга *Переименовать* можно использовать для любого идентификатора кода (например, имени класса, имени свойства и т. д.), чтобы найти все экземпляры этого идентификатора и изменить их. Чтобы переименовать символ, щелкните его правой кнопкой мыши и выберите пункт **Рефакторинг > Переименовать** или нажмите клавиши **CMD+R**:

![Пункт меню "Переименовать"](media/refactoring-renaming1.png)

При этом выделяется как сам символ, так и все ссылки на него. Начав вводить новое имя, вы автоматически измените все ссылки в коде, а нажав клавишу **ВВОД**, можно указать на завершение переименования:

 ![Переименование и идентификатор](media/refactoring-renaming2.png)

## <a name="context-actions"></a>Контекстные действия

Контекстные действия позволяют проверять любой код C# и просматривать все возможные параметры рефакторинга. 

Контекстные элементы **Разрешить** и **Рефакторинг** объединяются в один элемент *Быстрое исправление...*, предоставляющий вам все доступные контекстные действия:

![Отображение контекстных элементов](media/refactoring-context-action.png)

При наведении указателя мыши на любое из контекстных действий отображается предварительный просмотр всего того, что будет добавлено в код или удалено оттуда.

Кроме того, можно нажать клавиши **OPTION+ВВОД** в любом месте кода:

![Контекстные элементы при нажатии OPTION+ВВОД](media/refactoring-image2a.png)

Чтобы включить эти параметры, нужно выбрать *Включить анализ источника для открытых файлов* в разделе параметров **Visual Studio для Mac > Параметры > Текстовый редактор > Анализ источника**:

 ![Включение анализа источника](media/refactoring-options.png)

Существует более 100 возможных предлагаемых действий, которые можно включить или отключить, перейдя в раздел **Visual Studio для Mac > Параметры > Анализ источника > C# > Действия кода** и установив или сняв флажок рядом с ними:

 ![Действия анализа источника C#](media/refactoring-image3a.png)

### <a name="common-context-actions"></a>Типичные контекстные действия

Ниже описаны некоторые из наиболее часто используемых контекстных действий.

#### <a name="extract-method"></a>Извлечение метода

Операция рефакторинга "Извлечение метода" позволяет создать метод путем извлечения выделенного кода в существующем члене. Это действие выполняет две операции:

* создает метод из выбранного фрагмента кода;
* вызывает этот метод в месте, где находился выделенный код.

##### <a name="example"></a>Пример

1. Добавьте следующий код:

```
    class MainClass
    {

        double CalculatePyramidVolume(double baseArea, double height)
        {

            double volume = (baseArea * height) / 3;

            return volume;
        }
    }
```

2. Выделите строку `double volume = (baseArea * height) / 3;`, щелкните ее правой кнопкой и выберите **Рефакторинг > Извлечение метода**.

3. Используйте клавиши со стрелками для выбора места в коде, где нужно разместить новый метод.


#### <a name="encapsulate-field"></a>Инкапсуляция поля

Операция "Инкапсулировать поле" позволяет создать свойство из существующего поля, а также обновляет код, чтобы сослаться на созданное свойство. Создав свойство, инкапсулирующее ваше поле, вы запрещаете прямой доступ к вашему открытому полю, из-за чего другие объекты не смогут изменить его.

Это действие:

* изменяет модификатор доступа на закрытый;
* создает методы получения и задания для этого поля (если оно доступно только для чтения, создается лишь метод получения).


## <a name="source-analysis"></a>Анализ источника

Анализ источника оперативно анализирует код, подчеркивая потенциальные ошибки и нарушения стиля, а также предоставляя автоматические исправления в виде контекстных действий. 

Вы в любое время можете просмотреть все результаты анализа источника для любого файла на полосе прокрутки в правой части текстового редактора:

 ![Боковая панель исходного кода](media/refactoring-image4a.png)

Если щелкнуть расположенный сверху круг, можно выполнить итерации по каждому из предложений, начиная с наиболее серьезных проблем. При наведении указателя мыши на конкретный результат или строку отображается проблема, которую можно устранить с помощью контекстных действий:

 ![Элемент "Анализ источника"](media/refactoring-image5.png)

